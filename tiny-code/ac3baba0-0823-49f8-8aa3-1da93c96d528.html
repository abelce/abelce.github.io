<!DOCTYPE html><html lang="zh-Hans"><head><meta charSet="utf-8"/><title>文钦的个人日志</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,maximum-scale=1.0,viewport-fit=cover"/><meta name="next-head-count" content="3"/><meta name="baidu-site-verification" content="code-qLvQxBZOZA"/><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta http-equiv="Cache-Control" content="no-siteapp"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="文钦,1061225829@qq.com"/><meta property="site_name" content="文钦的个人日志"/><meta name="google-site-verification" content="LE9f0-2YGlWDKgo5955hV_-oeN3Uq74EN_6gcKaJ60U"/><meta property="og:type" content="website"/><meta property="og:site_name" content="文钦的个人日志"/><link rel="dns-prefetch" href="cdn.vwood.xyz"/><link rel="dns-prefetch" href="cloud.vwood.xyz"/><link rel="dns-prefetch" href="file.vwood.xyz"/><meta name="msvalidate.01" content="3E915E4B19B295BCF5E1FEB5AA8367EB"/><meta name="baidu_union_verify" content="a673bc08063b1108073e80d745c6be14"/><meta name="theme-color" content="#ffffff"/><link rel="preload" href="/_next/static/css/7fe7eb80fa1c0261.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7fe7eb80fa1c0261.css" data-n-g=""/><link rel="preload" href="/_next/static/css/72d7c042a6de55c2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/72d7c042a6de55c2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-aada28297ed4acaa.js" defer=""></script><script src="/_next/static/chunks/framework-36098b990598bc0c.js" defer=""></script><script src="/_next/static/chunks/main-406d0e0eabcc4880.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d6c11d4990681328.js" defer=""></script><script src="/_next/static/chunks/631e727a-0d7966a7311b51e8.js" defer=""></script><script src="/_next/static/chunks/4ad82c5e-0dc213f453b71f44.js" defer=""></script><script src="/_next/static/chunks/504-71cd6598d7ec39af.js" defer=""></script><script src="/_next/static/chunks/pages/tiny-code/%5Bid%5D-019bb0f35acb446f.js" defer=""></script><script src="/_next/static/4rmQSP37oD7SXATu-vcsF/_buildManifest.js" defer=""></script><script src="/_next/static/4rmQSP37oD7SXATu-vcsF/_ssgManifest.js" defer=""></script></head><body class="custom_class"><div id="__next"><section class="ant-layout ant-layout-has-sider style_layout__lI5tQ" id="layout"><header class="ant-layout-header"><div class="style_header__bLUBo"><nav class="style_header_left__3P86Z"><a class="style_logo-container__bUXun" href="/"><img alt="vwood" src="/images/logo.png"/></a><ul class="ant-menu-overflow ant-menu ant-menu-root ant-menu-horizontal ant-menu-light style_navs__cT4uk" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child style_nav-item__36GBG" style="opacity:1;order:0" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><a href="/">首页</a></span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child style_nav-item__36GBG" style="opacity:1;order:1" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><a href="/tools">工具</a></span></li><li class="ant-menu-overflow-item ant-menu-item ant-menu-item-only-child style_nav-item__36GBG" style="opacity:1;order:2" role="menuitem" tabindex="-1"><span class="ant-menu-title-content"><a href="/about">关于</a></span></li><li class="ant-menu-overflow-item ant-menu-overflow-item-rest ant-menu-submenu ant-menu-submenu-horizontal" style="opacity:0;height:0;overflow-y:hidden;order:9007199254740991;pointer-events:none;position:absolute" aria-hidden="true" role="none"><div role="menuitem" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="false" aria-haspopup="true"><span role="img" aria-label="ellipsis" class="anticon anticon-ellipsis"><svg viewBox="64 64 896 896" focusable="false" data-icon="ellipsis" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"></path></svg></span><i class="ant-menu-submenu-arrow"></i></div></li></ul><div style="display:none" aria-hidden="true"></div></nav><div class="style_header_right__66ICX"><div class="style_ads___Zl1o"><ins class="adsbygoogle" style="display:inline-block;text-align:center;width:400px;height:60px" data-ad-layout="in-header" data-ad-format="fluid" data-ad-client="ca-pub-6887995008287565" data-ad-slot="8657788489" data-full-width-responsive="true"></ins></div></div></div></header><main class="ant-layout-content style_layout-content__nrtXO"><div class="style_editor__33L3Y"><div class="style_iframe-div__VbyrP"><div class="style_code-div__3_lvb"></div><iframe width="100%" srcDoc="
      &lt;html lang=&quot;en&quot;&gt;
      &lt;head&gt;
          &lt;meta charset=&quot;UTF-8&quot;&gt;
          &lt;meta name=&quot;apple-mobile-web-app-title&quot; content=&quot;code preview&quot;&gt;
          &lt;title&gt;code preview&lt;/title&gt;
          &lt;style&gt;
            * {
              margin: 0;
              padding: 0;
            }
            body {
              width: 100vw;
              height: 100vh;
            }
          &lt;/style&gt;
          &lt;style&gt;
          .wrapper {
    width: 70%;
    max-width: 800px;
    margin: 0 auto;
}

video {
    max-width: 100%;
}

.wrapper&gt;div {
    margin-bottom: 10px;
}

.hidden {
    display: none;
}
          &lt;/style&gt;

          &lt;script&gt;
          window.console = window.console || function(t) {};
          &lt;/script&gt;

          &lt;script&gt;
          if (document.location.search.match(/type=embed/gi)) {
              window.parent.postMessage(&quot;resize&quot;, &quot;*&quot;);
          }
          &lt;/script&gt;

      &lt;/head&gt;

      &lt;body translate=&quot;no&quot;&gt;
          &lt;div class=&quot;wrapper&quot;&gt;
    &lt;h1&gt;点开“下载”按钮，“取消下载”按钮中止下载&lt;/h1&gt;
    &lt;div class=&quot;controls&quot;&gt;
        &lt;button class=&quot;download&quot;&gt;下载&lt;/button&gt;
        &lt;button class=&quot;abort hidden&quot;&gt;取消下载&lt;/button&gt;
        &lt;p class=&quot;reports&quot;&gt;&lt;/p&gt;
        &lt;div class=&quot;videoWrapper hidden&quot;&gt;
            &lt;p&gt;Sintel © copyright Blender Foundation | &lt;a href=&quot;http://www.sintel.org/&quot;&gt;www.sintel.org&lt;/a&gt;.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
          &lt;script&gt;
          const url = &#x27;https://vwood.xyz/images/sintel.mp4&#x27;;

const videoWrapper = document.querySelector(&#x27;.videoWrapper&#x27;);
const downloadBtn = document.querySelector(&#x27;.download&#x27;);
const abortBtn = document.querySelector(&#x27;.abort&#x27;);
const reports = document.querySelector(&#x27;.reports&#x27;);

let controller;
let progressAnim;
let animCount = 0;

downloadBtn.addEventListener(&#x27;click&#x27;, fetchVideo);

abortBtn.addEventListener(&#x27;click&#x27;, () =&gt; {
    controller.abort();
    console.log(&#x27;Download aborted&#x27;);
    downloadBtn.classList.remove(&#x27;hidden&#x27;);
});

function fetchVideo() {
    controller = new AbortController();
    const signal = controller.signal;
    downloadBtn.classList.add(&#x27;hidden&#x27;);
    abortBtn.classList.remove(&#x27;hidden&#x27;);
    reports.textContent = &#x27;视频下载中...&#x27;;
    fetch(url, {
        signal
    }).then((response) =&gt; {
        if (response.status === 200) {
            setTimeout(() =&gt; console.log(&#x27;Body used: &#x27;, response.bodyUsed), 1);
            return response.blob();
        } else {
            throw new Error(&#x27;Failed to fetch&#x27;);
        }
    }).then((myBlob) =&gt; {
        const video = document.createElement(&#x27;video&#x27;);
        video.setAttribute(&#x27;controls&#x27;, &#x27;&#x27;);
        video.src = URL.createObjectURL(myBlob);
        videoWrapper.appendChild(video);

        videoWrapper.classList.remove(&#x27;hidden&#x27;);
        abortBtn.classList.add(&#x27;hidden&#x27;);
        downloadBtn.classList.add(&#x27;hidden&#x27;);

        reports.textContent = &#x27;视频准备完毕&#x27;;
    }).catch((e) =&gt; {
        abortBtn.classList.add(&#x27;hidden&#x27;);
        downloadBtn.classList.remove(&#x27;hidden&#x27;);
        reports.textContent = &#x27;下载失败: &#x27; + e.message;
    })
}
          &lt;/script&gt;
      &lt;/body&gt;
      &lt;/html&gt;
    " title="code preview" sandbox="allow-forms allow-modals allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation allow-downloads allow-presentation" allow="accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share" scrolling="auto" allowfullscreen="" class="style_iframe__kw_S7 style_preview-iframe__ri7D3" loading="lazy" frameBorder="none"></iframe></div></div></main><footer class="ant-layout-footer"><div class="style_footer__9WRvE"><div>本站由<!-- --> <a href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" target="_blank"><img class="style_upyun__RuV1B" src="/images/又拍云_logo2.png"/></a> <!-- -->提供CDN加速/云存储服务</div></div></footer><div class="ant-back-top"></div></section><div class="ant-back-top"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"createTime":1692108471688,"css":".wrapper {\n    width: 70%;\n    max-width: 800px;\n    margin: 0 auto;\n}\n\nvideo {\n    max-width: 100%;\n}\n\n.wrapper\u003ediv {\n    margin-bottom: 10px;\n}\n\n.hidden {\n    display: none;\n}","html":"\u003cdiv class=\"wrapper\"\u003e\n    \u003ch1\u003e点开“下载”按钮，“取消下载”按钮中止下载\u003c/h1\u003e\n    \u003cdiv class=\"controls\"\u003e\n        \u003cbutton class=\"download\"\u003e下载\u003c/button\u003e\n        \u003cbutton class=\"abort hidden\"\u003e取消下载\u003c/button\u003e\n        \u003cp class=\"reports\"\u003e\u003c/p\u003e\n        \u003cdiv class=\"videoWrapper hidden\"\u003e\n            \u003cp\u003eSintel © copyright Blender Foundation | \u003ca href=\"http://www.sintel.org/\"\u003ewww.sintel.org\u003c/a\u003e.\u003c/p\u003e\n        \u003c/div\u003e\n    \u003c/div\u003e\n\u003c/div\u003e","id":"ac3baba0-0823-49f8-8aa3-1da93c96d528","javascript":"const url = 'https://vwood.xyz/images/sintel.mp4';\n\nconst videoWrapper = document.querySelector('.videoWrapper');\nconst downloadBtn = document.querySelector('.download');\nconst abortBtn = document.querySelector('.abort');\nconst reports = document.querySelector('.reports');\n\nlet controller;\nlet progressAnim;\nlet animCount = 0;\n\ndownloadBtn.addEventListener('click', fetchVideo);\n\nabortBtn.addEventListener('click', () =\u003e {\n    controller.abort();\n    console.log('Download aborted');\n    downloadBtn.classList.remove('hidden');\n});\n\nfunction fetchVideo() {\n    controller = new AbortController();\n    const signal = controller.signal;\n    downloadBtn.classList.add('hidden');\n    abortBtn.classList.remove('hidden');\n    reports.textContent = '视频下载中...';\n    fetch(url, {\n        signal\n    }).then((response) =\u003e {\n        if (response.status === 200) {\n            setTimeout(() =\u003e console.log('Body used: ', response.bodyUsed), 1);\n            return response.blob();\n        } else {\n            throw new Error('Failed to fetch');\n        }\n    }).then((myBlob) =\u003e {\n        const video = document.createElement('video');\n        video.setAttribute('controls', '');\n        video.src = URL.createObjectURL(myBlob);\n        videoWrapper.appendChild(video);\n\n        videoWrapper.classList.remove('hidden');\n        abortBtn.classList.add('hidden');\n        downloadBtn.classList.add('hidden');\n\n        reports.textContent = '视频准备完毕';\n    }).catch((e) =\u003e {\n        abortBtn.classList.add('hidden');\n        downloadBtn.classList.remove('hidden');\n        reports.textContent = '下载失败: ' + e.message;\n    })\n}","name":"abortController demo","operator":{"avatar":"//file.vwood.xyz/2023/06/11/upload_ssaf3w2dlo0xox7alrcrca1704a6j2fn.jpg","id":"96f16846-31f2-489c-9af0-d4ca13e836e4","name":"文钦"},"updateTime":1692111165460},"id":"ac3baba0-0823-49f8-8aa3-1da93c96d528"},"initialMobxState":{"userStore":{"currentUser":null,"users":[],"token":"","qiniuToken":"","userCount":0,"productCount":0,"commentCount":0,"settingType":"products"},"productStore":{"products":[],"total":0,"type":"","url":"","current":1,"product":null,"likesMap":{},"tabpane":"all","token":"","loading":false,"todayHunters":[],"today":[],"yesterday":[],"relatedProducts":[],"search":""},"commentStore":{"comments":[],"total":0,"current":0},"noteStore":{"token":"","notes":[],"total":0,"note":null},"askStore":{"token":"","asks":[],"total":0,"ask":null},"stypeStore":{"data":[]}},"__N_SSG":true},"page":"/tiny-code/[id]","query":{"id":"ac3baba0-0823-49f8-8aa3-1da93c96d528"},"buildId":"4rmQSP37oD7SXATu-vcsF","isFallback":false,"gsp":true,"appGip":true,"scriptLoader":[]}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MMNJYR8ESW" crossorigin="anonymous" strategy="lazyOnload"></script><script>window.dataLayer = window.dataLayer || [];
              function gtag(){window.dataLayer.push(arguments)}
              gtag('js', new Date());
              gtag('config', 'G-MMNJYR8ESW');</script><script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.async=true
              hm.src = "https://hm.baidu.com/hm.js?ea0272238080a1dedd4e077d19445ced";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
            </script></body></html>