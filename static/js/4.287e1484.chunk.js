(this["webpackJsonpbiz-form"]=this["webpackJsonpbiz-form"]||[]).push([[4],{899:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(11),c=a(72),i=a(89),r=a(0),s=a(886),l=a(950),o=a(951),u=a(940),d=a(906),m=a(902),h=a.n(m),j=(a(903),a(3)),b="DragableBodyRow",p=function(e){var t=e.index,a=e.moveRow,s=e.className,u=e.style,d=Object(i.a)(e,["index","moveRow","className","style"]),m=Object(r.useRef)(),h=Object(l.a)({accept:b,collect:function(e){return(e.getItem()||{}).index===t?{}:{isOver:e.isOver(),dropClassName:" drop-over"}},drop:function(e){a(e.index,t)}}),p=Object(c.a)(h,2),f=p[0],O=f.isOver,v=f.dropClassName,y=p[1],x=Object(o.a)({type:b,item:{index:t},collect:function(e){return{isDragging:e.isDragging()}}});return y((0,Object(c.a)(x,2)[1])(m)),Object(j.jsx)("tr",Object(n.a)({ref:m,className:"".concat(s).concat(O?v:""),style:Object(n.a)({cursor:"move"},u)},d))},f=function(e){var t=e.onSort,a=e.dataSource,c=void 0===a?[]:a,l=Object(i.a)(e,["onSort","dataSource"]),o={body:{row:p}},m=Object(r.useCallback)((function(e,a){var n=c[e];t&&t(h()(c,{$splice:[[e,1],[a,0,n]]}))}),[c]);return Object(j.jsx)(u.a,{backend:d.a,children:Object(j.jsx)(s.a,Object(n.a)(Object(n.a)({},l),{},{dataSource:c,components:o,className:"sort-table",onRow:function(e,t){return{index:t,moveRow:m}}}))})}},900:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(11),c=a(20),i=a(72),r=a(0),s=a(948),l=a(256),o=a(3),u=function(e){var t=e.entityName,a=e.onCheck,n=(e.isTemplate,e.isMetadata,e.checkedKeys),u=Object(r.useState)([]),m=Object(i.a)(u,2),h=m[0],b=m[1];Object(r.useEffect)((function(){Object(l.e)(t).then((function(e){b(d(e,[]))}))}),[]);var p=Object(r.useCallback)((function(e,t){a&&a(t.node)}),[]);return Object(o.jsx)(s.a,{checkedKeys:n,loadData:function(e){var t=e.key,a=(e.children,e.fieldData),n=e.ancestors;return new Promise((function(e,i){Object(l.e)(a.referInfo.referEntityName).then((function(i){var r=d(i,["".concat(t)],[].concat(Object(c.a)(n),[a])),s=j(h,t,r);b(s),e(void 0)})).catch((function(){i()}))}))},treeData:h,checkable:!0,checkStrictly:!0,onCheck:p})};function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return m(e.fields,t,a)}function m(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.filter((function(e){return!e.isPrimary})).map((function(e){var n={key:h(t,"".concat(e.name)),title:"".concat(e.title),isLeaf:!0,fieldData:e,isRefer:!1,isCarry:t.length>0,ancestors:Object(c.a)(a)};return e.referInfo&&"refer"===e.bizType&&(n.key=h(t,"".concat(e.referInfo.aliasName||e.name)),n.isLeaf=!1,n.isRefer=!0),n}))}function h(e,t){return[].concat(Object(c.a)(e),[t]).join(".")}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return e.map((function(e){return e.key===t?Object(n.a)(Object(n.a)({},e),{},{children:a}):e.children?Object(n.a)(Object(n.a)({},e),{},{children:j(e.children,t,a)}):e}))}},903:function(e,t,a){},913:function(e,t,a){e.exports={settings:"style_settings__3qqpM","field-item":"style_field-item__1sgSD","field-item-title":"style_field-item-title__2q5UK"}},914:function(e,t,a){e.exports={"child-list-item":"style_child-list-item__1B3Ad"}},915:function(e,t,a){e.exports={container:"style_container__3xnij"}},916:function(e,t,a){e.exports={column:"style_column__3OTWc","cloumn-setting":"style_cloumn-setting__1TyeE","drop-over":"style_drop-over__oBtFf"}},919:function(e,t,a){e.exports={"template-section":"style_template-section__bCJWN","template-section_selected":"style_template-section_selected__3r_mE","template-section_actions":"style_template-section_actions__LVQDn"}},921:function(e,t,a){e.exports={container:"style_container__3ciRw",sider:"style_sider__2_Vpk"}},922:function(e,t,a){e.exports={"template-container":"style_template-container__2F8bx","template-content":"style_template-content__1j3Ir","template-footer":"style_template-footer__Bl03a"}},947:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ze}));var n,c=a(28),i=a.n(c),r=a(38),s=a(10),l=a(12),o=a(13),u=a(16),d=a(17),m=a(4),h=a(390),j=a(296),b=a(58),p=a(0),f=a(256),O=a(11),v=a(20),y=a(14),x=(a(304),function(){function e(t,a){Object(s.a)(this,e),this.entityName=t,this.items=a,Object(m.a)(this,"id",void 0)}return Object(l.a)(e,[{key:"getItem",value:function(e){return this.items.find((function(t){return t.path===e}))}},{key:"getItems",value:function(){return this.items}},{key:"setItems",value:function(e){this.items=e}},{key:"pathExist",value:function(e){return this.items.some((function(t){return t.path===e}))}},{key:"addItemFormMetadata",value:function(e){var t={path:e.key,displayName:[].concat(Object(v.a)(e.ancestors.map((function(e){return e.title}))),[e.title]).join("/"),alwaysHidden:!1,required:!1,readonly:e.isCarry||!1,isMulti:!1,isSystemField:e.fieldData.isSystemField};e.fieldData.isSystemField&&(t.readonly=!0,t.required=!1),this.items.push(t)}},{key:"updateMetaDataItem",value:function(e,t,a){var n=this.items.findIndex((function(t){return t.path===e}));n>-1&&(this.items[n]=Object(O.a)(Object(O.a)({},this.items[n]),{},Object(m.a)({},t,a)))}},{key:"removeMetaDataItem",value:function(e){this.items=this.items.filter((function(t){return t.path!==e}))}}]),e}()),k=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"createObservableMetadata",value:function(t){return Object(y.y)(e.createMetaData(t))}},{key:"createMetaData",value:function(e){return new x(e,[])}},{key:"wrapperMetadata",value:function(e){var t=new x(e.entityName,[]);return t.id=e.id,t.items=e.items||[],Object(y.y)(t)}}]),e}(),g=a(36),C=a(949),N=a(62),S=a(50),I=(a(114),a(55)),_=a(880),w=a(72),T=a(91),F=a(89),D=a(948),M=a(3),P=Object(I.a)((function(e){e.entityName;var t=e.onCheck,a=e.metadata,n=e.checkedKeys,c=a.items,i=(void 0===c?[]:c).map((function(e){return{key:e.path,title:e.displayName,isLeaf:!0,fieldData:e}})),r=Object(p.useCallback)((function(e,a){t&&t(a.node)}),[]);return Object(M.jsx)(D.a,{checkedKeys:n,treeData:i,checkable:!0,checkStrictly:!0,onCheck:r})})),K=a(890),R=Object(I.a)((function(e){e.entityName,e.template,e.metadata;var t=Object(F.a)(e,["entityName","template","metadata"]),a=p.useCallback((function(t){var a,n,c;(null===(a=e.template.currentSection)||void 0===a?void 0:a.pathExist(t.fieldData.path))?null===(n=e.template.currentSection)||void 0===n||n.removeTemplateColumn(t.fieldData.path):null===(c=e.template.currentSection)||void 0===c||c.addColumnFormMetadata(t.fieldData)}),[e.template]);return Object(M.jsx)(K.a,Object(O.a)(Object(O.a)({footer:null},t),{},{children:Object(M.jsx)(P,{entityName:e.entityName,checkedKeys:e.template.currentSectionPaths,onCheck:a,metadata:e.metadata})}))})),E=p.createContext(void 0),z=E.Provider,q=E.Consumer,A=a(397),L=a(185),V=a(140),B=a(913),H=a.n(B),W=Object(I.a)((function(e){var t=e.metadata,a=e.template,n=e.selectedFieldPath,c=function(e,t){a.currentSection&&a.currentSection.updateTemplateColumn(n,e,t)};if(!a.currentSection)return null;var i=a.currentSection.getField(n),r=t.getItem(n);return i?Object(M.jsxs)("div",{className:H.a.settings,children:[Object(M.jsxs)("div",{className:H.a["field-item"],children:[Object(M.jsx)("span",{className:H.a["field-item-title"],children:"\u663e\u793a\u540d\u79f0:"}),Object(M.jsx)("span",{className:H.a["field-item-body"],children:Object(M.jsx)(A.a,{size:"small",defaultValue:i.displayName,onBlur:function(e){return c("displayName",e.target.value)}})})]}),Object(M.jsxs)("div",{className:H.a["field-item"],children:[Object(M.jsx)("span",{className:H.a["field-item-title"],children:"\u662f\u5426\u5fc5\u586b:"}),Object(M.jsx)("span",{className:H.a["field-item-body"],children:Object(M.jsx)(L.a,{checked:i.required,onChange:function(e){return c("required",e.target.checked)},disabled:r.required})})]}),Object(M.jsxs)("div",{className:H.a["field-item"],children:[Object(M.jsx)("span",{className:H.a["field-item-title"],children:"\u662f\u5426\u53ea\u8bfb:"}),Object(M.jsx)("span",{className:H.a["field-item-body"],children:Object(M.jsx)(L.a,{checked:i.readonly,onChange:function(e){return c("readonly",e.target.checked)},disabled:r.readonly})})]}),Object(M.jsxs)("div",{className:H.a["field-item"],children:[Object(M.jsx)("span",{className:H.a["field-item-title"],children:"\u5bbd\u5ea6:"}),Object(M.jsx)("span",{className:H.a["field-item-body"],children:Object(M.jsxs)(V.a,{value:i.colSpan,onChange:function(e){return c("colSpan",e)},children:[Object(M.jsx)(V.a.Option,{value:1,children:"25%"}),Object(M.jsx)(V.a.Option,{value:2,children:"50%"}),Object(M.jsx)(V.a.Option,{value:3,children:"75%"}),Object(M.jsx)(V.a.Option,{value:4,children:"100%"})]})})]})]},n):null})),J=a(864),U=a(41),$=a(914),Q=a.n($),G=function(e){var t=U.a.getEntity(e.metadata.entityName),a=[];e.metadata.items.reduce((function(e,n){var c=n.path.split(".")[0];return!e[c]&&t.getField(c)&&t.getField(c).isDetail&&(e[c]={entityName:t.getField(c).referType,title:t.getField(c).title,path:c},a.push(e[c])),e}),{});return Object(M.jsx)("div",{className:Q.a["child-list"],children:a.map((function(t){return Object(M.jsx)("div",{className:Q.a["child-list-item"],onClick:function(){return function(t){e.template.appendChildSection(t)}(t)},children:"".concat(t.title,"(").concat(t.path,")")},t.path)}))})},X=C.a.TabPane;!function(e){e.FieldInfo="FieldInfo",e.ChildTable="ChildTable"}(n||(n={}));var Y=Object(I.a)((function(e){var t=e.metadata,a=e.template,c=e.entityName,i=Object(p.useState)(n.FieldInfo),r=Object(w.a)(i,2),s=r[0],l=r[1];return Object(M.jsxs)("div",{children:[Object(M.jsx)("div",{children:Object(M.jsxs)(b.a,{type:"primary",onClick:function(){T.a.show(R,{metadata:t,template:a,entityName:c})},disabled:!a.currentSectionId,children:[Object(M.jsx)(J.a,{}),"\u8bbe\u7f6e\u663e\u793a\u9879"]})}),Object(M.jsxs)(C.a,{size:"small",activeKey:s,onChange:function(e){l(e)},children:[Object(M.jsx)(X,{tab:"\u5b57\u6bb5\u8bbe\u7f6e",children:Object(M.jsx)(q,{children:function(e){var n=e.selectedFieldPath;return n&&Object(M.jsx)(W,{metadata:t,template:a,selectedFieldPath:n})}})},n.FieldInfo),Object(M.jsx)(X,{tab:"\u660e\u7ec6\u8868",children:Object(M.jsx)(G,{metadata:t,template:a})},n.ChildTable)]})]})})),Z=a(888),ee=a(940),te=a(906),ae=a(915),ne=a.n(ae),ce=a(365),ie=a(361),re=a(883),se=a(950),le=a(951),oe=a(5),ue=a.n(oe),de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},me=a(21),he=function(e,t){return p.createElement(me.a,Object.assign({},e,{ref:t,icon:de}))};he.displayName="SettingOutlined";var je,be,pe,fe,Oe,ve,ye,xe,ke=p.forwardRef(he),ge=a(916),Ce=a.n(ge),Ne=Z.a.Item,Se="card",Ie=Object(I.a)((function(e){var t=e.index,a=(e.className,e.children),n=e.moveItem,c=e.column,i=Object(F.a)(e,["index","className","children","moveItem","column"]),r=Object(p.useRef)(null),s=Object(se.a)({accept:Se,collect:function(e){return(e.getItem()||{}).index===t?{}:{isOver:e.isOver(),dropClassName:"".concat(Ce.a["drop-over"]),handlerId:e.getHandlerId()}},hover:function(e,t){console.log(e)},drop:function(e){n(e.index,t)}}),l=Object(w.a)(s,2),o=l[0],u=o.isOver,d=o.dropClassName,h=(o.handlerId,l[1]),j=Object(le.a)({type:Se,item:{index:t},collect:function(e){return{isDragging:e.isDragging()}}}),b=Object(w.a)(j,2),f=b[0].isDragging,v=b[1],y=f?0:1;return v(h(r)),Object(M.jsx)(q,{children:function(e){var t=e.onClick;e.selectedFieldPath;return Object(M.jsxs)(re.a,{span:6*(c.colSpan||1),ref:r,className:ue()(Ce.a.column,Object(m.a)({},d,u)),onClick:function(e){t(c.path)},children:[Object(M.jsx)(Ne,Object(O.a)(Object(O.a)({label:c.displayName,style:{cursor:"move",opacity:y},required:c.required},i),{},{children:a})),Object(M.jsx)("div",{className:Ce.a["cloumn-setting"],children:Object(M.jsx)(ke,{})})]})}})})),_e=a(85),we=a(884),Te=a(902),Fe=a.n(Te),De=a(919),Me=a.n(De),Pe=a(396),Ke=a(936),Re=Object(I.a)(je=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return e=t.call.apply(t,[this].concat(c)),Object(m.a)(Object(o.a)(e),"moveItem",(function(t,a){var n,c,i=e.props.template,r=null===(n=i.currentSection)||void 0===n?void 0:n.columns[t];i.currentSection.updateColumns(Fe()(null===(c=i.currentSection)||void 0===c?void 0:c.columns,{$splice:[[t,1],[a,0,r]]}))})),Object(m.a)(Object(o.a)(e),"handleSectionClick",(function(){var t=e.props,a=t.template,n=t.section;a.currentSectionId=n.id})),Object(m.a)(Object(o.a)(e),"handleTitleChange",(function(t){e.props.section.title=t.target.value})),Object(m.a)(Object(o.a)(e),"handAddSection",(function(){e.props.template.appendMasterSection()})),Object(m.a)(Object(o.a)(e),"componentPropsWrapper",(function(e){return{field:{disabled:e.readonly},model:e,mode:g.a.Create}})),e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.template,n=t.section;return Object(M.jsx)("div",{onMouseDown:this.handleSectionClick,className:ue()(Me.a["template-section"],Object(m.a)({},Me.a["template-section_selected"],a.currentSectionId&&n.id===a.currentSectionId)),children:Object(M.jsx)(ie.a,{leftElement:Object(M.jsx)(A.a,{placeholder:"\u672a\u547d\u540d",value:n.title,onChange:this.handleTitleChange}),rightElement:Object(M.jsxs)("span",{className:Me.a["template-section_actions"],children:[Object(M.jsx)(Pe.a,{onClick:function(){return a.removeMasterSection(n.id)}}),Object(M.jsx)(_e.a,{placement:"top",title:"\u6dfb\u52a0\u5206\u533a",children:Object(M.jsx)(Ke.a,{onClick:this.handAddSection})})]}),content:Object(M.jsx)(we.a,{gutter:12,children:n.columns.map((function(t,a){return Object(M.jsx)(Ie,{index:a,moveItem:e.moveItem,column:t,children:Object(ce.a)(e.componentPropsWrapper(t))},t.path)}))})})})}}]),a}(p.Component))||je,Ee=(Z.a.Item,Object(I.a)(be=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.template,a=e.template,n=(a=void 0===a?{}:a).master,c=void 0===n?[]:n,i=a.childTables,r=void 0===i?[]:i;return t?Object(M.jsx)(ee.a,{backend:te.a,children:Object(M.jsxs)(Z.a,{layout:"vertical",className:ne.a.container,children:[c.map((function(e){return Object(M.jsx)(Re,{template:t,section:e},e.id)})),r.map((function(e){return Object(M.jsx)(Re,{template:t,section:e},e.id)}))]})}):null}}]),a}(p.Component))||be),ze=a(921),qe=a.n(ze),Ae=Object(I.a)((fe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),n=t.call(this,e),Object(N.a)(Object(o.a)(n),"selectedFieldPath",Oe,Object(o.a)(n)),Object(m.a)(Object(o.a)(n),"handleAppendFields",(function(){T.a.show(R,{metadata:n.metadata,template:n.template,entityName:n.props.entityName})})),n.state={selectedFieldPath:""},n}return Object(l.a)(a,[{key:"selectedKeys",get:function(){return this.template.currentSectionPaths}},{key:"template",get:function(){return this.props.template}},{key:"metadata",get:function(){return this.props.metadata}},{key:"fieldProviderValue",get:function(){var e=this;return{selectedFieldPath:this.state.selectedFieldPath,onClick:function(t){e.setState({selectedFieldPath:t})}}}},{key:"render",value:function(){var e=this.props.entityName;return this.template?Object(M.jsx)(z,{value:this.fieldProviderValue,children:Object(M.jsxs)(_.a,{className:qe.a.container,children:[Object(M.jsx)(_.a.Content,{className:qe.a.content,children:Object(M.jsx)(Ee,{template:this.template})}),Object(M.jsx)(_.a.Sider,{theme:"light",className:qe.a.sider,children:Object(M.jsx)(Y,{entityName:e,template:this.template,metadata:this.metadata})})]})}):null}}]),a}(p.Component),Oe=Object(S.a)(fe.prototype,"selectedFieldPath",[y.A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(fe.prototype,"selectedKeys",[y.l],Object.getOwnPropertyDescriptor(fe.prototype,"selectedKeys"),fe.prototype),Object(S.a)(fe.prototype,"template",[y.l],Object.getOwnPropertyDescriptor(fe.prototype,"template"),fe.prototype),Object(S.a)(fe.prototype,"metadata",[y.l],Object.getOwnPropertyDescriptor(fe.prototype,"metadata"),fe.prototype),pe=fe))||pe,Le=function(e){var t=e.onChange,a=e.handleRemove,n=e.entityName,c=U.a.getEntity(n),i=function(e){var t=c.getField(e.path);return!t||t.isSystemField};return[{dataIndex:"index",title:"\u5e8f\u53f7",render:function(e,t,a){return Object(M.jsx)("span",{children:a+1})},width:40},{dataIndex:"displayName",title:"\u540d\u79f0",render:function(e,a){return Object(M.jsx)(A.a,{size:"small",value:e,onChange:function(e){return t(a.path,"displayName",e.target.value)}})}},{dataIndex:"path",title:"\u8def\u5f84",width:200},{dataIndex:"required",title:"\u662f\u5426\u5fc5\u586b",render:function(e,a){return Object(M.jsx)(L.a,{checked:e,onChange:function(e){return t(a.path,"required",e.target.checked)},disabled:i(a)})}},{dataIndex:"readonly",title:"\u662f\u5426\u53ea\u8bfb",render:function(e,a){return Object(M.jsx)(L.a,{checked:e,onChange:function(e){return t(a.path,"readonly",e.target.checked)},disabled:i(a)})}},{dataIndex:"alwaysHide",title:"\u662f\u5426\u9690\u85cf",render:function(e,a){return Object(M.jsx)(L.a,{checked:e,onChange:function(e){return t(a.path,"alwaysHide",e.target.checked)}})}},{dataIndex:"actions",title:"\u64cd\u4f5c",render:function(e,t){return Object(M.jsx)("div",{children:Object(M.jsx)(b.a,{type:"link",size:"small",onClick:function(){return a(t.path)},children:"\u5220\u9664"})})}}]},Ve=a(899),Be=a(900),He=Object(I.a)((ye=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),n=t.call(this,e),Object(m.a)(Object(o.a)(n),"handleItemChange",(function(e,t,a){n.props.metadata.updateMetaDataItem(e,t,a)})),Object(m.a)(Object(o.a)(n),"handleOnCheck",(function(e){var t,a,c=n.props,i=c.metadata,r=c.template,s=e.key;i.pathExist(s)?(i.removeMetaDataItem(s),(null===(t=r.currentSection)||void 0===t?void 0:t.pathExist(s))&&(null===(a=r.currentSection)||void 0===a||a.removeTemplateColumn(s))):i.addItemFormMetadata(e)})),Object(m.a)(Object(o.a)(n),"handleOnSort",(function(e){n.props.metadata.setItems(e)})),Object(m.a)(Object(o.a)(n),"handleRemove",(function(e){var t=n.props,a=t.metadata,c=t.template;a.removeMetaDataItem(e),c.removeFieldFormSection(e)})),Object(m.a)(Object(o.a)(n),"getSortTableProps",(function(){return{onChange:n.handleItemChange,handleRemove:n.handleRemove,entityName:n.props.entityName}})),n}return Object(l.a)(a,[{key:"checkedKeys",get:function(){return this.props.metadata.items.map((function(e){return e.path}))}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(M.jsxs)(_.a,{children:[Object(M.jsx)(_.a.Content,{children:Object(M.jsx)(Ve.a,{bordered:!0,size:"small",rowKey:"path",pagination:!1,dataSource:Object(v.a)(this.props.metadata.items),columns:Le(this.getSortTableProps()),onSort:this.handleOnSort})}),Object(M.jsx)(_.a.Sider,{style:{width:"400px"},theme:"light",children:Object(M.jsx)(Be.a,{checkedKeys:this.checkedKeys,entityName:this.props.entityName,onCheck:this.handleOnCheck})})]})}}]),a}(p.Component),Object(S.a)(ye.prototype,"checkedKeys",[y.l],Object.getOwnPropertyDescriptor(ye.prototype,"checkedKeys"),ye.prototype),ve=ye))||ve,We=a(922),Je=a.n(We),Ue=a(863);a(304);!function(e){e.Vertical="vertical",e.Horizontal="horizontal"}(xe||(xe={}));var $e,Qe=function(){function e(t){Object(s.a)(this,e),this.entityName=t,Object(m.a)(this,"id",void 0),Object(m.a)(this,"layout",xe.Vertical),Object(m.a)(this,"master",[]),Object(m.a)(this,"childTables",[]),Object(m.a)(this,"_currentSectionId",void 0),Object(m.a)(this,"currentSectionId",void 0),Object(y.y)(this),this.init()}return Object(l.a)(e,[{key:"currentSection",get:function(){var e=this;if(!this.currentSectionId)return null;var t=this.master.find((function(t){return t.id===e.currentSectionId}));return t||this.childTables.find((function(t){return t.id===e.currentSectionId}))}},{key:"currentSectionPaths",get:function(){var e=this.currentSection;return e?this.master.some((function(t){return t.id===e.id}))?this.master.map((function(e){return e.columns.map((function(e){return e.path}))})).flat(1/0):this.childTables.find((function(t){return t.id===e.id})).columns.map((function(e){return e.path})):[]}},{key:"init",value:function(){var e=new Ge({});e.title="\u57fa\u672c\u4fe1\u606f",this.master.push(e)}},{key:"setMaster",value:function(e){this.master=e.map((function(e){return new Ge(e)}))}},{key:"setChildTables",value:function(e){this.childTables=e.map((function(e){return new Ge(e)}))}},{key:"appendMasterSection",value:function(){var e=new Ge({});this.master.push(e)}},{key:"removeMasterSection",value:function(e){this.master=this.master.filter((function(t){return t.id!==e})),this.currentSectionId===e&&(this.currentSectionId=void 0),this.master.length||this.init()}},{key:"appendChildSection",value:function(e){if(!this.childTables.some((function(t){return t.path===e.path}))){var t=new Ge({});t.path=e.path,t.title=e.title,this.childTables.push(t)}}},{key:"removeFieldFormSection",value:function(e){[].concat(Object(v.a)(this.master),Object(v.a)(this.childTables)).forEach((function(t){t.removeTemplateColumn(e)}))}}]),e}(),Ge=function(){function e(t){var a=this,n=t.columns,c=void 0===n?[]:n,i=t.title,r=t.path;Object(s.a)(this,e),Object(m.a)(this,"id",Object(Ue.a)()),Object(m.a)(this,"title",void 0),Object(m.a)(this,"entityName",void 0),Object(m.a)(this,"path",void 0),Object(m.a)(this,"columns",[]),Object(m.a)(this,"updateColumns",(function(e){a.columns=e})),this.columns=c,this.title=i,this.path=r,Object(y.y)(this)}return Object(l.a)(e,[{key:"getField",value:function(e){return this.columns.find((function(t){return t.path===e}))}},{key:"getColumns",value:function(){return this.columns}},{key:"setColumns",value:function(e){this.columns=e}},{key:"pathExist",value:function(e){return this.columns.some((function(t){return t.path===e}))}},{key:"addColumnFormMetadata",value:function(e){var t=Object(O.a)(Object(O.a)({},e),{},{colSpan:1});this.columns.push(t)}},{key:"updateTemplateColumn",value:function(e,t,a){var n=this.columns.findIndex((function(t){return t.path===e}));n>-1&&(this.columns[n]=Object(O.a)(Object(O.a)({},this.columns[n]),{},Object(m.a)({},t,a)))}},{key:"removeTemplateColumn",value:function(e){this.columns.some((function(t){return t.path===e}))&&(this.columns=this.columns.filter((function(t){return t.path!==e})))}}]),e}(),Xe=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"createObservableTemplate",value:function(e){return new Qe(e)}},{key:"wrapperTemplate",value:function(e){var t=new Qe(e.entityName);return t.id=e.id,Array.isArray(e.master)&&e.master.length&&(t.setMaster(e.master),t.setChildTables(e.childTables)),t.layout=e.layout,t}}]),e}(),Ye=C.a.TabPane,Ze=Object(I.a)($e=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e),Object(m.a)(Object(o.a)(n),"entityName",void 0),Object(m.a)(Object(o.a)(n),"metadata",void 0),Object(m.a)(Object(o.a)(n),"template",void 0),Object(m.a)(Object(o.a)(n),"mode",void 0),Object(m.a)(Object(o.a)(n),"init",Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return e.next=5,n.getTemplate();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),h.b.error("\u521d\u59cb\u5316\u5931\u8d25");case 10:return e.prev=10,n.setState({loading:!1}),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})))),Object(m.a)(Object(o.a)(n),"getMetadata",Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.f)(n.entityName);case 2:if(!(t=e.sent)){e.next=6;break}return n.metadata=k.wrapperMetadata(t),e.abrupt("return");case 6:n.metadata=k.createObservableMetadata(n.entityName);case 7:case"end":return e.stop()}}),e)})))),Object(m.a)(Object(o.a)(n),"getTemplate",Object(r.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.mode!==g.a.Create){e.next=4;break}n.template=Xe.createObservableTemplate(n.entityName),e.next=12;break;case 4:if(n.mode!==g.a.Edit){e.next=12;break}return e.next=7,Object(f.g)(n.entityName);case 7:if(t=e.sent){e.next=11;break}return h.b.error("\u6a21\u677f\u4e0d\u5b58\u5728"),e.abrupt("return");case 11:n.template=Xe.wrapperTemplate(t);case 12:case"end":return e.stop()}}),e)})))),Object(m.a)(Object(o.a)(n),"handleItemChange",(function(e,t,a){n.metadata.updateMetaDataItem(e,t,a)})),Object(m.a)(Object(o.a)(n),"handleOnCheck",(function(e){n.metadata.addItemFormMetadata(e),n.forceUpdate()})),Object(m.a)(Object(o.a)(n),"handleOnSort",(function(e){n.metadata.setItems(e),n.forceUpdate()})),Object(m.a)(Object(o.a)(n),"handleSave",Object(r.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n.metadata.id){e.next=6;break}return e.next=4,Object(f.j)(n.metadata);case 4:e.next=8;break;case 6:return e.next=8,Object(f.c)(n.metadata);case 8:if(!n.template.id){e.next=13;break}return e.next=11,Object(f.k)(n.template);case 11:e.next=15;break;case 13:return e.next=15,Object(f.d)(n.template);case 15:h.b.success("\u4fdd\u5b58\u6210\u529f"),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0),h.b.error("\u4fdd\u5b58\u5931\u8d25");case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))),Object(m.a)(Object(o.a)(n),"handleTabChange",(function(e){n.setState({activeKey:e})})),Object(m.a)(Object(o.a)(n),"tabsRender",(function(){var e=n.state,t=e.tabs,a=void 0===t?[]:t,c=e.activeKey;return Object(M.jsx)(C.a,{activeKey:c,onChange:n.handleTabChange,children:a.map((function(e){var t=e.title,a=e.key,c=e.Component;return Object(M.jsx)(Ye,{tab:t,children:Object(M.jsx)(c,{entityName:n.entityName,metadata:n.metadata,template:n.template})},a)}))})}));var c=e.match.params;return n.state={loading:!0,activeKey:"metadata",tabs:[{key:"metadata",title:"\u5143\u6570\u636e",Component:He},{key:"template",title:"\u6a21\u677f",Component:Ae}]},n.entityName=c.entityName,n.mode=c.mode||g.a.Create,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){return this.metadata?Object(M.jsxs)(j.a,{className:Je.a["template-container"],spinning:!this.metadata,children:[this.tabsRender(),Object(M.jsx)("div",{className:Je.a["template-footer"],children:Object(M.jsx)(b.a,{type:"primary",onClick:this.handleSave,children:"\u4fdd\u5b58"})})]}):null}}]),a}(p.Component))||$e}}]);
//# sourceMappingURL=4.287e1484.chunk.js.map