{"version":3,"sources":["bizForm/components/Numeric/index.tsx","components/QueryListSolution/style.module.scss","bizAction/listActions/QueryAction/style.module.scss","bizList/QuickQuery/style.module.scss","http/graphql.ts","http/formData.ts","bizForm/components/Count/index.tsx","bizForm/components/DatePicker/index.tsx","bizForm/components/DatetimePicker/index.tsx","http/queryBuilder/index.ts","http/queryBuilder/queryBuilderHelper.ts","http/dataLoader/dataLoader.ts","Layout/style.module.scss","operator/index.ts","bizForm/page/form-zone/style.module.scss","http/entity.js","bizForm/components/QueryValueType/ValueTypeSelect.tsx","utils/stringUtils.ts","bizForm/components/EnumSelect/index.tsx","bizForm/components/Input/index.tsx","bizAction/ActionBar/style.module.scss","http/referDataLoader/index.ts","bizForm/components/SelectTable/AdvanceReferModal/index.tsx","bizForm/components/SelectTable/SingleSelectTable.tsx","bizForm/components/SelectTable/MutilSelectTable.tsx","bizForm/components/Refer/index.tsx","bizList/interface.ts","http/listDataLoader/index.ts","store/global.ts","bizList/core/bizList.ts","bizForm/modules/listInitiModule.ts","bizList/core/querySolution.ts","bizList/core/querySolutionHelper.ts","bizForm/page/form-zone/FormHeader/style.module.scss","http/template.js","http/merchant.ts","http/metadata.js","bizForm/page/form-zone/Section/style.module.scss","bizList/bizlistHeader/style.module.scss","http/queryColumn.ts","http/querySchema.ts","bizForm/modules/interface.ts","bizForm/lifecycleEvent/index.ts","bizForm/formMode/index.ts","components/BizSection/index.tsx","bizForm/components/MarkdownEditor/index.tsx","bizForm/components/ReferSelect/index.tsx","bizForm/components/TagsEditor/index.tsx","bizForm/components/index.tsx","bizForm/components/TimePicker/index.tsx","bizForm/components/Checkbox/index.tsx","bizForm/components/Textarea/index.tsx","bizForm/components/Carry/index.tsx","bizForm/components/Upload/index.tsx","components/QueryListSolution/ListSolution/queryColumn.ts","components/QueryListSolution/ListSolution/querySchema.ts","components/QueryListSolution/listSolutionPresenter.ts","common/upload.ts","components/Upload/index.tsx","components/LoadingContainer/style.module.scss","bizForm/components/DatetimePicker/style.module.scss","bizForm/page/form-zone/FormFieldElement/style.module.scss","components/LoadingContainer/index.tsx","http/error.js","http/http.js","metadata/entity.ts","metadata/enum.ts","metadata/metadataBase.ts","metadata/metadata.ts","router/routeUtils.ts","bizForm/components/QueryValueType/valueTypeMaps.ts","bizForm/modules/moduleManager.ts","Layout/config.tsx","Layout/Nav.tsx","router/baseRoutes.tsx","MST-Form/types/refer.ts","MST-Form/types/index.ts","MST-Form/MSTForm-utils.ts","MST-Form/MSTFormField.ts","MST-Form/validators/validator.ts","MST-Form/MSTForm.ts","MST-Form/validators/validatorUtils.ts","MST-Form/MSTFormHepler.ts","bizForm/core/model/componentMap.ts","bizForm/core/model/bizFormField.ts","bizForm/core/model/bizForm.ts","bizForm/modules/eventModule.ts","http/formDataLoader/index.ts","bizForm/modules/initiModule.ts","bizForm/modules/formModule.ts","bizAction/baseBizActionManager.ts","bizAction/formActions/index.ts","bizAction/formActions/EditAction/index.ts","bizAction/formActions/GotoListAction/index.ts","bizAction/formActions/RefreshAction/index.ts","bizAction/bizFormActionManager.ts","bizForm/bizFormPresenter.ts","pages/product/productFormPresenter.ts","bizForm/modules/listModule.ts","bizAction/listActions/CreateAction.ts","bizForm/components/BoolSelect/index.tsx","bizForm/components/BetweenWrapper/index.tsx","bizForm/components/CountBetween/index.tsx","bizForm/components/DatePickerBetween/index.tsx","bizForm/components/DatetimePickerBetween/index.tsx","bizForm/components/NumericBetween/index.tsx","bizForm/components/QueryValueType/index.tsx","utils/fieldPath.ts","../packages/gen/constants/enums/ValueType.ts","utils/valueTypeUtils.ts","components/QueryListSolution/QuerySchemaList.tsx","components/QueryListSolution/index.tsx","bizAction/listActions/QueryAction/QueryActionModal.tsx","bizAction/listActions/QueryAction/index.tsx","bizAction/listActions/index.tsx","bizAction/bizListActionManager.ts","bizAction/listRowActions/EditAction.ts","bizForm/context/bizFormContext.ts","bizForm/components/ImageViewer/index.tsx","bizForm/components/UrlViewer/index.tsx","bizForm/components/DatetimeViewer/index.tsx","bizForm/components/TextViewer/index.tsx","bizForm/components/CheckboxViewer/index.tsx","bizForm/components/ReferViewer/index.tsx","bizForm/components/MarkdownViewer/index.tsx","bizForm/components/TagsViewer/index.tsx","bizForm/components/EnumSelectViewer/index.tsx","bizForm/components/EntityFieldViewer/index.tsx","bizForm/page/form-zone/FormFieldElement/index.tsx","bizForm/page/form-zone/Section/index.tsx","bizAction/ActionBar/FormActionBar.tsx","bizForm/modules/moduleNames.ts","bizForm/page/form-zone/FormHeader/index.tsx","bizForm/page/form-zone/masterForm.tsx","bizForm/page/bizFormBody.tsx","bizForm/bizForm.tsx","bizAction/listRowActions/ViewAction.tsx","utils/formUtils.ts","bizAction/listRowActions/DeleteAction.ts","bizAction/listRowActions/index.ts","bizAction/bizListRowActionManager.ts","bizList/bizListPresenter.ts","pages/product/productListPresenter.tsx","router/bizFormRouter.tsx","bizAction/ActionBar/ListRowActionBar.tsx","bizList/bizlistBody.tsx","bizAction/ActionBar/ListActionBar.tsx","../packages/gen/types/enums/EmailType.ts","bizList/bizlistHeader/index.tsx","bizList/QuickQuery/index.tsx","bizList/bizList.tsx","router/bizListRouter.tsx","router/customeRoutes/product.ts","pages/order/orderFormPresenter.ts","router/customeRoutes/order.ts","pages/article/articleFormPresenter.ts","pages/article/articleListPresenter.tsx","router/customeRoutes/article.ts","pages/category/categoryFormPresenter.ts","pages/category/categoryListPresenter.tsx","router/customeRoutes/category.ts","pages/template/templateFormPresenter.ts","pages/template/templateListPresenter.tsx","router/customeRoutes/template.ts","../packages/gen/constants/enums/entityName.ts","pages/email/emailFormPresenter.ts","pages/email/emailListPresenter.tsx","router/customeRoutes/email.ts","pages/file/fileFormPresenter.ts","pages/file/fileListPresenter.tsx","router/customeRoutes/file.ts","router/customeRoutes/index.tsx","router/index.tsx","http/base.js","components/InitDataLoader/index.tsx","router/noSiderRoutes.tsx","components/AuthCheck/index.tsx","Layout/header.tsx","App.tsx","reportWebVitals.ts","index.tsx","components/Modals/index.tsx","common/constants/token.ts","bizForm/modules/baseModule.ts"],"names":["Numeric","props","React","value","setValue","focused","setFocused","editFormatter","precision","max","min","formateValue","Number","split","isInteger","toFixed","submitFormatter","formatter","viewFormatter","onChange","e","val","target","undefined","isNaN","test","onFocus","onBlur","module","exports","queryBuilder","params","graphql","options","query","variables","http","url","method","data","graphqlAllData","postFormData","fetchFormListData","fetchFormAction","Count","DatePicker","moment","date","valueOf","disabled","DatetimePicker","className","styles","showTime","placeholder","QueryBuilder","this","entityName","fields","Array","from","Set","criteriaStr","sorts","generateGraphqlString","field","includes","push","queryCondition","queryConditionStr","length","join","parseQueryFields","queryFields","entity","metadata","getEntity","childrenFields","posterityFields","forEach","fieldName","getField","isRefer","attrArr","result","subFields","filter","pFieldName","startsWith","map","slice","referType","QueryBuilderHelper","queryOptions","queryStr","DataLoader","pageNo","pageSize","create","observable","LoadingStatus","None","OperatorStore","avatar","localforage","removeItem","BIZ_AUTH","RouteUtils","to","fetchEntity","fetchEntities","useEffect","ValueTypeSelect","bizType","path","entityField","getFieldLastNode","getValueTypeOptions","StringUtils","str","toLowerCase","substring","toUpperCase","memo","enumName","isMutil","reset","getEnum","values","label","title","mode","Input","trim","ReferDataLoader","array","deep","init","initQueryBuilder","_params","toString","loadingStatus","Loading","then","res","total","replace","Complete","console","error","Failed","AdvanceReferModal","visible","onCancel","onOk","columns","onSearch","dataSource","handleRowClick","useCallback","record","event","width","wrapClassName","Search","allowClear","icon","UndoOutlined","onRow","onClick","SingleSelectTable","observer","createRef","_ref","current","contains","closeTable","_uniqBy","dataIndex","name","ellipsis","setState","showTable","index","indent","id","state","handleOnFocus","loading","stopPropagation","Modals","show","getColumns","displayFieldName","document","addEventListener","hiddenTable","removeEventListener","ref","classnames","_get","handleOnChange","addonAfter","handleAdvanceRefer","EllipsisOutlined","size","rowKey","pagination","bordered","toJS","scroll","y","rowClassName","rowOnClick","onDoubleClick","onContextMenu","onMouseEnter","onMouseLeave","Component","MutilSelectTable","selectedRowKeys","selectedRows","onSelectChange","closable","onClose","removeRecord","autoFocus","renderInput","rowSelection","getRowSelection","Refer","dataloader","getFields","item","some","unshift","SelectTable","defaultListData","count","hasNextPage","ListDataLoader","_cloneDeep","presenter","model","queryColumns","querySolution","items","isArray","valueType","listData","isDesc","runInAction","store","createInstance","BizListModel","queryColumn","visiable","col","displayName","isEnum","enumType","columnPath","querySchema","getItem","QUERY_SOLUTION_PREFIX","ListInitiModule","ModuleWrapper","ModuleNames","ModulePropertyWrapper","Presenter","EventModule","autobind","eventModule","on","LifecycleEvent","onModuleReady","loadData","Promise","all","fetchQueryColumn","fetchQuerySchema","loadQuerySolutionData","dataLoader","setCriteriaStr","getQueryStr","dispatch","onLoadedListInitData","valueTypes","QuerySolutionHelper","createQuerySchema","BaseModule","QuerySolution","find","getQueryItems","condition","ValueType","between","getItemValues","getPathStr","ge","le","in","nin","like","singleValuetype","mutilValueType","updateValues","Object","keys","getByPath","updateValueType","QuerySolutionItem","getValueTypeByPath","getValuesByPath","makeAutoObservable","defaultValueTypes","reduce","prev","cur","fetchTemplate","createTemplate","updateTemplate","removeTemplate","fetchTemplateList","asyncChangePassword","asyncUpdateAvatar","fetchMetadata","createMetadata","updateMetadata","createQueryColumn","updateQueryColumn","updateQuerySchema","fetchQuerySchemaList","FormAction","FormMode","BizSection","leftElement","rightElement","content","cx","theme","lineNumbers","ReferSelect","logicPath","getName","prefixEntityLen","fileName","TagsEditor","inputVisible","inputValue","editInputIndex","editInputValue","removedTag","tags","getTags","tag","inputRef","focus","indexOf","editInputRef","handleEditInputChange","handleEditInputConfirm","onPressEnter","isLongTag","tagElem","handleClose","preventDefault","type","handleInputChange","handleInputConfirm","showInput","PlusOutlined","componentMapping","Text","Date","Time","_","timeString","Datetime","Checkbox","checked","Textarea","TextArea","rows","Carry","format","Markdown","onBeforeChange","editor","EnumSelect","Image","matchComponent","itemProps","component","isCarry","Comp","proccessProps","set","require","QueryColumn","key","ancestors","ancestor","isContextField","isDisabledSummary","isDisabledExport","fieldData","isSystemField","findIndex","getItems","QueryColumnUtils","Reflect","ownKeys","QuerySchema","newItem","isQuickQuery","QuerySchemaUtils","ListSolutionPresenter","querySchemaItems","authInfo","a","getAuthInfo","beforeUpload","file","isLt10M","message","SimpleUpload","upyunOptions","useMemo","action","upyun","getUpyunConfig","useState","setLoading","uploadButton","LoadingOutlined","listType","showUploadList","info","status","img","callback","reader","FileReader","readAsDataURL","getBase64","originFileObj","response","headers","authorization","token","policy","src","alt","style","LoadingContainer","children","only","window","location","reload","errorMap","400","NOSESSIONTOKEN","notification","warn","handleError","errors","code","detail","baseURL","httpBase","axios","timeout","instance","interceptors","use","HandleError","reject","EntityField","backendDescription","referInfo","isPriamry","associationField","_clone","Entity","aliasFields","fieldnNameArr","shift","backendDescriptionInfo","EnumValue","Enum","description","enumValueName","enumValue","metadataBase","entities","enums","enttityName","referName","refer","refers","descriptions","metadatas","initEntity","initEnum","aliasName","entityFactory","initReferInfo","lowerCapital","referEntityName","metadataInstance","getReferConfig","getList","globalHistory","createBrowserHistory","listen","log","clear","_time","now","eq","ne","gt","lt","valueTypeMaps","enum","email","text","textarea","markdown","numeric","bool","datetime","valueTypeOptions","types","option","ModuleManager","Map","initModules","wireModules","apply","modules","moduleProperty","getModuleProperty","moduleName","moduleClass","moduleInstance","get","attributes","attr","attributeName","lookupModuleProperty","lookupModuleName","seeds","hasOwnProperty","has","MODULE_PROPERTY_KEY","prototype","propertyName","moduleProperties","constructor","configList","PieChartOutlined","Sider","Layout","SubMenu","Menu","Nav","selectedKey","setSelectedKey","historyLientener","selectedKeys","pathname","pathArr","keyPath","subItem","Item","Template","TemplateList","QuerySchemaList","DemoComponent","Settings","BaseRoutes","exact","ReferPrimitive","custom","fromSnapshot","snapshot","env","toSnapshot","isTargetType","getValidationMessage","JSON","stringify","mstTypes","getNode","$treenode","MSTFormField","disposers","reaction","validate","uuidv4","form","node","initSnapshot","initValidators","disposer","propName","defaultValue","stateMap","untracked","getStateMap","initState","lodashGet","getState","required","getValue","valiator","validateField","getMessageBypath","Validators","validators","validator","removeValidator","errorMessages","hasError","validateByPath","delete","select","messages","idx","msg","validateFirst","MSTForm","mstInstance","getSnapshot","unprotect","fieldOptions","i","call","getChildNode","getNodeByPath","fieldsMap","toJSON","changed","applySnapshot","addValidator","ValidatorUtils","num","len","MSTFormHelper","initValue","mstModel","createModel","MSTFormOptions","modelTypes","typeConstructor","createTypeConstructor","createModelTypes","views","self","actions","optional","string","getPrimitiveType","boolean","integer","number","fieldNames","componentsMap","BizFormField","templateColumn","metadataItem","isCarryField","err","readonly","alwaysHidden","isMulti","colSpan","upperCapital","carryType","pop","BizForm","formMetadata","formTemplate","master","childTables","table","flat","templateCol","formField","rootPath","rootMetadataItem","rootFormField","eventName","listener","listeners","eventStock","off","FormDataLoader","proccessQueryOptions","getTemplatepath","paths","template","section","InitModule","Create","initFormData","formDataLoader","onLoadedInitData","FormModule","onSave","save","getPostData","getChangeData","Save","afterSave","getElementById","scrollIntoView","behavior","BaseBizActionManager","defaultActions","func","Error","useCallbackList","EditAction","toForm","Edit","GotoListAction","toList","RefreshAction","getModule","reloadBizForm","BizFormActionManager","FormActions","BizFormPresenter","initForm","onFormCreated","$onFormCreated","config","_bizFormConfig","createForm","addRequiredValidatror","onFormInitialized","View","defaultConfig","formActionManager","bizFormConfig","ProductFormPresenter","ListModule","queryListData","resetQueryListSolutionValues","resetQueryListQueryValues","saveQueryOptions","resetValues","setItem","CreateAction","BetweenWrapper","CountBetween","DatePickerBetween","startOf","endOf","DatetimePickerBetween","NumericBetween","getTextInut","ReferSelectWrapper","getQuerySchemaInput","BoolSelect","getCountInut","getNumericInut","getDatePicker","getDatetimePicker","FieldPathUtils","pathInfo","pathItem","isDetail","ENUM_ValueType_between","ENUM_ValueType_in","ENUM_ValueType_nin","ENUM_ValueType_all_in","ENUM_ValueType_all_nin","ValueTypeUtils","getPathInfo","querySolutionItem","getBizType","getEnumType","QueryListSolution","showSetting","QueryActionModal","setValues","setValueTypes","okText","cancelText","QueryAction","DefaultListActions","BizListActionManager","presenterContext","PresenterProvider","Provider","loadingContext","Consumer","ImageViewer","height","fallback","UrlViewer","href","DatetimeViewer","TextViewer","CheckboxViewer","ReferViewer","MarkdownViewer","remarkPlugins","remarkGfm","remarkMath","rehypePlugins","rehypeRaw","components","inline","match","exec","String","a11yDark","language","PreTag","TagsViewer","getTitle","EntityFieldViewer","getEntityField","getColSpan","FormFieldElement","valuePropName","getValuePropName","getProps","span","Section","getFieldProps","fieldRender","FormActionBar","execute","getFormData","getActions","FormHeader","MasterFrom","changedValues","mstFormField","layout","formLayout","scrollToFirstError","getFormFields","onValuesChange","isShowFooter","onReset","BizFormBody","renderContent","initData","destructor","ViewModal","history","replaceState","prevHistoryUrl","resetPathname","footer","padding","ViewAction","FormUtils","DeleteAction","confirm","FormActionDelete","errMsg","DefaultListRowActions","BizListRowActionManager","BizListPresenter","initList","onLoadedListData","loadListData","_listBizConfig","onListInitialized","listActionManager","listRowActionManager","listBizConfig","ProductListPresenter","bizFormRoute","createPresenter","sensitive","Copy","route","render","BizAction","onConfirm","marginRight","ListRowActionBar","BizListBody","cellRender","x","showQuickJumper","showSizeChanger","handlePageChange","setSelectedRowKeys","forceUpdate","getSelectedRowKeys","fixed","page","showTitle","getCellRender","ListActionBar","marginLeft","ENUM_EmailType","BizListHeader","renderActions","QuickQuery","gutter","renderItems","BizList","bizListRouter","OrderFormPresenter","ArticleFormPresenter","ArticleListPresenter","column","color","CategoryFormPresenter","CategoryListPresenter","TemplateFormPresenter","TemplateListPresenter","ENUM_Entity_Email","ENUM_Entity_File","EmailFormPresenter","Normal","EmailListPresenter","FileFormPresenter","FileListPresenter","CustomeRoutes","productRoutes","orderRoutes","articleRoutes","categoryRoutes","templateRoutes","emailRoutes","fileRoutes","AppRouter","fetchBaseMetadata","descriptionsData","InitDataLoader","operatorId","Operator","Login","NoSiderRoutes","AuthCheck","setStatus","authCheck","open","Header","logout","placement","overlay","handleSetting","handleLogout","renderUserSetting","Content","App","locale","zhCN","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","modals","modal","install","resolve"],"mappings":"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","file":"static/js/main.975dc0ef.chunk.js","sourcesContent":["import * as React from 'react';\nimport {Input as AntdInput, InputProps} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\n\ninterface INumeric extends IBizFormComponentOProps {\n  precision?: number; // 精度 默认不控制\n  max?: number; // 默认值 Number.MAX_SAFE_INTEGER\n  min?: number; // 默认值 Number.MIN_SAFE_INTEGER\n  formatter?: (value: number | string) => string; // 输入框展示的格式\n}\n\n/**\n * 编辑时显示原始格式，失去焦点时显示格式化的文本\n * @param props\n * @returns\n */\nexport function Numeric (props: INumeric) {\n  const [ value, setValue ] = React.useState(props.value);\n  const [ focused, setFocused ] = React.useState(false);\n\n  React.useEffect(() => {\n    setValue(props.value);\n  }, [ props.value ]);\n\n  const onChange = (e: any) => {\n    const val = e.target.value;\n    const reg = /^-?\\d*(\\.\\d*)?$/;\n    if (val === '') {\n      setValue(undefined);\n    } else if (val === '-') {\n      setValue(val);\n    } else if (!isNaN(val) && reg.test(val)) {\n      setValue(editFormatter(val));\n    }\n  };\n\n  const onFocus = () => {\n    setFocused(true);\n  };\n\n  const onBlur = () => {\n    setFocused(false);\n    props.onChange && props.onChange(submitFormatter(value));\n  };\n\n  // 编辑时的格式化\n  const editFormatter = (value: string) => {\n    const {precision, max, min} = props;\n    let formateValue = Number(value);\n    if (formateValue < min) {\n      formateValue = min;\n    }\n\n    if (formateValue > max) {\n      formateValue = max;\n    }\n\n    const valueArr = value.split('.');\n    if (!valueArr[ 1 ] && precision !== 0) {\n      return value;\n    }\n    if (Number.isInteger(precision)) {\n      return Number(formateValue.toFixed(precision));\n    }\n\n    return value;\n  };\n\n  // 返回value根据precision, max, min,格式化后的数字\n  const submitFormatter = (value: number | string) => {\n    const {precision, max, min} = props;\n    if (typeof value === 'undefined' || value === '-') {\n      return undefined;\n    }\n    value = Number(value);\n    if (value < min) {\n      value = min;\n    }\n\n    if (value > max) {\n      value = max;\n    }\n\n    if (Number.isInteger(precision)) {\n      return Number(value.toFixed(precision));\n    }\n\n    return Number(value);\n  };\n\n  const viewFormatter = (value: number | string) => {\n    if (typeof props.formatter === 'function') {\n      return props.formatter(value);\n    }\n\n    if (typeof value === 'undefined') {\n      return undefined;\n    }\n\n    const {precision} = props;\n    value = Number(value);\n    // 后端可以添加千分位\n    if (Number.isInteger(precision)) {\n      return Number(value.toFixed(precision));\n    }\n\n    return Number(value);\n  };\n\n  return (\n    <AntdInput\n      {...props}\n      value={focused ? value : viewFormatter(value)}\n      onChange={onChange}\n      onFocus={onFocus}\n      onBlur={onBlur}\n    />\n  );\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"queryAction-item\":\"style_queryAction-item__400ih\",\"queryAction-item-label\":\"style_queryAction-item-label__2zW30\",\"queryAction-item-body\":\"style_queryAction-item-body__3I9Q4\",\"queryAction-item-valueType\":\"style_queryAction-item-valueType__1wpkm\",\"queryAction-item-values\":\"style_queryAction-item-values__11Gig\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"queryAction-item\":\"style_queryAction-item__3Ytmj\",\"queryAction-item-label\":\"style_queryAction-item-label__pj6X7\",\"queryAction-item-body\":\"style_queryAction-item-body__1D4vy\",\"queryAction-item-valueType\":\"style_queryAction-item-valueType__uFPCf\",\"queryAction-item-values\":\"style_queryAction-item-values__1rP5k\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"quick-query\":\"style_quick-query__2s9Pz\",\"quick-query-item\":\"style_quick-query-item__3p7iM\",\"quick-query-item_body\":\"style_quick-query-item_body__nIqJ0\",\"quick-query-actions\":\"style_quick-query-actions__3G-5I\"};","import {http} from './http';\n\nexport interface Options {\n  query: string;\n  variables?: {[key in string]: any};\n}\n\nexport interface graphqlQuery {\n  query: string;\n  operation?: string;\n  variables?: {[key in string]: any};\n}\n\nfunction queryBuilder (params: graphqlQuery) {\n  return {\n    ...params\n  };\n}\n\nexport function graphql (options: Options) {\n  const {query, variables} = options;\n  return http({\n    url: '/graphql',\n    method: 'post',\n    data: queryBuilder({query, variables})\n  });\n}\n\nexport function graphqlList (options: Options) {\n  const {query, variables} = options;\n  return http({\n    url: '/graphql/list',\n    method: 'post',\n    data: queryBuilder({query, variables})\n  });\n}\n\nexport function graphqlAllData (options: Options) {\n  const {query, variables} = options;\n  return http({\n    url: '/graphql/list/all',\n    method: 'post',\n    data: queryBuilder({query, variables})\n  });\n}\n","import {http} from './http';\n\nexport function fetchFormData (id: string, entityName: string) {\n  return http({\n    url: '/graphql',\n    method: 'post',\n    data: {\n      id,\n      entityName\n    }\n  });\n}\nexport function postFormData (data = {}) {\n  return http({\n    url: '/bizForm',\n    method: 'post',\n    data\n  });\n}\n\nexport function fetchFormListData (data = {}) {\n  return http({\n    url: '/bizForm/list',\n    method: 'post',\n    data\n  });\n}\n\nexport function fetchFormAction (data = {}) {\n  return http({\n    url: '/bizForm/action',\n    method: 'post',\n    data\n  });\n}\n","import * as React from 'react';\nimport { Input as AntdInput, InputProps } from 'antd';\nimport { IBizFormComponentOProps } from '../interface';\nimport { FormMode } from '@src/bizForm/formMode';\nimport { Numeric } from '../Numeric';\n\ninterface ICount extends IBizFormComponentOProps {\n\n}\n\n/**\n *整数\n * @param props \n * @returns \n */\nexport function Count(props: ICount) {\n    return <Numeric {...props} precision={0}/>\n}\n","import {DatePicker as AntDatePicker} from 'antd';\nimport moment from 'moment';\nimport {IBizFormComponentOProps} from '../interface';\n\nconst dateFormat = 'YYYY-MM-DD';\n\nexport interface IDataPicker extends IBizFormComponentOProps {}\n/**\n *\n * @param props 日期组件\n * @returns\n */\nexport const DatePicker = (props: IDataPicker) => {\n  const onChange = (date: any) => {\n    props?.onChange(date ? date.valueOf() : undefined);\n  };\n  return <AntDatePicker value={moment(props.value, dateFormat)} onChange={onChange} disabled={props.disabled} />;\n};\n","import {DatePicker as AntDatePicker} from 'antd';\nimport moment from 'moment';\nimport {useCallback} from 'react';\nimport {IBizFormComponentOProps} from '../interface';\nimport styles from './style.module.scss';\n\nexport interface IDatatimePicker extends IBizFormComponentOProps {}\n/**\n * datetime目前应该只能读不能编辑，因为通常是编辑日期、时间\n * @param props 日期组件\n * @returns\n */\nexport const DatetimePicker = (props: IBizFormComponentOProps) => {\n  return (\n    <AntDatePicker\n      className={styles[ 'datetime-picker' ]}\n      showTime\n      value={props.value ? moment(props.value) : undefined}\n      onChange={(value) => props.onChange(value ? value.valueOf() : undefined)}\n      disabled={props.disabled}\n      placeholder={''}\n    />\n  );\n};\n","/**\n * gql查询条件编译器\n * + 场景：\n *  + 根据选择的字段拼接 查询字符串\n *\n */\n\nimport { metadata } from \"@src/metadata/metadata\";\nimport { some } from \"lodash\";\n\ninterface ISort {\n  name: string; // 排序字段\n  isDesc: boolean; // 是否倒叙\n}\ninterface IQueryBuilder {\n  fields: string[];\n  entityName: string;\n  criteriaStr?: string;\n  sorts?: ISort[];\n  queryCondition?: string[],\n}\n\n/**\n * 所有实体的查询逗必须包含id字段\n */\nexport class QueryBuilder {\n  fields: string[];\n  entityName: string;\n  public criteriaStr?: string;\n  sorts?: ISort[];\n\n  constructor(private options: IQueryBuilder) {\n    this.entityName = options.entityName;\n    this.fields = Array.from(new Set(options.fields)); // 使用[...new Set()]的形式回提示错误\n    this.criteriaStr = options.criteriaStr;\n    this.sorts = options.sorts;\n  }\n\n  public toString() {\n    return this.generateGraphqlString();\n  }\n\n  // 添加查询字段\n  public addField(field: string) {\n    if (!this.fields.includes(field)) {\n      this.fields.push(field);\n    }\n    return this;\n  }\n\n  public setCriteriaStr(criteriaStr: string) {\n    this.criteriaStr = criteriaStr;\n    return this;\n  }\n\n  private generateGraphqlString() {\n    const queryCondition: string[] = [...(this.options.queryCondition || [])];\n    if (this.criteriaStr) {\n      queryCondition.push(`queryStr: \"${this.criteriaStr}\"`);\n    }\n    if (this.sorts) {\n      queryCondition.push(`sorts: ${this.sorts}`);\n    }\n    let queryConditionStr = \"\";\n    if (queryCondition.length) {\n      queryConditionStr = `(${queryCondition.join(\",\")})`;\n    }\n\n    return `{${this.entityName}${queryConditionStr}{\n        ${this.parseQueryFields(this.entityName, this.fields).join(\" \")}\n    }}`;\n  }\n\n  // 将查询的属性转换成gql query的形式\n  private parseQueryFields(entityName: string, queryFields: string[]) {\n    const entity = metadata.getEntity(entityName);\n    const childrenFields: string[] = []; // 子属性，\n    const posterityFields: string[] = []; // 后代属性\n\n    queryFields.forEach((fieldName) => {\n\n      if (fieldName.split(\".\").length === 1) {\n        const field = entity.getField(fieldName);\n        if (field && field.isRefer) {\n          // 如果是外键，那么必须有id属性\n          fieldName = `${fieldName}.id`;\n        }\n      }\n\n      if (fieldName.split(\".\").length > 1) {\n        const attrArr = fieldName.split(\".\");\n        if (!childrenFields.includes(attrArr[0])) {\n          childrenFields.push(attrArr[0]);\n        }\n        posterityFields.push(fieldName);\n      } else {\n          childrenFields.push(fieldName);\n      }\n    });\n\n      // 外建必须有id、name属性\n    if (!childrenFields.includes('id')) {\n      childrenFields.push('id');\n    }\n    if (!childrenFields.includes('name')) {\n      childrenFields.push(`name`);\n    }\n    \n    let result: string[] = [];\n    // 转换子节点\n    childrenFields.forEach((fieldName) => {\n      const field = entity.getField(fieldName);\n      if (field && !field.isRefer) { \n        // 普通字段直接塞进数组\n        result.push(fieldName);\n      } else {\n        // 携带字段、外键的处理\n        const subFields = posterityFields\n          .filter((pFieldName) => pFieldName.startsWith(`${fieldName}.`))\n          .map((pFieldName) => {\n            return pFieldName.split('.').slice(1).join('.');\n          });\n        result.push(\n          `${fieldName}{${this.parseQueryFields(\n            field.referType,\n            subFields\n          ).join(\" \")}}`\n        );\n      }\n    });\n\n    return result;\n  }\n}\n","import { observable } from \"mobx\";\nimport { QueryBuilder } from \"../queryBuilder\";\n\n/**\n * Dataloader graphql和queryBuilder的基础上封装了查询的逻辑，\n * 将一部分逻辑抽离出来dataloader自己管理；\n * 1. 自动管理分页问题\n * 2. 管理查询状态\n */\nexport interface IDataloaderQueryOptions {\n  queryFields: string[];\n  queryStr?: string;\n  queryCondition?: string[];\n}\n\nexport interface IDataloaderOptions {\n   entityName: string,\n   queryOptions: IDataloaderQueryOptions\n}\n\n/**\n * 提供dataLoader的基础逻辑，必须作为父类使用\n */\nexport class QueryBuilderHelper {\n\n    static create(options: IDataloaderOptions) {\n       return new QueryBuilder({\n            entityName: options.entityName,\n            criteriaStr: options.queryOptions.queryStr,\n            fields: options.queryOptions.queryFields,\n            queryCondition: options.queryOptions.queryCondition,\n          });\n    }\n}\n\n","import {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {IMetadata} from '@src/interfaces/metadata';\nimport {ITemplate} from '@src/interfaces/template';\nimport {observable} from 'mobx';\nimport {BaseDataLoader} from '../baseDataLoader/dataloader';\nimport {QueryBuilder} from '../queryBuilder';\nimport {QueryBuilderHelper} from '../queryBuilder/queryBuilderHelper';\n\n/**\n * Dataloader graphql和queryBuilder的基础上封装了查询的逻辑，\n * 将一部分逻辑抽离出来dataloader自己管理；\n * 1. 自动管理分页问题\n * 2. 管理查询状态\n */\nexport interface IDataloaderQueryOptions {\n  queryFields: string[];\n  queryStr?: string;\n  id?: string;\n  queryCondition?: string[];\n  pageSize?: number;\n  pageNo?: number;\n}\n\nexport interface IDataloaderOptions {\n  entityName: string;\n  queryStr?: string;\n  logicPath?: string;\n  queryFields?: Array<string>;\n  // [key: string]: any;\n  // presenter: BizFormPresenter | BizListPresenter;\n}\n\n/**\n * 提供dataLoader的基础逻辑，必须作为父类使用\n */\nexport class DataLoader {\n  protected queryOptions: IDataloaderQueryOptions = {\n    queryFields: [],\n    queryCondition: [],\n    queryStr: '',\n    pageNo: 1,\n    pageSize: 10\n  };\n\n  public queryBuilder: QueryBuilder;\n\n  public data: any;\n\n  @observable\n  public loadingStatus = LoadingStatus.None;\n\n  constructor (protected options: IDataloaderOptions) {}\n\n  protected initQueryBuilder () {\n    this.queryBuilder = QueryBuilderHelper.create({\n      entityName: this.options.entityName,\n      queryOptions: this.queryOptions\n    });\n  }\n\n  public query (): void {}\n\n  public clear () {\n    // this.data.length = 0;\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout-header\":\"style_layout-header__2V4YS\",\"layout-sider\":\"style_layout-sider__3wuLp\"};","import {BIZ_AUTH} from '@src/common/constants/token';\nimport {RouteUtils} from '@src/router/routeUtils';\nimport localforage from 'localforage';\n\nclass Operator {\n  //  是否初始化完成\n  public isInitilized = false;\n  // operator的所有数据，暂时使用any，后面使用脚本生成entity的ts文件后改回去\n  public data: any;\n\n  public init (data: any) {\n    this.data = data;\n  }\n  public avatar () {\n    return this.data.avatar;\n  }\n  // 登出\n  public logout () {\n    localforage.removeItem(BIZ_AUTH);\n    RouteUtils.to('/login');\n  }\n}\n\nconst OperatorStore = new Operator();\n\nexport default OperatorStore;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"masterForm\":\"style_masterForm__1U5EF\",\"masterForm-body\":\"style_masterForm-body__1m9Ew\",\"masterForm-footer\":\"style_masterForm-footer__3cT__\",\"actions\":\"style_actions__1z6pP\"};","import {http} from './http';\n\nexport function fetchEntity (entityName) {\n  return http({\n    url: `/entity/${ entityName }`,\n    method: 'get'\n  });\n}\n\nexport function fetchEntities () {\n  return http({\n    url: '/entity/list',\n    method: 'get'\n  });\n}\n","import { metadata } from '@src/metadata/metadata';\nimport { Select } from 'antd';\nimport * as React from 'react';\nimport { getValueTypeOptions, IvalueTypeOption, ValueType } from './valueTypeMaps';\nconst { useEffect } = React;\n\nexport interface IValueTypeSelect {\n    value?: string;\n    onChange: (value: ValueType) => void;\n    bizType: string;\n    className?: string;\n    disabled?: boolean;\n    path: string;\n    entityName: string;\n}\n\nexport function ValueTypeSelect(props: IValueTypeSelect) {\n    const { bizType, value, onChange, className, disabled, path, entityName } = props;\n    let options: Array<IvalueTypeOption>\n    if (!bizType && path.split('.').length > 1) {\n        // 对于携带的字段，需要通过递归的方式，在最后一个entity上获取bizType\n        const entityField = metadata.getEntity(entityName).getFieldLastNode(path);\n        if (entityField) {\n            options = getValueTypeOptions(entityField.bizType);\n        }\n    } else {\n        options = getValueTypeOptions(bizType);\n    }\n\n    useEffect(() => {\n        // 如果没有默认值，则赋值options第一个选项的值为默认值\n        if (options.length) {\n            // onChange && onChange(options[0].value);\n        }\n    }, [])\n\n    return <Select\n        options={options}\n        value={value as any}\n        onChange={onChange}\n        className={className}\n        disabled={disabled} />\n}\n\n","export class StringUtils {\n  // 将字符串首字母转为小写\n  static lowerCapital (str: string) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n\n    return str[ 0 ].toLowerCase() + str.substring(1);\n  }\n\n  static upperCapital (str: string) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n\n    return str[ 0 ].toUpperCase() + str.substring(1);\n  }\n}\n","import {metadata} from '@src/metadata/metadata';\nimport {Select} from 'antd';\nimport React, {memo} from 'react';\nimport {EnumSelectProps} from './types';\nimport './style.scss';\n\nexport default memo(function EnumSelect (props: EnumSelectProps): JSX.Element {\n  const {enumName, isMutil, ...reset} = props;\n  const options: Array<{label: string; value: any}> =\n    metadata.getEnum(props.enumName)?.values.map((val) => ({\n      label: val.title,\n      value: val.value\n    })) || [];\n\n  // Mode = 'multiple' | 'tags' | 'combobox';\n  const mode = isMutil ? 'multiple' : undefined;\n  return <Select className=\"enum-select\" options={options} mode={mode} {...reset} />;\n});\n","import * as React from 'react';\nimport {Input as AntdInput} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\n\ninterface IInput extends IBizFormComponentOProps {}\n\nexport function Input (props: IInput) {\n  const {onChange = () => {}, value = '', ...reset} = props;\n  const handleChange = (e: any) => {\n    onChange(e.target.value);\n  };\n  const handleBlur = (e: React.FocusEvent): void => {\n    if (typeof value ===\"string\") {\n      onChange(value?.trim());\n    } else {\n      onChange(value);\n    }\n  };\n  return <AntdInput {...reset} value={value} onChange={handleChange} onBlur={handleBlur} />;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"actionbar\":\"style_actionbar__2ufoJ\",\"formAction-item\":\"style_formAction-item__PU5Zz\"};","import {DataLoader, IDataloaderOptions} from '../dataLoader/dataLoader';\nimport {graphqlAllData} from '../graphql';\nimport _get from 'lodash/get';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {observable} from 'mobx';\n\nexport interface IReferDataLoader extends IDataloaderOptions {}\n\n/**\n * 列表使用\n */\nexport class ReferDataLoader extends DataLoader {\n  \n  public data = observable.array([], {deep: false});\n\n  constructor (options: IReferDataLoader) {\n    super(options);\n    this.init();\n    this.initQueryBuilder();\n  }\n  \n  init () {\n    this.queryOptions.queryFields = this.options.queryFields || [];\n  }\n\n  public async query () {\n    const {entityName} = this.options;\n    const _params = {\n      query: this.queryBuilder.toString()\n    };\n    try {\n      this.loadingStatus = LoadingStatus.Loading;\n      await graphqlAllData(_params).then((res) => {\n        //@ts-ignore\n        const {data = {}, total} = res;\n        if (data) {\n          this.data.replace(data[ entityName ] ? data[ entityName ] : []);\n        }\n        this.loadingStatus = LoadingStatus.Complete;\n      });\n    } catch (err) {\n      console.error(err);\n      this.loadingStatus = LoadingStatus.Failed;\n    }\n  }\n}\n","import {Button, Input, Modal, Table} from \"antd\";\nimport React, {memo, useCallback} from \"react\";\nimport {AdvanceReferModalProps} from \"./types\";\nimport \"./style.scss\";\nimport { UndoOutlined } from \"@ant-design/icons\";\n\nconst AdvanceReferModal = (props: AdvanceReferModalProps): JSX.Element => {\n  const {visible, onCancel, onOk, columns = [], dataSource = [], onSearch, placeholder} = props;\n\n  const handleRowClick = useCallback((record, event) => {\n    onOk?.(record, event);\n  }, []);\n\n  return (\n    <Modal width={700} visible={visible} onCancel={onCancel} wrapClassName=\"advanceRefer\">\n      <div className={\"advanceRefer-header\"}>\n        <Input.Search allowClear onSearch={onSearch} placeholder={placeholder ?? \"请输入\"} />\n        <Button icon={<UndoOutlined />} className={\"advanceRefer-header-refresh\"}>刷新</Button>\n      </div>\n\n      <Table\n        columns={columns}\n        dataSource={columns}\n        onRow={(record) => {\n          return {\n            onClick: (event) => {\n              handleRowClick(record, event);\n            }, // 点击行\n            //   onDoubleClick: (event) => {},\n            //   onContextMenu: (event) => {},\n            //   onMouseEnter: (event) => {}, // 鼠标移入行\n            //   onMouseLeave: (event) => {},\n          };\n        }}\n      />\n    </Modal>\n  );\n};\n\nexport default memo(AdvanceReferModal);\n","import {Input, Table} from 'antd';\nimport {toJS} from 'mobx';\nimport {observer} from 'mobx-react';\nimport React, {createRef} from 'react';\nimport _get from 'lodash/get';\nimport './style.scss';\nimport {EllipsisOutlined} from '@ant-design/icons';\nimport classnames from 'classnames';\nimport _uniqBy from 'lodash/uniqBy';\nimport { Modals } from '@src/components/Modals';\nimport AdvanceReferModal from './AdvanceReferModal';\n\nconst DEFAULT_width = 200; // 默认宽度\n\ninterface EntityItem {\n  id: string;\n}\n\nexport interface ISelectTable<T> {\n  value: any;\n  onChange: (value: T) => void;\n  //   onInput: (value: T) => void;\n  onSearch: (value?: string) => void;\n  dataSource: T[];\n  fields: Array<{\n    name: string;\n    label: string;\n  }>;\n  displayFieldName?: string; // 在input框中显示的字段\n  loading?: boolean;\n  className?: string;\n  id?: string;\n  disabled?: boolean;\n}\n\ninterface SSelectTable {\n  showTable: boolean;\n}\n\n@observer\nexport class SingleSelectTable<T> extends React.Component<ISelectTable<T>, SSelectTable> {\n  _ref = createRef<HTMLDivElement>();\n\n  get displayFieldName () {\n    return this.props.displayFieldName || 'name';\n  }\n\n  constructor (props: ISelectTable<T>) {\n    super(props);\n    this.state = {\n      showTable: false\n    };\n  }\n\n  componentDidMount () {\n    document.addEventListener('click', this.hiddenTable, false);\n  }\n\n  componentWillUnmount () {\n    document.removeEventListener('click', this.hiddenTable, false);\n  }\n\n  private hiddenTable = (e: any) => {\n    if (this._ref.current && !this._ref.current.contains(e.target)) {\n      this.closeTable();\n    }\n  };\n\n  private getColumns = () => {\n    const {fields = []} = this.props;\n    return _uniqBy(fields, 'name').map((field) => ({\n      title: field.label,\n      dataIndex: field.name.split('.'),\n      ellipsis: true\n    }));\n  };\n\n  // 关闭下拉table\n  private closeTable = () => {\n    this.setState({\n      showTable: false\n    });\n  };\n\n  private rowOnClick = (record: T) => {\n    this.props.onChange && this.props.onChange(record);\n    this.closeTable();\n  };\n\n  // 行样式\n  private rowClassName = (record: any, index: number, indent: number) => {\n    if (this.props.value && this.props.value.id === record.id) {\n      // 行被选中\n      return 'select-table-row_selected';\n    }\n\n    return 'select-table-row';\n  };\n\n  private handleOnFocus = () => {\n    debugger;\n    if (!this.state.showTable) {\n      this.setState({\n        showTable: true\n      });\n      this.props?.onSearch();\n    }\n  };\n\n  private handleOnChange = (e: any) => {\n    this.handleOnFocus();\n    this.props?.onChange(undefined);\n  };\n\n  private handleAdvanceRefer = (e: React.MouseEvent<HTMLSpanElement>): void => {\n    const {value, dataSource, loading, disabled} = this.props;\n    // 阻止向上冒泡\n    e.stopPropagation();\n    this.setState({\n      showTable: false,\n    })\n\n    Modals.show(AdvanceReferModal, {\n      columns: this.getColumns(),\n      value,\n      dataSource\n    });\n  }\n\n  render () {\n    const {showTable} = this.state;\n    const {value, dataSource, loading, disabled} = this.props;\n    return (\n      <div ref={this._ref} id={this.props.id} className={classnames('select-table', this.props.className)}>\n        <Input\n          value={_get(value, this.displayFieldName, undefined)}\n          onFocus={this.handleOnFocus}\n          onChange={this.handleOnChange}\n          // suffix={<span onClick={this.handleAdvanceRefer}><EllipsisOutlined /></span>}\n          addonAfter={<span onClick={this.handleAdvanceRefer}><EllipsisOutlined /></span>}\n          disabled={disabled}\n        />\n\n        <div className={'select-table-body'}>\n          {showTable ? (\n            <div className={'select-table-body-list'}>\n              {/* <VirtualTable */}\n              <Table\n                // loading={loading}\n                size=\"small\"\n                rowKey=\"id\"\n                pagination={false}\n                bordered={true}\n                columns={this.getColumns()}\n                dataSource={(toJS(this.props.dataSource) || []) as any}\n                scroll={{y: 300}}\n                rowClassName={this.rowClassName}\n                onRow={(record) => {\n                  return {\n                    onClick: () => this.rowOnClick(record as T), // 点击行\n                    onDoubleClick: (event) => {},\n                    onContextMenu: (event) => {},\n                    onMouseEnter: (event) => {}, // 鼠标移入行\n                    onMouseLeave: (event) => {}\n                  };\n                }}\n              />\n            </div>\n          ) : null}\n        </div>\n      </div>\n    );\n  }\n}\n","import {Input, Table, Tag} from 'antd';\nimport {toJS} from 'mobx';\nimport {observer} from 'mobx-react';\nimport React, {createRef} from 'react';\nimport _get from 'lodash/get';\nimport './style.scss';\nimport classnames from 'classnames';\nimport _uniqBy from 'lodash/uniqBy';\n\nconst DEFAULT_width = 200; // 默认宽度\n\ninterface EntityItem {\n  id: string;\n}\n\nexport interface IMutilSelectTable<T> {\n  value: T[]; // 单选时就是对象，多选时就是数组\n  onChange: (value: T[]) => void;\n  onSearch: (value?: string) => void;\n  dataSource: T[];\n  fields: Array<{\n    name: string;\n    label: string;\n  }>;\n  displayFieldName?: string; // 在input框中显示的字段\n  loading?: boolean;\n  className?: string;\n  id?: string;\n  disabled?: boolean;\n}\n\ninterface SMutilSelectTable {\n  showTable: boolean;\n}\n\n@observer\nexport class MutilSelectTable<T> extends React.Component<IMutilSelectTable<T>, SMutilSelectTable> {\n  _ref = createRef<HTMLDivElement>();\n\n  get displayFieldName () {\n    return this.props.displayFieldName || 'name';\n  }\n\n  constructor (props: IMutilSelectTable<T>) {\n    super(props);\n    this.state = {\n      showTable: false\n    };\n  }\n\n  componentDidMount () {\n    document.addEventListener('click', this.hiddenTable, false);\n  }\n\n  componentWillUnmount () {\n    document.removeEventListener('click', this.hiddenTable, false);\n  }\n\n  private hiddenTable = (e: any) => {\n    if (this._ref.current && !this._ref.current.contains(e.target)) {\n      this.closeTable();\n    }\n  };\n\n  private getColumns = () => {\n    const {fields = []} = this.props;\n    return _uniqBy(fields, 'name').map((field) => ({\n      title: field.label,\n      dataIndex: field.name.split('.'),\n      ellipsis: true\n    }));\n  };\n\n  // 关闭下拉table\n  private closeTable = () => {\n    this.setState({\n      showTable: false\n    });\n  };\n\n  private handleOnFocus = () => {\n    if (!this.state.showTable) {\n      this.setState({\n        showTable: true\n      });\n      this.props.onSearch && this.props.onSearch();\n    }\n  };\n\n  private handleOnChange = (e: any) => {\n    this.handleOnFocus();\n    this.props.onChange && this.props.onChange(undefined);\n  };\n\n  private onSelectChange = (selectedRowKeys: string[], selectedRows: T[]) => {\n    this.props.onChange && this.props.onChange(selectedRows);\n  };\n\n  private getRowSelection = (): any => {\n    return {\n      selectedRowKeys: this.props.value.map((val) => _get(val, 'id')),\n      onChange: this.onSelectChange\n    };\n  };\n\n  render () {\n    const {showTable} = this.state;\n    return (\n      <div ref={this._ref} id={this.props.id} className={classnames('select-table', this.props.className)}>\n        {this.renderInput()}\n\n        <div className={'select-table-body'}>\n          {showTable ? (\n            <div className={'select-table-body-list'}>\n              {/* <VirtualTable */}\n              <Table\n                // loading={loading}\n                size=\"small\"\n                rowKey=\"id\"\n                pagination={false}\n                bordered={true}\n                rowSelection={this.getRowSelection()}\n                columns={this.getColumns()}\n                dataSource={(toJS(this.props.dataSource) || []) as any}\n                scroll={{y: 300}}\n              />\n            </div>\n          ) : null}\n        </div>\n      </div>\n    );\n  }\n\n  renderInput = () => {\n    const {value = [], disabled} = this.props;\n    const {showTable} = this.state;\n    return (\n      <div\n        className={classnames('mutil-select-input', {'mutil-select-input_disabled': disabled})}\n        onClick={this.handleOnFocus}\n        // onChange={this.handleOnChange}\n      >\n        {value.map((val) => (\n          <Tag key={_get(val, 'id')} closable onClose={() => this.removeRecord(_get(val, 'id'))}>\n            {_get(val, 'name')}\n          </Tag>\n        ))}\n        {showTable && <Input size=\"small\" className={'mutil-select-input_focus'} autoFocus disabled={disabled}/>}\n      </div>\n    );\n  };\n\n  private removeRecord = (id: string) => {\n    const value = this.props.value.filter((val) => _get(val, 'id') !== id);\n    this.props.onChange && this.props.onChange(value);\n  };\n}\n","import {DataLoader} from '@src/http/dataLoader/dataLoader';\nimport {ReferDataLoader} from '@src/http/referDataLoader';\nimport {Observer} from 'mobx-react';\nimport * as React from 'react';\nimport {MutilSelectTable, SingleSelectTable} from '../SelectTable';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {metadata} from '@src/metadata/metadata';\n\ninterface IRefer {\n  entityName: string; // 业务对象名称\n  value: any; // 传入的值\n  onChange: (value: any) => void; // 选择数据时触发\n  queryFields: Array<string>;\n  className?: string;\n  isMutil?: boolean; //多选\n  id?: string;\n  disabled?: boolean;\n}\n\n/**\n * 根據entityName自動查詢对应的数据\n * 系统里可以作为refer的数据都应该有id、title字段。ReferSelect组件读取对应的属性即可\n * refer只显示entity本身的字段，子表的字段不会显示\n * ReferSelect应作为受控组件使用\n * @param props\n * @returns\n */\nfunction Refer (props: IRefer) {\n  const {queryFields, entityName, isMutil} = props;\n\n  const dataloader: DataLoader = React.useMemo(() => {\n    return new ReferDataLoader({\n      entityName,\n      queryFields: queryFields.filter((fieldName) => !!fieldName)\n    });\n  }, [ entityName ]);\n\n  // 从presenter的template中筛选referEntityName开发的属性\n  const getFields = () => {\n    const entity = metadata.getEntity(entityName);\n    const fields = queryFields\n      .map((fieldName) => {\n        const entityField = entity.getFieldLastNode(fieldName);\n        if (entityField) {\n          return {\n            name: fieldName,\n            label: entityField.title\n          };\n        }\n        return null;\n      })\n      .filter((item) => !!item);\n\n    // 自动补充id字段\n    if (!fields.some((item) => item.name === 'id')) {\n      fields.unshift({\n        name: 'id',\n        label: 'id'\n      });\n      fields.push({\n        name: 'name',\n        label: entity.getField('name').title\n      });\n    }\n\n    return fields;\n  };\n\n  const onChange = (value: any) => {\n    props?.onChange(value);\n  };\n\n  const onSearch = (value: any) => {\n    dataloader.query();\n  };\n\n  const SelectTable = isMutil ? MutilSelectTable : SingleSelectTable;\n\n  return (\n    <Observer>\n      {() => (\n        <SelectTable\n          // loading={dataloader.loadingStatus}\n          id={props.id}\n          disabled={props.disabled}\n          value={props.value}\n          onChange={onChange}\n          onSearch={onSearch}\n          fields={getFields()}\n          dataSource={dataloader.data}\n          className={props.className}\n        />\n      )}\n    </Observer>\n  );\n}\n\nexport default Refer;\n","import React from 'react';\nimport _cloneDeep from 'lodash/cloneDeep';\nimport {IBizActionManager} from '@src/bizAction/interface';\n\nexport interface BizListConfig<T> {\n  // [path: string]: {\n  //   cellRender: (val: any, record: any) => React.ReactNode;\n  // };\n  // actionBar: Array<IBizAction>; // 列表操作按钮\n  // rowActionBar: Array<IBizRowAction>; // 行操作按钮\n\n  column?: {\n    [path: string]: {\n      cellRender?: (val: any, record: any) => React.ReactNode;\n    };\n  };\n  listActionManager: IBizActionManager<T>;\n  listRowActionManager: IBizActionManager<T>;\n}\n\nexport interface ListData {\n  data: Array<any>;\n  count: number;\n  pageSize: number;\n  pageNo: number;\n  hasNextPage?: boolean;\n}\n\nexport const defaultListData: ListData = {\n  data: [],\n  pageSize: 20,\n  pageNo: 1,\n  count: 0,\n  hasNextPage: false\n};\n\nexport const getDefaultListData = () => _cloneDeep(defaultListData);\n","import {DataLoader, IDataloaderOptions} from '../dataLoader/dataLoader';\nimport _get from 'lodash/get';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {BizFormListQueryParams, BizFormListQueryValue} from '@src/interfaces/bizFormListQuery';\nimport {fetchFormListData} from '../formData';\nimport {observable, runInAction} from 'mobx';\nimport {getDefaultListData} from '@src/bizList/interface';\n\nexport interface IListDataLoader extends IDataloaderOptions {\n  // logicPath: string;\n  entityName: string;\n  presenter: BizListPresenter;\n  queryStr?: string;\n  // querySolution: QuerySolution;\n}\n\n/**\n * 列表使用\n */\nexport class ListDataLoader extends DataLoader {\n  // 列表数据\n  // @observable\n  public override data = observable(getDefaultListData());\n\n  private presenter: BizListPresenter;\n\n  constructor (options: IListDataLoader) {\n    super(options);\n    this.presenter = options.presenter;\n    this.init();\n    this.initQueryBuilder();\n  }\n\n  init () {\n    this.queryOptions.queryFields = this.presenter.model.queryColumns;\n  }\n\n  public async query () {\n    const {entityName} = this.options;\n    const values: Array<BizFormListQueryValue> = this.presenter.querySolution.items\n      .filter((item) => {\n        if (!Array.isArray(item.values)) {\n          return false;\n        }\n        return item.values.filter((value) => value !== '' && value !== null && typeof value !== 'undefined').length > 0;\n      })\n      .map((item) => ({path: item.path, valueType: item.valueType, values: item.values}));\n    const params: BizFormListQueryParams = {\n      entityName: entityName,\n      queryStr: this.queryBuilder.criteriaStr,\n      columns: this.queryOptions.queryFields,\n      values: values,\n      pageSize: this.presenter.listData.pageSize,\n      pageNo: this.presenter.listData.pageNo,\n      sorts: [\n        {\n          name: 'updateTime',\n          isDesc: true\n        },\n        {\n          name: 'createTime',\n          isDesc: true\n        }\n      ]\n    };\n\n    try {\n      return await fetchFormListData(params).then((res) => {\n        //@ts-ignore\n        const data = res.data[ entityName ];\n        if (data) {\n          runInAction(() => {\n            this.data.data = data.data;\n            this.data.count = data.count;\n            this.data.pageSize = data.pageSize;\n            this.data.pageNo = data.pageNo;\n            this.data.hasNextPage = data.hasNextPage;\n          });\n        }\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  }\n}\n","import localforage from 'localforage';\n\nexport const store = localforage.createInstance({\n  name: 'global'\n});\n","import { IQueryColumn } from \"@src/interfaces/queryColumn\";\nimport { IQuerySchema } from \"@src/interfaces/queryScheme\";\nimport { metadata } from \"@src/metadata/metadata\";\nimport { store } from \"@src/store/global\";\nimport { FieldPathUtils } from \"@src/utils/fieldPath\";\n\n// 查询列表值的key的前缀\nconst BIZ_LIST_QUERY_VALUE_PREFIX = 'BIZ_LIST_QUERY_VALUE_PREFIX';\n\nexport interface IBizListOptions {\n    entityName: string;\n    queryColumn: IQueryColumn;\n    querySchema: IQuerySchema;\n}\n\nexport interface BizColumn {\n    path: string;\n    title: string;\n    bizType: string;\n    isRefer?: boolean;\n    enumType?: string;\n    referType?: string;\n}\n\nexport class BizListModel {\n\n    constructor(private options: IBizListOptions) {\n    }\n\n    // table显示的列 \n    public get columns(): Array<BizColumn> {\n        const entity = metadata.getEntity(this.options.entityName);\n        const columns: Array<BizColumn> = [];\n        // 添加queryColumn的数据\n        this.options.queryColumn.items.forEach(item => {\n            if (item.visiable) {\n                const entityField = entity.getField(item.path);\n                const col: BizColumn = {\n                    path: item.path,\n                    title: item.displayName,\n                    bizType: entityField ? entityField.bizType : '',\n                    isRefer: entityField ? entityField.isRefer : false,\n                };\n                if (entityField) {\n                    if (entityField.isEnum) {\n                        col.enumType = entityField.enumType\n                    }\n                    if (entityField.isRefer) {\n                        col.referType = entityField.referType;\n                    }\n                }\n                columns.push(col)\n            }\n        })\n        // 补充id\n        if (!columns.some(col => col.path === 'id')) {\n            columns.unshift({\n                path: 'id',\n                title: 'ID',\n                bizType: \"text\"\n            })\n        }\n\n        return columns\n    }\n\n    // 查询时的字段\n    public get queryColumns(): Array<string> {\n        const columnPath: Array<string> = [];\n        // 添加queryColumn的数据\n        this.options.queryColumn.items.forEach(item => {\n            columnPath.push(item.path)\n        })\n\n        return columnPath;\n    }\n\n    // 查询条件\n    public get querySchemaItems() {\n        return this.options.querySchema.items;\n    }\n\n    public get queryValue() {\n        const valuesMap = store.getItem(`${BIZ_LIST_QUERY_VALUE_PREFIX}_${this.options.entityName}`) || {};\n        return valuesMap;\n    }\n}","import { autobind } from 'core-decorators';\nimport { LifecycleEvent } from \"../lifecycleEvent\";\nimport { BaseModule } from \"./baseModule\";\nimport { EventModule } from \"./eventModule\";\nimport { ModuleNames } from \"./interface\";\nimport { ModulePropertyWrapper, ModuleWrapper } from \"./moduleManager\";\nimport { fetchQueryColumn } from '@src/http/queryColumn';\nimport { BizListPresenter } from '@src/bizList/bizListPresenter';\nimport { ListDataLoader } from '@src/http/listDataLoader';\nimport { BizListModel } from '@src/bizList/core/bizList';\nimport { fetchQuerySchema } from '@src/http/querySchema';\nimport localforage from 'localforage';\nimport { QuerySolutionHelper } from '@src/bizList/core/querySolutionHelper';\n\nexport const QUERY_SOLUTION_PREFIX = \"__QUERY_SOLUTION__\";\n\n// 整个页面的初始化模块\n@autobind\n@ModuleWrapper(ModuleNames.ListInitiModule)\nexport class ListInitiModule extends BaseModule {\n\n  @ModulePropertyWrapper(ModuleNames.Presenter) private presenter: BizListPresenter\n  @ModulePropertyWrapper(ModuleNames.EventModule) private eventModule: EventModule\n\n  public apply() {\n    this.eventModule.on(LifecycleEvent.onModuleReady, this.loadData)\n  }\n\n  // 加载tempalte、metadata、formData数据\n  private async loadData() {\n    const { presenter } = this;\n    // @TODO: 考虑抽离出去\n    const [queryColumn, querySchema] = await Promise.all([\n      fetchQueryColumn(presenter.entityName),\n      fetchQuerySchema(presenter.entityName),\n    ]);\n    // 获取form表单数据\n\n    presenter.queryColumn = queryColumn as any;\n    presenter.querySchema = querySchema as any;\n\n    presenter.model = new BizListModel({\n      entityName: presenter.entityName,\n      queryColumn: presenter.queryColumn,\n      querySchema: presenter.querySchema,\n    })\n\n    await this.loadQuerySolutionData();\n\n    const dataLoader: ListDataLoader = new ListDataLoader({\n      entityName: presenter.entityName,\n      presenter,\n      // @TODO: 暂时写死\n    });\n\n    presenter.dataLoader = dataLoader;\n\n    dataLoader.queryBuilder.setCriteriaStr(this.presenter.querySolution.getQueryStr())\n    await dataLoader.query();\n\n    presenter.listData = dataLoader.data\n\n    this.eventModule.dispatch(LifecycleEvent.onLoadedListInitData);\n  }\n\n  // 获取查询方案的数据\n  private async loadQuerySolutionData() {\n    const { presenter } = this;\n\n    const result = await localforage.getItem(\n        `${this.presenter.querySchema.id}${QUERY_SOLUTION_PREFIX}options`\n      ) as any;\n    const { values = {}, valueTypes } = result|| {};\n\n    presenter.querySolution = QuerySolutionHelper.createQuerySchema({\n      querySchema: presenter.querySchema,\n      options: {\n        values,\n        valueTypes,\n      },\n    });\n\n    this.eventModule.dispatch(LifecycleEvent.onLoadedListInitData);\n  }\n}\n","import {mutilValueType, singleValuetype, ValueType} from '@src/bizForm/components/QueryValueType/valueTypeMaps';\nimport {IQuerySchema} from '@src/interfaces/queryScheme';\nimport {metadata} from '@src/metadata/metadata';\nimport {autobind} from 'core-decorators';\nimport {makeAutoObservable, toJS} from 'mobx';\n\nexport interface IQuerySolution {\n  querySchema: IQuerySchema; // 后端获取的数据\n  options: {\n    values: {[key: string]: Array<any>}; // 上一次的查询条件\n    valueTypes: {[key: string]: ValueType}; // 上一次查询的operate\n  };\n}\n\nexport interface IQuerySolutionItem {\n  path: string;\n  valueType?: ValueType;\n  values?: Array<any>;\n}\n\n@autobind\nexport class QuerySolution {\n  public items: Array<QuerySolutionItem> = [];\n  public entityName: string;\n\n  constructor (private params: IQuerySolution) {\n    this.init();\n  }\n\n  private init () {\n    this.entityName = this.params.querySchema.entityName;\n    this.params.querySchema.items.forEach((item) => {\n      this.items.push(\n        new QuerySolutionItem({\n          path: item.path,\n          valueType: this.getValueTypeByPath(item.path),\n          values: this.getValuesByPath(item.path)\n        }),\n      );\n    });\n  }\n\n  private getValuesByPath = (path: string) => {\n    const {\n      options: {values}\n    } = this.params;\n    return values[ path ] || [];\n  };\n\n  private getValueTypeByPath = (path: string) => {\n    const {\n      options: {valueTypes}\n    } = this.params;\n    return valueTypes[ path ];\n  };\n\n  // 通过path查询\n  public getByPath = (path: string) => {\n    return this.items.find((item) => item.path === path);\n  };\n\n  // 获取有值的查询条件\n  public getQueryItems = () => {\n    return this.items.filter((item) => {\n      if (\n        Array.isArray(item.values) &&\n        item.values.length &&\n        item.values.some((val) => val !== undefined && val !== '')\n      ) {\n        return true;\n      }\n      return false;\n    });\n  };\n\n  private getPathStr = (item: QuerySolutionItem) => {\n    const entity = metadata.getEntity(this.entityName);\n    const entityField = entity.getFieldLastNode(item.path);\n    if (entityField && entityField.isRefer) {\n      return `${ item.path }.id`;\n    }\n    return item.path;\n  };\n\n  public getQueryStr = () => {\n    const items = this.getQueryItems();\n    const condition: Array<string> = [];\n    items.forEach((item) => {\n      // 区间\n      if (item.valueType === ValueType.between) {\n        const values = this.getItemValues(item);\n        if (Array.isArray(values)) {\n          // const strs = [];\n          if (values[ 0 ] !== undefined) {\n            condition.push(`${ this.getPathStr(item) } ${ ValueType.ge } ${ values[ 0 ] }`);\n          }\n          if (values[ 1 ] !== undefined) {\n            condition.push(`${ this.getPathStr(item) } ${ ValueType.le } ${ values[ 1 ] }`);\n          }\n          // if (strs.length) {\n          //   condition.push(`${this.getPathStr(item)} ${item.valueType} (${strs.join(\" and \")})`);\n          // }\n        }\n      }\n      // 包含， 不包含\n      if ([ ValueType.in, ValueType.nin ].includes(item.valueType)) {\n        const values = this.getItemValues(item);\n        if (Array.isArray(values)) {\n          condition.push(`${ this.getPathStr(item) } ${ item.valueType } (${ values.join(',') })`);\n        }\n      }\n\n      const value = this.getItemValues(item);\n      if (value !== undefined) {\n        condition.push(`${ this.getPathStr(item) } ${ item.valueType } ${ value }`);\n      }\n      //单值\n    });\n\n    return condition.join(' and ');\n  };\n\n  private getItemValues = (item: QuerySolutionItem) => {\n    const formateValue = (value: any) => {\n      if (value === undefined || value === '' || value === null) {\n        return undefined;\n      }\n      switch (typeof value) {\n        case 'string':\n          if (item.valueType === ValueType.like) {\n            return `'%${ value }%'`;\n          }\n          return `'${ value }'`;\n        case 'boolean':\n        case 'number':\n          return value;\n        case 'object':\n          return `'${ value.id }'`;\n        default:\n          return `'${ value }'`;\n      }\n    };\n\n    if (singleValuetype.includes(item.valueType)) {\n      return formateValue(item.values[ 0 ]);\n    }\n    if (item.valueType === ValueType.between) {\n      return [ formateValue(item.values[ 0 ]), formateValue(item.values[ 1 ]) ];\n    }\n    if (mutilValueType.includes(item.valueType)) {\n      return item.values.map((val) => formateValue(val));\n    }\n    return undefined;\n  };\n\n  // 重置所有查询条件\n  public resetValues = () => {\n    this.items.forEach((item) => {\n      item.updateValues([]);\n    });\n  };\n\n  public toJSON = () => {\n    const values: {[key: string]: Array<any>} = {};\n    const valueTypes: {[key: string]: ValueType} = {};\n    this.items.forEach((item) => {\n      values[ item.path ] = toJS(item.values);\n      valueTypes[ item.path ] = item.valueType;\n    });\n    return {\n      values,\n      valueTypes\n    };\n  };\n\n  public setValues = (values: {[path: string]: Array<any>}) => {\n    Object.keys(values).forEach((path: string) => {\n      const item = this.getByPath(path);\n      if (item) {\n        item.updateValues(values[ path ]);\n      }\n    });\n  };\n\n  public setValueTypes = (valueTypes: {[path: string]: ValueType}) => {\n    Object.keys(valueTypes).forEach((path: string) => {\n      const item = this.getByPath(path);\n      if (item) {\n        item.updateValueType(valueTypes[ path ]);\n      }\n    });\n  };\n}\n\n@autobind\nexport class QuerySolutionItem {\n  public path: string;\n\n  public valueType: ValueType;\n\n  public values: Array<any> = [];\n\n  constructor (options: IQuerySolutionItem) {\n    makeAutoObservable(this);\n    this.path = options.path;\n    this.valueType = options.valueType;\n    this.values = options.values || [];\n  }\n\n  public updateValueType = (valueType: ValueType) => {\n    this.valueType = valueType;\n  };\n\n  public updateValues = (values: Array<any>) => {\n    if (!Array.isArray(values)) {\n      this.values = [ values ];\n    } else {\n      this.values = values;\n    }\n  };\n\n  public toJSON = () => {\n    return {\n      path: this.path,\n      valueType: this.valueType,\n      values: this.values\n    };\n  };\n}\n","import { IQuerySchema, IQuerySchemaItem } from \"@src/interfaces/queryScheme\";\nimport { makeAutoObservable } from \"mobx\";\nimport { IQuerySolution, QuerySolution } from \"./querySolution\";\n\nexport interface IQuerySolutionHelper {\n  querySchema: IQuerySchema;\n}\n\nexport class QuerySolutionHelper {\n  static createQuerySchema(params: IQuerySolution) {\n    // 设置默认的valueTypes\n    const  defaultValueTypes = params.querySchema.items.reduce(\n      (prev: any, cur: IQuerySchemaItem) => {\n        prev[cur.path] = cur.valueType;\n        return prev;\n      },\n      {} as any\n    );\n    params.options.valueTypes = {\n      ...defaultValueTypes,\n      ...(params.options.valueTypes || {})\n    }\n    return makeAutoObservable(new QuerySolution(params));\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form-header\":\"style_form-header__2hYFl\",\"form-header-title\":\"style_form-header-title__2qrZ6\"};","import {http} from './http';\n\nexport function fetchTemplate (entityName) {\n  return http({\n    url: `/template/${ entityName }`,\n    method: 'get'\n  });\n}\n\nexport function createTemplate (data) {\n  return http({\n    url: '/template',\n    method: 'post',\n    data\n  });\n}\n\nexport function updateTemplate (data) {\n  return http({\n    url: '/template',\n    method: 'put',\n    data\n  });\n}\n\nexport function removeTemplate (data) {\n  return http({\n    url: '/template',\n    method: 'delete',\n    data\n  });\n}\n\nexport function fetchTemplateList (params = {}) {\n  return http({\n    url: '/template/list',\n    method: 'get',\n    params\n  });\n}\n","/*\n * File: metadata copy.js\n * Project: biz-form\n * File Created: Thursday, 22nd July 2021 10:41:34 pm\n * Author: zxtang (1061225829@qq.com)\n * -----\n * Last Modified: Thursday, 22nd July 2021 10:41:34 pm\n * Modified By: zxtang (1061225829@qq.com>)\n * -----\n * Copyright 2017 - 2021 Your Company, Your Company\n */\nimport {http} from './http';\n\nexport function asyncChangePassword (data: {oldPassword: String; newPassword: string}): any {\n  return http({\n    url: '/Operator/changePassword',\n    method: 'post',\n    data\n  });\n}\n\nexport function asyncFetchUpyunIno (): Promise<any> {\n  return http({\n    url: 'Operator/upyunInfo',\n    method: 'post'\n  });\n}\n\nexport function asyncUpdateAvatar (data: {avatar: string}): Promise<any> {\n  return http({\n    url: '/Operator/avatar',\n    method: 'put',\n    data\n  });\n}\n","import {http} from './http';\n\nexport function fetchMetadata (entityName) {\n  return http({\n    url: `/metadata/${ entityName }`,\n    method: 'get'\n  });\n}\n\nexport function createMetadata (data) {\n  return http({\n    url: '/metadata',\n    method: 'post',\n    data\n  });\n}\n\nexport function updateMetadata (data) {\n  return http({\n    url: '/metadata',\n    method: 'put',\n    data\n  });\n}\n\nexport function fetchMetadatas () {\n  return http({\n    url: '/metadata/listByVersion',\n    method: 'get'\n  });\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"biz-form_section\":\"style_biz-form_section__1Z2_H\",\"section_title\":\"style_section_title__2FkIL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"biz-list-header\":\"style_biz-list-header__1cN8T\",\"biz-list-header-title\":\"style_biz-list-header-title__3bDxq\"};","/*\n * File: metadata copy.js\n * Project: biz-form\n * File Created: Thursday, 22nd July 2021 10:41:34 pm\n * Author: zxtang (1061225829@qq.com)\n * -----\n * Last Modified: Thursday, 22nd July 2021 10:41:34 pm\n * Modified By: zxtang (1061225829@qq.com>)\n * -----\n * Copyright 2017 - 2021 Your Company, Your Company\n */\nimport {http} from './http';\n\nexport function fetchQueryColumn (entityName: string): any {\n  return http({\n    url: `/queryColumn/${ entityName }`,\n    method: 'get'\n  });\n}\n\nexport function createQueryColumn (data: any) {\n  return http({\n    url: '/queryColumn',\n    method: 'post',\n    data\n  });\n}\n\nexport function updateQueryColumn (data: any) {\n  return http({\n    url: '/queryColumn',\n    method: 'put',\n    data\n  });\n}\n\nexport function fetchQueryColumns () {\n  return http({\n    url: '/queryColumn/listByVersion',\n    method: 'get'\n  });\n}\n","import {http} from './http';\n\nexport function fetchQuerySchema (entityName: string): any {\n  return http({\n    url: `/querySchema/${ entityName }`,\n    method: 'get'\n  });\n}\n\nexport function createQuerySchema (data: any) {\n  return http({\n    url: '/querySchema',\n    method: 'post',\n    data\n  });\n}\n\nexport function updateQuerySchema (data: any) {\n  return http({\n    url: '/querySchema',\n    method: 'put',\n    data\n  });\n}\n\nexport function removeQuerySchema (data: any) {\n  return http({\n    url: '/querySchema',\n    method: 'delete',\n    data\n  });\n}\n\nexport function fetchQuerySchemaList (params = {}) {\n  return http({\n    url: '/querySchema/list',\n    method: 'get',\n    params\n  });\n}\n","import { FormMode } from \"../formMode\";\n\nexport type ILisenter = (...params:any) => void | Promise<any>;\n\nexport interface ModuleInterface {\n    \n    listeners:  Array<ILisenter>;\n\n    destructor(): void; // 析构函数\n}\n\nexport enum ModuleNames {\n    Presenter = \"Presenter\",\n    EventModule = \"EventModule\",\n    InitModule = \"InitModule\",\n    FormModule = \"FormModule\",\n    ListInitiModule = \"ListInitiModule\",\n    QuerySolutionModule = \"QuerySolutionModule\",\n    ListModule = \"ListModule\",\n}\n\nexport enum FormAction {\n    Save = \"Save\",\n    Submit = \"Submit\",\n}\n\nexport interface FormSaveParams {\n    mode: string,\n    action: FormAction;\n    data: any;\n    entityName: string;\n}","/**\n *每个表单都应该有独立的生命周期，所以表单需的事件需要隔离。即需要独立的事件管理没模块\n * 计划使用模块的方式，结合事件订阅的处理。\n */\n\nexport enum LifecycleEvent {\n  // presenter创建完毕\n  afterPresenterCreated = 'afterPresenterCreated',\n  // module初始化完成\n  onModuleReady = 'onModuleReady',\n  // 初始化数据加载完成(metadata、template、formData)\n  onLoadedInitData = 'onInitData',\n  // 表单初始化完成\n  onFormInitialized = 'onFormInitialized',\n  // form渲染w完成\n  onFormCreated = 'onFormCreated',\n  // 保存数据前，\n  onBeforeSave = 'onBeforeSave',\n  // 保存数据\n  onSave = 'onSave',\n  // 数据保存完成\n  afterSave = 'afterSave',\n\n  // 列表queryColumn、querySchema数据加载完毕\n  onLoadedListInitData = 'onLoadedListInitData',\n  // 列表数据加载完成\n  onLoadedListData = 'onLoadedListData',\n  // 列表初始化完成\n  onListInitialized = 'onListInitialized',\n  // 加载列表的过滤条件数据\n  loadQuerySchemaData = 'loadQuerySchemaData',\n  // 列表的过滤条件数据 加载完毕\n  onQuerySchemaDataLoaded = 'onQuerySchemaDataLoaded',\n  // 查询列表数据\n  queryListData = 'queryListData',\n  // 重置列表的查询方案的值\n  resetQueryListSolutionValues = 'resetQueryListSolutionValues',\n\n  // 重新加载页面\n  reloadBizForm = 'reloadBizForm',\n}\n","\nexport enum FormMode {\n    Create = \"Create\",\n    View = \"View\",\n    Edit = \"Edit\",\n    Copy = \"Copy\",\n}","/**\n * Section主要用于分区，用户可以选择将不同的字段放在不同的区块中\n */\nimport { BizFormPresenter } from '@src/bizForm/bizFormPresenter';\nimport { FormMode } from '@src/bizForm/formMode';\nimport { TemplateSection } from '@src/pages/devtool/bizForm/form/template';\nimport { Input, Row } from 'antd';\nimport * as React from 'react';\nimport cx from 'classnames';\nimport './style.scss';\n\ninterface ISection {\n    className?: string;\n    content: React.ReactNode;\n    leftElement: React.ReactNode;\n    rightElement?: React.ReactNode;\n}\n\nexport default class BizSection extends React.Component<ISection> {\n\n    render() {\n        const { className, leftElement, rightElement, content } = this.props;\n        return <div className={cx('biz-section', className)}>\n            <div className={cx('biz-section-header')}>\n                <div className={cx('biz-section-header-left')}>\n                    {leftElement}\n                </div>\n                <div className={cx('biz-section-header-right')}>\n                    {rightElement}\n                </div>\n            </div>\n            <div className={cx('biz-section-body')}>\n                {\n                    content\n                }\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport {Controlled as CodeMirror} from 'react-codemirror2';\nimport 'codemirror/lib/codemirror.css';\nimport './style.scss';\n\ninterface IMarkdownEditor {\n  value: string;\n  onChange: (val: string) => void;\n}\n\nconst options = {\n  mode: 'xml',\n  theme: 'material',\n  lineNumbers: true\n};\n\nexport const MarkdownEditor = (props: IMarkdownEditor) => {\n  return (\n    <div className=\"markdown-editor\">\n      {/* @ts-ignore */}\n      <CodeMirror\n        value={props.value}\n        options={options}\n        onBeforeChange={(editor, data, value: string) => {\n          // eslint-disable-next-line no-unused-expressions\n          props.onChange && props.onChange(value);\n        }}\n      />\n    </div>\n  );\n};\n","import {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {Observer} from 'mobx-react';\nimport * as React from 'react';\nimport {BizFormField} from '@src/bizForm/core/model/bizFormField';\nimport {MSTFormField} from '@src/MST-Form/MSTFormField';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport Refer from '../Refer';\n\ninterface IReferSelect {\n  entityName: string; // 业务对象名称\n  value: any; // 传入的值\n  presenter: BizFormPresenter;\n  onChange: (value: any) => void; // 选择数据时触发\n  model: BizFormField;\n  field: MSTFormField;\n  disabled?: boolean;\n  isMutil?: boolean; //多选\n  id?: string;\n}\n\n/**\n * 根據entityName自動查詢对应的数据\n * 系统里可以作为refer的数据都应该有id、title字段。ReferSelect组件读取对应的属性即可\n * refer只显示entity本身的字段，子表的字段不会显示\n * ReferSelect应作为受控组件使用\n * @param props\n * @returns\n */\nfunction ReferSelect (props: IReferSelect) {\n  const {presenter, model, field, value} = props;\n  const entityName = model.referType;\n  const logicPath = field.path;\n  const getName = React.useCallback((path: string) => {\n    const prefixEntityLen = logicPath.split('.').length;\n    return path.split('.').slice(prefixEntityLen).join('');\n  }, []);\n  const queryFields = presenter\n    .getFields(logicPath)\n    .map((field) => getName(field.path))\n    .filter((fileName) => !!fileName);\n\n  const onChange = (value: any) => {\n    props?.onChange(value);\n  };\n  return (\n    <Observer>\n      {() => (\n        <Refer\n          id={props.id}\n          entityName={entityName}\n          queryFields={queryFields}\n          value={props.value}\n          onChange={onChange}\n          disabled={props.disabled}\n        />\n      )}\n    </Observer>\n  );\n}\n\nexport default ReferSelect;\n","import React, { createRef } from 'react';\n\nimport {Tag, Input, Tooltip} from 'antd';\nimport {PlusOutlined} from '@ant-design/icons';\nimport {TagsEditorProps, TagsEditorState} from './types';\nimport \"./style.scss\";\n\nexport default class TagsEditor extends React.Component<TagsEditorProps, TagsEditorState> {\n  state = {\n    inputVisible: false,\n    inputValue: '',\n    editInputIndex: -1,\n    editInputValue: ''\n  };\n\n  inputRef = createRef<any>();\n  editInputRef  = createRef<any>();\n\n  getTags = (): Array<string> => {\n    return this.props.value || [];\n  };\n\n  handleClose = (removedTag: string) => {\n    const tags = this.getTags().filter((tag) => tag !== removedTag);\n    this.props.onChange && this.props.onChange(tags);\n  };\n\n  showInput = () => {\n    this.setState({inputVisible: true}, () => this.inputRef.current.focus());\n  };\n\n  handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({inputValue: e.target.value});\n  };\n\n  handleInputConfirm = () => {\n    const {inputValue} = this.state;\n    let tags = this.getTags();\n    if (inputValue && tags.indexOf(inputValue) === -1) {\n      tags = [ ...tags, inputValue ];\n    }\n    this.props.onChange && this.props.onChange(tags);\n    this.setState({\n      inputVisible: false,\n      inputValue: ''\n    });\n  };\n\n  handleEditInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({editInputValue: e.target.value});\n  };\n\n  handleEditInputConfirm = () => {\n    const tags = this.getTags();\n    this.setState(({editInputIndex, editInputValue}): any => {\n      const newTags = [ ...tags ];\n      newTags[ editInputIndex ] = editInputValue;\n      this.props.onChange && this.props.onChange(tags);\n\n      return {\n        editInputIndex: -1,\n        editInputValue: ''\n      };\n    });\n  };\n\n  render () {\n    const tags = this.getTags();\n    const {inputVisible, inputValue, editInputIndex, editInputValue} = this.state;\n    return (\n      <>\n        {tags.map((tag, index) => {\n          if (editInputIndex === index) {\n            return (\n              <Input\n                ref={this.editInputRef as any}\n                key={tag}\n                size=\"small\"\n                className=\"tagsEditor-input\"\n                value={editInputValue}\n                onChange={this.handleEditInputChange}\n                onBlur={this.handleEditInputConfirm}\n                onPressEnter={this.handleEditInputConfirm}\n              />\n            );\n          }\n\n          const isLongTag = tag.length > 20;\n\n          const tagElem = (\n            <Tag className=\"tagsEditor-tag\" key={tag} closable={index !== 0} onClose={() => this.handleClose(tag)}>\n              <span\n                onDoubleClick={(e) => {\n                  if (index !== 0) {\n                    this.setState({editInputIndex: index, editInputValue: tag}, () => {\n                      this.editInputRef.current.focus();\n                    });\n                    e.preventDefault();\n                  }\n                }}\n              >\n                {isLongTag ? `${ tag.slice(0, 20) }...` : tag}\n              </span>\n            </Tag>\n          );\n          return isLongTag ? (\n            <Tooltip title={tag} key={tag}>\n              {tagElem}\n            </Tooltip>\n          ) : (\n            tagElem\n          );\n        })}\n        {inputVisible && (\n          <Input\n            ref={this.inputRef}\n            type=\"text\"\n            size=\"small\"\n            className=\"tagsEditor-input\"\n            value={inputValue}\n            onChange={this.handleInputChange}\n            onBlur={this.handleInputConfirm}\n            onPressEnter={this.handleInputConfirm}\n          />\n        )}\n        {!inputVisible && (\n          <Tag className=\"tagsEditor-plus\" onClick={this.showInput}>\n            <PlusOutlined /> 添加\n          </Tag>\n        )}\n      </>\n    );\n  }\n}\n","import {MSTFormField} from '@src/MST-Form/MSTFormField';\nimport * as React from 'react';\nimport {BizFormPresenter} from '../bizFormPresenter';\nimport {BizForm} from '../core/model/bizForm';\nimport {BizFormField} from '../core/model/bizFormField';\nimport {FormMode} from '../formMode';\nimport {BizFormItemProps} from '../interfaces';\nimport {Carry} from './Carry';\nimport {Checkbox} from './Checkbox';\nimport {Count} from './Count';\nimport {DatePicker} from './DatePicker';\nimport {DatetimePicker} from './DatetimePicker';\nimport EnumSelect from './EnumSelect';\nimport {Input} from './Input';\nimport {MarkdownEditor} from './MarkdownEditor';\nimport {Numeric} from './Numeric';\nimport ReferSelect from './ReferSelect';\nimport TagsEditor from './TagsEditor';\nimport {Textarea} from './Textarea';\nimport {TimePicker} from './TimePicker';\nimport { MyUpload } from './Upload';\n\nexport interface matchComponentProps {\n  model: BizFormField;\n  field: MSTFormField;\n  mode: FormMode;\n  presenter?: BizFormPresenter;\n}\n\nexport const componentMapping: any = {\n  Text: Input,\n  ReferSelect: ReferSelect,\n  Date: DatePicker,\n  Time: TimePicker,\n  Datetime: DatetimePicker,\n  Checkbox: Checkbox,\n  Textarea: Textarea,\n  Numeric: Numeric,\n  Count: Count,\n  Carry: Carry,\n  Markdown: MarkdownEditor,\n  EnumSelect: EnumSelect,\n  TagsEditor: TagsEditor,\n  Image: MyUpload,\n};\n\n// 处理组件的props\nfunction proccessProps (itemProps: matchComponentProps) {\n  const {field, mode, model, presenter} = itemProps;\n  const props: any = {\n    // ...field,\n    disabled: field ? field.disabled : model.disabled,\n    // value: field.value,\n    mode, // 组件的模式\n    presenter,\n    model,\n    field\n  };\n\n  if (model.bizType === 'enum') {\n    props.enumName = model.entityField?.enumType\n  }\n\n  return props;\n}\n\nexport function matchComponent (itemProps: matchComponentProps) {\n  const {\n    model: {component, isRefer, isCarry}\n  } = itemProps;\n  let Comp = componentMapping[ component ];\n  if (isCarry) {\n    Comp = componentMapping[ 'Carry' ];\n  } else if (isRefer) {\n    Comp = componentMapping[ 'ReferSelect' ];\n  }\n  if (!Comp) {\n    Comp = componentMapping[ 'Text' ];\n  }\n  const props = proccessProps(itemProps);\n  return <Comp {...props} />;\n}\n","import {TimePicker as AntTimePicker} from 'antd';\nimport moment from 'moment';\nimport {useCallback} from 'react';\nimport {IBizFormComponentOProps} from '../interface';\n\nexport const TimePicker = (props: IBizFormComponentOProps) => {\n  const onChange = useCallback((_, timeString: string) => {\n    props.onChange && props.onChange(timeString);\n  }, []);\n\n  return (\n    <AntTimePicker\n      value={moment(props.value)}\n      onChange={onChange}\n      disabled={props.disabled}\n    />\n  );\n};\n","import React from 'react';\nimport {Checkbox as AntCheckbox} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\n\nexport interface ICheckbox extends IBizFormComponentOProps {}\n\nexport const Checkbox = (props: ICheckbox) => {\n  const handleChange = (e: any) => {\n    props?.onChange(e.target.checked);\n  };\n  return <AntCheckbox {...props} checked={props.value} onChange={handleChange} />;\n};\n","import {Input} from 'antd';\nimport * as React from 'react';\nimport {IBizFormComponentOProps} from '../interface';\n\ninterface IIextarea extends IBizFormComponentOProps {}\n\nexport const Textarea = (props: IIextarea) => {\n  const {value = ''} = props;\n  const handleBlur = (): void => {\n    props?.onChange(value?.trim());\n  };\n  return <Input.TextArea rows={3} {...props} onBlur={handleBlur} />;\n};\n","import * as React from 'react';\nimport {Input as AntdInput, InputProps} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\nimport _get from 'lodash/get';\nimport {metadata} from '@src/metadata/metadata';\nimport moment from 'moment';\n\ninterface ICarry extends IBizFormComponentOProps {}\nconst getEntityField = (entityName: string, path: string) => {\n  const entityField = metadata.getEntity(entityName).getFieldLastNode(path);\n  if (!entityField) {\n    console.error('path is not exist in entity:' + entityName);\n    return null;\n  }\n  return entityField;\n};\n\n// 携带字段\nexport function Carry (props: ICarry) {\n  let value = props.value;\n  if (props.value && typeof props.value === 'object') {\n    value = _get(value, 'name');\n  }\n\n  const entityField = getEntityField(props.model.entityName, props.model.path);\n  if (value && entityField) {\n    switch (entityField.bizType) {\n      case 'datetime':\n        value = moment(value).format('YYYY-MM-DD HH:mm:ss');\n        break;\n      case 'date':\n        value = moment(value).format('YYYY-MM-DD');\n        break;\n    }\n  }\n\n  return <AntdInput {...props} value={value} disabled />;\n}\n","import {SimpleUpload} from \"@src/components/Upload\";\nimport React from \"react\";\nimport {IBizFormComponentOProps} from \"../interface\";\n\ninterface IMyUpload extends IBizFormComponentOProps {}\n\nexport const MyUpload = (props: IMyUpload) => {\n  return <SimpleUpload {...props} />;\n};\n","import { IEntity, IEntityField } from \"@src/interfaces/entity\";\nimport { IQueryColumn, IQueryColumnItem, IQueryColumnKey } from \"@src/interfaces/queryColumn\";\nimport { TreeNodeProps } from \"antd\";\nimport { makeAutoObservable, toJS } from \"mobx\";\n\nconst _ = {\n  set: require(\"lodash/set\"),\n};\n\nexport class QueryColumn {\n  public id: string = \"\";\n\n  public title: string;\n\n  public items: IQueryColumnItem[] = [];\n\n  public getItem(path: string): IQueryColumnItem {\n    return this.items.find(item => item.path === path);\n  }\n\n  public getItems() {\n    return this.items || [];\n  }\n\n  public setItems(data: IQueryColumnItem[]) {\n    this.items = data;\n  }\n\n  constructor(public entityName: string) {\n    makeAutoObservable(this);\n  }\n\n  public pathExist(path: string) {\n    return this.items.some((item) => item.path === path);\n  }\n\n  //  通过AsyncTree添加新的item数据\n  public addItemFormQueryColumn(data: TreeNodeProps) {\n    const item: IQueryColumnItem = {\n      path: data.key as string,\n      displayName: [...data.ancestors.map((ancestor: IEntity) => ancestor.title), data.title].join('/'),\n      isContextField: false,\n      isDisabledSummary: false,\n      isDisabledExport: false,\n      visiable: true, // 默认显示\n    };\n    // 系统参数只能允许后台设置数据，前端不允许编辑\n    if (data.fieldData.isSystemField) {\n      // item.required = false;\n    }\n    this.items.push(item);\n  }\n\n  // 更新item的数据\n  public updateQueryColumnItem(\n    path: string,\n    key: string,\n    value: string | number | boolean\n  ) {\n    const index = this.items.findIndex((item) => item.path === path);\n    if (index > -1) {\n      this.items[index] = {\n        ...this.items[index],\n        [key]: value,\n      };\n    }\n  }\n\n  // 删除item\n  public removeQueryColumnItem(path: string) {\n    this.items = this.items.filter((item) => item.path !== path);\n  }\n\n  public toJSON() {\n    return {\n      id: this.id,\n      title: this.title,\n      entityName: this.entityName,\n      items: this.getItems(),\n    }\n  }\n}\n\nexport class QueryColumnUtils {\n  static create(data: IQueryColumn) {\n    const queryColumn = new QueryColumn(data.entityName);\n\n    for (let key of Reflect.ownKeys(toJS(data))) {\n      _.set(queryColumn, key, data[key as IQueryColumnKey]);\n    }\n    if (!queryColumn.items) {\n      queryColumn.items = [];\n    }\n\n    return queryColumn;\n  }\n\n  static createObservableQueryColumn(entityName: string): QueryColumn {\n    return makeAutoObservable(QueryColumnUtils.createQueryColumn(entityName));\n  }\n\n  static createQueryColumn(entityName: string): QueryColumn {\n    return new QueryColumn(entityName);\n  }\n\n  static wrapperQueryColumn(data: IQueryColumn) {\n    return makeAutoObservable(QueryColumnUtils.create(data));\n  }\n}\n","import { IEntity } from \"@src/interfaces/entity\";\nimport { IQuerySchema, IQuerySchemaItem, IQuerySchemaKey } from \"@src/interfaces/queryScheme\";\nimport { TreeNodeProps } from \"antd\";\nimport { makeAutoObservable, toJS } from \"mobx\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nconst _ = {\n  set: require(\"lodash/set\"),\n};\n\nexport class QuerySchema {\n  public id?: string;\n  public title: string;\n  public items: Array<IQuerySchemaItem> = [];\n\n  public paths() {\n    return this.items.map(item => item.path);\n  }\n\n  constructor(public entityName: string) {\n    makeAutoObservable(this);\n  }\n\n  public getField(path: string): IQuerySchemaItem {\n    return this.items.find((col) => col.path === path);\n  }\n\n  public getItems() {\n    return this.items || [];\n  }\n\n  public setItems(data: IQuerySchemaItem[]) {\n    this.items = data || [];\n  }\n\n\n  public pathExist(path: string) {\n    return this.items.some((col) => col.path === path);\n  }\n\n  //  通过AsyncTree添加新的item数据\n  public addItemFormQuerySchame(item: IQuerySchemaItem) {\n    const newItem: IQuerySchemaItem = {\n      ...item,\n    };\n    this.items.push(newItem);\n  }\n\n  //  通过AsyncTree添加新的item数据\n  public addItemFormQuerySchema(data: TreeNodeProps) {\n    const item: IQuerySchemaItem = {\n      path: data.key as string,\n      displayName: [...data.ancestors.map((ancestor: IEntity) => ancestor.title), data.title].join('/'),\n      isContextField: false,\n      isDisabledSummary: false,\n      isDisabledExport: false,\n      valueType: '',\n      isQuickQuery: false,\n    };\n    // 系统参数只能允许后台设置数据，前端不允许编辑\n    if (data.fieldData.isSystemField) {\n      // item.required = false;\n    }\n    this.items.push(item);\n  }\n\n  // 更新item的数据\n  public updateQuerySchemaItem(\n    path: string,\n    key: string,\n    value: string | number | boolean\n  ) {\n    const index = this.items.findIndex((item) => item.path === path);\n    if (index > -1) {\n      this.items[index] = {\n        ...this.items[index],\n        [key]: value,\n      };\n    }\n  }\n\n  // 删除item\n  public removeQuerySchemaItem(path: string) {\n    if (this.items.some((item) => item.path === path)) {\n      this.items = this.items.filter((item) => item.path !== path);\n    }\n  }\n\n  public updateItems = (items: IQuerySchemaItem[]) => {\n    this.items = items || [];\n  };\n\n\n  public toJSON() {\n    return {\n      id: this.id,\n      title: this.title,\n      entityName: this.entityName,\n      items: this.getItems(),\n    }\n  }\n}\n\nexport class QuerySchemaUtils {\n\n  static create(data: IQuerySchema) {\n    const querySchema = new QuerySchema(data.entityName);\n    for (let key of Reflect.ownKeys(toJS(data))) {\n      _.set(querySchema, key, data[key as IQuerySchemaKey]);\n    }\n    if (!querySchema.items) {\n      querySchema.items = [];\n    }\n    return querySchema;\n  }\n\n  static createObservableQuerySchema(entityName: string): QuerySchema {\n    return new QuerySchema(entityName);\n  }\n\n  static wrapperQuerySchema(data: IQuerySchema) {\n    return makeAutoObservable(QuerySchemaUtils.create(data));\n  }\n}\n","import {QUERY_SOLUTION_PREFIX} from '@src/bizForm/modules/listInitiModule';\nimport {QuerySolution} from '@src/bizList/core/querySolution';\nimport {QuerySolutionHelper} from '@src/bizList/core/querySolutionHelper';\nimport {IQueryColumn} from '@src/interfaces/queryColumn';\nimport {IQuerySchema, IQuerySchemaItem} from '@src/interfaces/queryScheme';\nimport localforage from 'localforage';\nimport { makeAutoObservable, observable } from 'mobx';\nimport { LoadingStatus } from '../LoadingContainer';\nimport {QueryColumn, QueryColumnUtils} from './ListSolution/queryColumn';\nimport {QuerySchema, QuerySchemaUtils} from './ListSolution/querySchema';\n\nexport interface IListSolutionOptions {\n  entityName: string;\n  queryColumn: IQueryColumn;\n  querySchema: IQuerySchema;\n}\n\nexport class ListSolutionPresenter {\n  public entityName: string;\n\n  public queryColumn: QueryColumn;\n\n  public querySchema: QuerySchema;\n\n  public querySolution: QuerySolution;\n\n  public querySchemaItems: Array<IQuerySchemaItem> = [];\n\n  public loadingStatus = LoadingStatus.Loading;\n\n  constructor(private options: IListSolutionOptions) {\n    makeAutoObservable(this);\n    this.init();\n  }\n\n  private async init() {\n    const {values = {}, valueTypes} =\n      (await localforage.getItem(`${this.options.querySchema.id}${QUERY_SOLUTION_PREFIX}options`)) || {};\n\n    this.entityName = this.options.entityName;\n    this.querySchemaItems = this.options.querySchema.items;\n    this.queryColumn = QueryColumnUtils.create(this.options.queryColumn);\n    this.querySchema = QuerySchemaUtils.create(this.options.querySchema);\n    this.querySolution = QuerySolutionHelper.createQuerySchema({\n      querySchema: this.options.querySchema,\n      options: {\n        values,\n        valueTypes,\n      },\n    });\n    this.loadingStatus = LoadingStatus.Complete;\n  }\n\n  public toJSON() {\n    return {\n      entityName: this.entityName,\n      queryColumn: this.queryColumn,\n      querySchema: this.querySchema,\n      querySolution: this.querySolution\n    };\n  }\n}\n","import localforage from 'localforage';\nimport {BIZ_AUTH} from '@src/common/constants/token';\nimport {Auth} from '@src/interfaces/auth';\n\nlet authInfo: Auth;\n\nasync function getAuthInfo () {\n  authInfo = await localforage.getItem(BIZ_AUTH);\n}\n\ngetAuthInfo();\n\nexport const UPYUN_UPLOAD_URL = 'https://v0.api.upyun.com';\nexport const UPYUN_BUCKET = 'vwood-upyun';\n\ninterface UpyunConfigOptions {\n  name: string;\n  action: string;\n  headers?: {\n    authorization: string;\n  };\n  upyun: {\n    token: string;\n    policy: string;\n  };\n  url: string;\n}\nexport const getUpyunConfig = (): UpyunConfigOptions => {\n  return {\n    name: 'file',\n    action: `${ UPYUN_UPLOAD_URL }/${ UPYUN_BUCKET }`,\n    upyun: authInfo?.upyun,\n    url: '//file.vwood.xyz'\n    // headers: {\n    //   authorization: authInfo?.upyun?.token,\n    // },\n  };\n};\n","import {LoadingOutlined, PlusOutlined} from \"@ant-design/icons\";\nimport {getUpyunConfig} from \"@src/common/upload\";\nimport {message, Upload} from \"antd\";\nimport React, {useMemo, useState} from \"react\";\nimport type {UploadChangeParam} from \"antd/es/upload\";\nimport type {RcFile, UploadFile, UploadProps} from \"antd/es/upload/interface\";\n\ninterface IMyUpload {\n  onChange?: (data?: any) => void;\n  value?: any;\n}\nconst getBase64 = (img: RcFile, callback: (url: string) => void) => {\n  const reader = new FileReader();\n  reader.addEventListener(\"load\", () => callback(reader.result as string));\n  reader.readAsDataURL(img);\n};\n\nconst beforeUpload = (file: RcFile) => {\n  // const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\n  // if (!isJpgOrPng) {\n  //   message.error('You can only upload JPG/PNG file!');\n  // }\n  const isLt10M = file.size / 1024 / 1024 < 10;\n  if (!isLt10M) {\n    message.error(\"Image must smaller than 10MB!\");\n  }\n  // return isJpgOrPng && isLt10M;\n  return isLt10M;\n};\n\nexport const SimpleUpload = (props: IMyUpload) => {\n  const {value, onChange} = props;\n  const upyunOptions = useMemo(() => getUpyunConfig(), []);\n  const [loading, setLoading] = useState(false);\n\n  const handleChange: UploadProps[\"onChange\"] = (info: UploadChangeParam<UploadFile>) => {\n    if (info.file.status === \"uploading\") {\n      setLoading(true);\n      return;\n    }\n    if (info.file.status === \"done\") {\n      // Get this url from response in real world.\n      getBase64(info.file.originFileObj as RcFile, (url) => {\n        setLoading(false);\n        onChange && onChange(upyunOptions.url + info.file.response.url);\n      });\n    }\n\n    if (info.file.status === \"error\") {\n      setLoading(false);\n    }\n  };\n\n  const uploadButton = <div>{loading ? <LoadingOutlined /> : <PlusOutlined />}</div>;\n\n  return (\n    <Upload\n      name={upyunOptions.name}\n      method={\"POST\"}\n      listType=\"picture-card\"\n      className=\"avatar-uploader\"\n      showUploadList={false}\n      action={upyunOptions.action}\n      beforeUpload={beforeUpload}\n      onChange={handleChange}\n      headers={upyunOptions.headers}\n      data={{\n        authorization: upyunOptions.upyun?.token,\n        policy: upyunOptions.upyun?.policy,\n      }}\n      // customRequest={customRequest}\n    >\n      {value ? <img src={value} alt=\"avatar\" style={{width: \"100%\"}} /> : uploadButton}\n    </Upload>\n  );\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-container\":\"style_loading-container__1oiWW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"datetime-picker\":\"style_datetime-picker__KGyjO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item-wrapper\":\"style_item-wrapper__2tnLK\"};","import {Button, Spin} from 'antd';\nimport * as React from 'react';\nimport style from './style.module.scss';\n\nexport enum LoadingStatus {\n  Complete = 'Complete',\n  Failed = 'Failed',\n  Loading = 'Loading',\n  None = 'None',\n}\n\ninterface ILoadingContainer {\n  // loading: boolean;\n  children: () => JSX.Element;\n  status: LoadingStatus;\n}\n\nexport default function LoadingContainer(props: ILoadingContainer) {\n  const {status, children} = props;\n  switch (status) {\n    case LoadingStatus.Complete:\n      return children && React.Children.only(children());\n    case LoadingStatus.Loading:\n      return <Spin className={style['loading-container']}></Spin>;\n    case LoadingStatus.Failed:\n      return (\n        <div>\n          <span>系统发生错误</span>&nbsp;&nbsp;\n          <Button size=\"small\" type=\"primary\" onClick={() => window.location.reload()}>\n            请重试\n          </Button>\n        </div>\n      );\n    default:\n      return null;\n  }\n}\n","import {notification} from 'antd';\nconst errorMap = {\n  400: {\n    NOSESSIONTOKEN: function () {\n      notification.warn({\n        message: '请登录后重试'\n      });\n    }\n  }\n};\n\nexport default function handleError (response) {\n  if (response) {\n    const {\n      status,\n      data: {errors = []}\n    } = response;\n    const error = errors[ 0 ];\n    if (error) {\n      const {code, detail} = error;\n      if (errorMap[ code ]) {\n        const keys = Object.keys(errorMap[ code ]);\n        const key = keys.find((key) => detail.indexOf(key) !== -1);\n        if (key) {\n          errorMap[ code ][ key ]();\n        }\n      }\n    }\n  }\n}\n","import {BIZ_AUTH} from '@src/common/constants/token';\nimport axios from 'axios';\nimport localforage from 'localforage';\nimport HandleError from './error';\n\nconst isDevelopment = process.env.NODE_ENV === 'development';\n// export const baseURL = process.env.NODE_ENV === 'development' ? 'http://localhost:10443/v1' : 'https://api.vwood.xyz/v1';\nexport const baseURL = 'https://api.vwood.xyz/v1';\n\nexport async function httpBase () {\n  const authInfo = await localforage.getItem(BIZ_AUTH);\n  return axios.create({\n    baseURL: isDevelopment ? '/api' : baseURL,\n    timeout: 60000,\n    headers: {\n      'content-type': 'application/json',\n      token: authInfo?.token\n    }\n  });\n}\n\nexport async function http (data) {\n  const instance = await httpBase();\n\n  instance.interceptors.response.use(\n    function (response) {\n      return response.data;\n    },\n    function (error) {\n      HandleError(error.response);\n      return Promise.reject(error);\n    },\n  );\n\n  return instance(data);\n}\n\nexport function localHttp (data) {\n  const instance = httpBase();\n\n  instance.interceptors.response.use(\n    function (response) {\n      return response.data;\n    },\n    function (error) {\n      return Promise.reject(error);\n    },\n  );\n\n  return instance(data);\n}\n\nexport const getCommentAccesskey = function () {\n  if (process.env.NODE_ENV === 'development') {\n    return 'e84e5603-3a1b-49ee-b4bb-97c18be9f8c0';\n  }\n  return '175d9560-abc3-4dac-8806-499e2853ccd9';\n};\n\nexport const originUrl = process.env.NODE_ENV !== 'production' ? 'http://localhost:3000' : 'https://vwood.xyz';\n\nexport const urlExcludeProtocal = () => {\n  const {search, host, pathname} = window.location;\n  const domain = host.replace(/www\\./, '');\n  return search ? `${ domain }${ pathname }?${ search }` : domain + pathname;\n};\n","import {BackendDescription, BackendDescriptionField} from './interface';\nimport {metadata, Metadata} from './metadata';\nimport _get from 'lodash/get';\nimport _clone from 'lodash/cloneDeep';\nimport _, {result} from 'lodash';\nimport {StringUtils} from '@src/utils/stringUtils';\nimport {IMetadata, IMetadataItem} from '@src/interfaces/metadata';\nexport interface IEntityField {\n  // name: string;\n  // title: string;\n  // bizType: string;\n  // isPriamry: boolean;\n  // isRequired: boolean;\n  // isReadonly: boolean;\n  // referType?: string;\n  // sourceType?: string;\n  // isSystem: boolean;\n  // isRefer?: boolean;\n}\n\nexport class EntityField {\n  constructor (\n    private backendDescription: BackendDescriptionField, // private metadata: IMetadataItem\n  ) {}\n\n  get name () {\n    return this.backendDescription.name;\n  }\n\n  // 别名\n  get aliasName () {\n    if (this.isRefer) {\n      return _get(this.backendDescription.referInfo, 'aliasName', this.name);\n    }\n    return this.name;\n  }\n\n  get title () {\n    return this.backendDescription.title;\n  }\n\n  get bizType () {\n    // if (this.isRefer) {\n    //     return 'refer';\n    // }\n\n    return this.backendDescription.bizType;\n  }\n\n  get referType () {\n    if (this.isRefer) {\n      return _get(this.backendDescription.referInfo, 'referEntityName', null);\n    }\n\n    return null;\n  }\n\n  get enumType () {\n    if (this.bizType === 'enum') {\n      return _get(this.backendDescription.referInfo, 'referEntityName', null);\n    }\n    return null;\n  }\n\n  get isRefer () {\n    return this.bizType === 'refer';\n  }\n  get isEnum () {\n    return this.bizType === 'enum';\n  }\n\n  get isPriamry () {\n    return this.backendDescription.isPriamry;\n  }\n\n  get isSystemField () {\n    return this.backendDescription.isSystemField;\n  }\n\n  get type () {\n    return this.backendDescription.type;\n  }\n\n  get isDetail () {\n    return _get(this.backendDescription, 'isDetail', false);\n  }\n\n  get associationField () {\n    return this.backendDescription.associationField;\n  }\n\n  get isChildren () {\n    return _get(this.backendDescription.referInfo, 'isChildren', false);\n  }\n\n  get backendDescriptionInfo () {\n    return _clone(this.backendDescription);\n  }\n\n  get isMutil () {\n    return this.backendDescription.isMutil;\n  }\n}\n\nexport class Entity {\n  name: string;\n  title: string;\n  type: string;\n  // key/value信息\n  fields: {[key in string]: EntityField} = {};\n  aliasFields: {[key in string]: EntityField} = {};\n  metadata: IMetadata;\n\n  getField (fieldName: string) {\n    // 如果从fields上拿不到数据， 但从aliasFields上可以拿到的话，说明是外键字段\n    return this.fields[ fieldName ] || this.aliasFields[ fieldName ] || null;\n  }\n\n  // 获取属性最后一天节点对应的信息\n  getFieldLastNode (fieldName: string) {\n    const fieldnNameArr = fieldName.split('.');\n    const result = [];\n    let entity = this as Entity;\n    while (fieldnNameArr.length) {\n      const field = entity.getField(fieldnNameArr[ 0 ]);\n      if (field) {\n        if (field.isRefer) {\n          entity = metadata.getEntity(field.referType);\n        }\n        result.push(field);\n        fieldnNameArr.shift();\n      } else {\n        // 路径无效\n        return null;\n      }\n    }\n\n    return new EntityField({\n      ...result[ result.length - 1 ].backendDescriptionInfo,\n      title: result.reduce((prev, current) => (prev ? prev + '/' + current.title : current.title), '')\n    });\n  }\n}\n\nexport function entityFactory (backendDescription: BackendDescription) {\n  const entity = new Entity();\n  entity.name = backendDescription.name;\n  entity.title = backendDescription.title;\n  entity.type = backendDescription.type;\n\n  //1: 通过description描述文件构建网状的实体模型，只取description文件上有的属性\n  // 在显示数据时应该根据metadata来\n  backendDescription.fields.forEach((field) => {\n    const entityField = new EntityField(field);\n    entity.fields[ field.name ] = entityField;\n    entity.aliasFields[ entityField.aliasName ] = entityField;\n  });\n\n  return entity;\n}\n","import {BackendDescription, BackendDescriptionField} from './interface';\n\nexport class EnumValue {\n  public readonly title: string;\n  public readonly name: string;\n  public readonly value: string | number | boolean;\n\n  constructor (data: BackendDescriptionField) {\n    this.title = data.title;\n    this.value = data.value;\n    this.name = data.name;\n  }\n}\n\nexport class Enum {\n  public readonly title: string;\n  public readonly name: string;\n  public readonly description: string;\n  public readonly values: EnumValue[];\n\n  constructor (data: BackendDescription) {\n    this.title = data.title;\n    this.name = data.name;\n    this.description = data.description;\n    this.values = data.fields.map((field: BackendDescriptionField) => new EnumValue(field));\n  }\n\n  public getValue (enumValueName: string) {\n    return this.values.find((value) => value.name === enumValueName);\n  }\n\n  public getTitle(enumValue: string | number | boolean): string | undefined {\n    return this.values.find((value) => value.value === enumValue)?.title;\n  }\n\n  public fields (): EnumValue[] {\n    return this.values;\n  }\n}\n","import {BackendDescription, IReferConfig} from './interface';\nimport {StringUtils} from '@src/utils/stringUtils';\nimport {Entity, entityFactory} from './entity';\nimport {Enum} from './enum';\n\n/**\n * MetadataBase 主要处理元数据的查询和加载\n */\nclass MetadataBase {\n  entities: {[entityName: string]: Entity} = {};\n  refers: {[entityName: string]: {[referName: string]: IReferConfig}} = {}; // 每个entity下关联的外键\n  enums: {[entityName: string]: Enum} = {};\n\n  constructor () {\n    // this.init();\n  }\n\n  getList (): Array<Entity> {\n    return Object.values(this.entities);\n  }\n\n  getEntity (entityName: string): Entity {\n    return this.entities[ entityName ];\n  }\n\n  getEnum (enumName: string): Enum {\n    return this.enums[ enumName ];\n  }\n\n  getReferConfig (enttityName: string, referName: string) {\n    let refer;\n    try {\n      refer = this.refers[ enttityName ][ referName ];\n    } catch {\n      console.warn(`entity \"${ enttityName }\" does not has the \"${ referName }\" referConfig`);\n    }\n    return refer;\n  }\n\n  public init ({descriptions = [], metadatas = []}: any) {\n    descriptions.forEach((item: BackendDescription) => {\n      // const metadata = metadatas.find((metadata: IMetadata) => metadata.entityName === item.name);\n      // eslint-disable-next-line default-case\n      switch (item.type) {\n        case 'record':\n          this.initEntity(item);\n          break;\n        case 'enum':\n          this.initEnum(item);\n          break;\n      }\n    });\n  }\n\n  initEntity (entity: BackendDescription) {\n    this.entities[ entity.name ] = entityFactory(entity);\n    this.initReferInfo(entity.name, entity);\n  }\n\n  initReferInfo (entityName: string, entity: BackendDescription) {\n    if (!this.refers[ entityName ]) {\n      this.refers[ entityName ] = {};\n    }\n    /**\n     * 设置每个Entity关联的refer信息\n     */\n    entity.fields.forEach((field) => {\n      if (field.referInfo) {\n        // 使用外键在entity tepmlate上的属性值作为key，方便取值\n        this.refers[ entityName ][ StringUtils.lowerCapital(field.referInfo.referEntityName) ] = {\n          entityName: field.referInfo.referEntityName,\n          name: field.name\n        };\n      }\n    });\n  }\n\n  initEnum (entity: BackendDescription) {\n    this.enums[ entity.name ] = new Enum(entity);\n  }\n}\n\nexport const metadataBase = new MetadataBase();\n","/**\n * 元数据管理\n */\n\nimport {Entity} from './entity';\nimport {Enum} from './enum';\nimport {metadataBase} from './metadataBase';\n\nexport class Metadata {\n  constructor () {}\n\n  public init ({descriptions}: any) {\n    metadataBase.init({descriptions});\n  }\n\n  public getEntity (entityName: string) {\n    return metadataBase.getEntity(entityName);\n  }\n\n  public getRefer (entityName: string, referName: string) {\n    return metadataBase.getReferConfig(entityName, referName);\n  }\n\n  public getList (): Array<Entity> {\n    return metadataBase.getList();\n  }\n  public getEnum (enumName: string): Enum {\n    return metadataBase.getEnum(enumName);\n  }\n}\n\nconst metadataInstance = new Metadata();\n\nwindow.metadata = metadataInstance;\nexport const metadata = metadataInstance;\n","import {FormMode} from '@src/bizForm/formMode';\nimport {Modals} from '@src/components/Modals';\nimport {createBrowserHistory} from 'history';\n\n//全局使用的history\nexport const globalHistory = createBrowserHistory();\n\nconst unlisten = globalHistory.listen((data: any) => {\n  console.log(data);\n});\n\nexport interface IRouteFormOptions {\n  entityName: string;\n  mode: FormMode;\n  id?: string;\n}\n\nexport interface IRouteListOptions {\n  entityName: string;\n  force?: boolean;\n}\n\nexport class RouteUtils {\n  // 跳转到另一个表单的路由\n  static toForm (options: IRouteFormOptions) {\n    const {entityName, mode, id} = options;\n    const to = `/${ entityName }/${ mode }/${ id ? id : '' }`;\n    RouteUtils.to(to);\n  }\n\n  static to (url: string) {\n    Modals.clear();\n    globalHistory.push(url, {\n      _time: Date.now()\n    });\n  }\n\n  // 返回列表页\n  static toList (options: IRouteListOptions) {\n    const {entityName} = options;\n    const to = `/${ entityName }-list`;\n    RouteUtils.to(to);\n  }\n}\n","//https://www.yuque.com/u183495/kb/gmx2xc/edit\nexport enum ValueType {\n  eq = 'ValueType.eq',\n  ne = 'ValueType.ne',\n  gt = 'ValueType.gt',\n  lt = 'ValueType.lt',\n  ge = 'ValueType.ge',\n  le = 'ValueType.le',\n  between = 'ValueType.between',\n  like = 'ValueType.like',\n  in = 'ValueType.in', //多值，在指定选项内\n  nin = 'ValueType.nin', //多值，不在指定选项内\n}\n\nexport const singleValuetype = [\n  ValueType.eq,\n  ValueType.ne,\n  ValueType.gt,\n  ValueType.ge,\n  ValueType.lt,\n  ValueType.le,\n  ValueType.like\n];\n\nexport const mutilValueType = [ ValueType.between, ValueType.in, ValueType.nin ];\n\nexport const valueTypeMaps: {[key: string]: Array<ValueType>} = {\n  enum: [ ValueType.eq, ValueType.ne, ValueType.in, ValueType.nin ],\n  email: [ ValueType.eq, ValueType.ne, ValueType.like ],\n  text: [ ValueType.eq, ValueType.ne, ValueType.like ],\n  textarea: [ ValueType.eq, ValueType.ne, ValueType.like ],\n  markdown: [ ValueType.eq, ValueType.ne, ValueType.like ],\n  url: [ ValueType.eq, ValueType.ne, ValueType.like ], // url地址\n  count: [\n    // 整数\n    ValueType.eq,\n    ValueType.ne,\n    ValueType.gt,\n    ValueType.ge,\n    ValueType.lt,\n    ValueType.le,\n    ValueType.between\n  ],\n  numeric: [\n    // 浮点数\n    ValueType.eq,\n    ValueType.ne,\n    ValueType.gt,\n    ValueType.ge,\n    ValueType.lt,\n    ValueType.le,\n    ValueType.between\n  ],\n  refer: [ ValueType.eq, ValueType.ne, ValueType.in, ValueType.nin ], //  外键\n  bool: [ ValueType.eq, ValueType.ne ], // bool\n  datetime: [\n    // 时间\n    ValueType.eq,\n    ValueType.ne,\n    ValueType.gt,\n    ValueType.ge,\n    ValueType.lt,\n    ValueType.le,\n    ValueType.between,\n    ValueType.in,\n    ValueType.nin\n  ],\n  date: [\n    // 日期\n    ValueType.eq,\n    ValueType.ne,\n    ValueType.gt,\n    ValueType.ge,\n    ValueType.lt,\n    ValueType.le,\n    ValueType.between,\n    ValueType.in,\n    ValueType.nin\n  ]\n};\n\nexport interface IvalueTypeOption {\n  value: ValueType;\n  label: string;\n}\nexport const valueTypeOptions = [\n  {\n    value: ValueType.eq,\n    label: '等于'\n  },\n  {\n    value: ValueType.ne,\n    label: '不等于'\n  },\n  {\n    value: ValueType.gt,\n    label: '大于'\n  },\n  {\n    value: ValueType.lt,\n    label: '小于'\n  },\n  {\n    value: ValueType.ge,\n    label: '大于等于'\n  },\n  {\n    value: ValueType.le,\n    label: '小于等于'\n  },\n  {\n    value: ValueType.between,\n    label: '区间'\n  },\n  {\n    value: ValueType.like,\n    label: '包含'\n  },\n  {\n    value: ValueType.in,\n    label: '多值'\n  },\n  {\n    value: ValueType.nin,\n    label: '多值排除'\n  }\n];\n\nexport const getValueTypeOptions = (type: string): Array<IvalueTypeOption> => {\n  const types = valueTypeMaps[ type ];\n  if (!types) {\n    return [];\n  }\n\n  return types.map((type) => valueTypeOptions.find((option) => option.value === type));\n};\n","import {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {ClassBaseInterface} from '@src/common/classBase';\nimport {BizFormPresenter} from '../bizFormPresenter';\nimport {BaseModule} from './baseModule';\nimport {ModuleInterface} from './interface';\n\n/**\n * module管理\n *\n */\n\nexport interface IModuleManager {\n  seeds: {[key: string]: any};\n  modules: Array<typeof BaseModule>;\n  presenter: BizFormPresenter | BizListPresenter;\n}\nexport class ModuleManager {\n  private modules: Map<\n    string,\n    {\n      moduleName: string;\n      moduleClass: any;\n      moduleInstance: BaseModule | any; // @TODO: 暂时添加any， 在第二版时删除any\n    }\n  > = new Map();\n\n  constructor (private options: IModuleManager) {\n    this.initModules();\n    this.wireModules();\n    this.apply();\n  }\n\n  initModules () {\n    const {presenter, modules} = this.options;\n    modules.forEach((module: any) => {\n      const options = {\n        presenter: presenter\n      };\n      const moduleProperty = getModuleProperty(module);\n      this.modules.set(moduleProperty.moduleName, {\n        moduleName: moduleProperty.moduleName,\n        moduleClass: module,\n        moduleInstance: new module(options)\n      });\n    });\n  }\n\n  private wireModules () {\n    [ ...this.modules.keys() ].forEach((moduleName) => {\n      const {moduleClass, moduleInstance} = this.modules.get(moduleName as string);\n      const {attributes = []} = getModuleProperty(moduleClass);\n\n      attributes.forEach((attr: ModulePropertyAttribute) => {\n        moduleInstance[ attr.attributeName ] = this.lookupModuleProperty(attr.moduleName);\n      });\n    });\n  }\n\n  private lookupModuleProperty (lookupModuleName: string) {\n    if (this.options.seeds && this.options.seeds.hasOwnProperty(lookupModuleName)) {\n      //  如果传递下来的seeds中存在，直接返回\n      return this.options.seeds[ lookupModuleName ];\n    }\n    // 没有的就从moduleManager中存在的modules中寻找\n    // 需要注意尽量保证要获取的模块是存在的\n    if (this.modules.has(lookupModuleName)) {\n      return this.modules.get(lookupModuleName).moduleInstance;\n    }\n\n    console.error(`module ${ lookupModuleName } is not exist`);\n  }\n\n  // 执行模块\n  apply () {\n    [ ...this.modules.values() ].forEach((item) => {\n      item.moduleInstance.apply && item.moduleInstance.apply();\n    });\n  }\n\n  // 获取module实例\n  public get (moduleName: string) {\n    return this.modules.get(moduleName).moduleInstance as any;\n  }\n}\n\nexport const MODULE_PROPERTY_KEY = '$$MODULE_PROPERTY_KEY';\n\nexport type ModulePropertyAttribute = {\n  attributeName: string | symbol;\n  moduleName: string;\n};\n\n// 每个Module都需要挂载的属性\nexport interface ModuleProperties {\n  moduleName: string; // module的名称，唯一标识\n  lunch: string; // 触发函数\n  attributes: Array<ModulePropertyAttribute>;\n  // @TODO:\n}\n\n/**\n * 包装module，向其中注入模块的名称\n * @param moduleName\n */\nexport const ModuleWrapper = (moduleName: string) => (module: any) => {\n  getModuleProperty(module).moduleName = moduleName;\n};\n\nexport const getModuleProperty = (target: Function) => {\n  if (!target.prototype[ MODULE_PROPERTY_KEY ]) {\n    target.prototype[ MODULE_PROPERTY_KEY ] = {};\n  }\n  return target.prototype[ MODULE_PROPERTY_KEY ];\n};\n\nexport const ModulePropertyWrapper = (moduleName: string) => (target: any, propertyName: string) => {\n  const moduleProperties = getModuleProperty(target.constructor);\n  if (!moduleProperties.attributes) {\n    moduleProperties.attributes = [];\n  }\n\n  moduleProperties.attributes.push({\n    moduleName: moduleName, // 需要的模块的名称，\n    attributeName: propertyName // 当前module上对应的属性\n  });\n};\n","import {PieChartOutlined} from \"@ant-design/icons\";\nimport React from \"react\";\n\nexport interface INavConfig {\n  key: string;\n  path: string;\n  label: string;\n  icon: React.ReactNode;\n  children?: Array<INavConfig>;\n}\n\nexport const configList: Array<INavConfig> = [\n  // {\n  //   key: '/demo',\n  //   path: '/demo',\n  //   label: 'demo',\n  //   icon: <PieChartOutlined />\n  // },\n  {\n    key: \"/devtool/form\",\n    path: \"/devtool/form\",\n    label: \"开发工具\",\n    icon: <PieChartOutlined />,\n  },\n  {\n    key: \"/devtool/querySchema\",\n    path: \"/devtool/querySchema\",\n    label: \"列表方案\",\n    icon: <PieChartOutlined />,\n  },\n  // {\n  //   key: '/Product/Create',\n  //   path: '/Product/Create',\n  //   label: '新建产品',\n  //   icon: <PieChartOutlined/>,\n  // },\n  // {\n  //   key: '/Product-list',\n  //   path: '/Product-list',\n  //   label: '产品列表',\n  //   icon: <PieChartOutlined/>,\n  // },\n  {\n    key: \"/Article-list\",\n    path: \"/Article-list\",\n    label: \"文章列表\",\n    icon: <PieChartOutlined />,\n  },\n  {\n    key: \"/File-list\",\n    path: \"/File-list\",\n    label: \"文件列表\",\n    icon: <PieChartOutlined />,\n  },\n  {\n    key: \"/Email-list\",\n    path: \"/Email-list\",\n    label: \"邮件列表\",\n    icon: <PieChartOutlined />,\n  },\n  {\n    key: \"/Template-list\",\n    path: \"/Template-list\",\n    label: \"模版列表\",\n    icon: <PieChartOutlined />,\n  },\n  {\n    key: \"/Category-list\",\n    path: \"/Category-list\",\n    label: \"基础数据\",\n    icon: <PieChartOutlined />,\n    // children: [\n    //   {\n    //     key: \"/Article\",\n    //     path: \"/Article\",\n    //     label: \"文章分类\",\n    //     icon: <PieChartOutlined />,\n    //   },\n    // ],\n  },\n  {\n    key: \"/settings\",\n    path: \"/settings\",\n    label: \"设置\",\n    icon: <PieChartOutlined />,\n  },\n];\n\nexport const Nav_Default = \"/Article-list\";\n","// eslint-disable-next-line no-use-before-define\nimport React, {useCallback, useEffect, useState} from \"react\";\nimport {Layout, Menu} from \"antd\";\nimport {configList, Nav_Default} from \"./config\";\nimport styles from \"./style.module.scss\";\nimport {globalHistory, RouteUtils} from \"@src/router/routeUtils\";\nconst {Sider} = Layout;\nconst {SubMenu} = Menu;\n\nexport function Nav () {\n  const [selectedKey, setSelectedKey] = useState([]);\n\n  const historyLientener = useCallback(() => {\n    globalHistory.listen((data: any) => {\n      const selectedKeys = [data.pathname];\n      const pathArr = data.pathname.split(\"/\") || [];\n      if (pathArr.length > 2) {\n        selectedKeys.unshift(\"/\" + pathArr[1]);\n      }\n      setSelectedKey(selectedKeys);\n    });\n  }, []);\n\n  useEffect(() => {\n    if (location.pathname === \"/\") {\n      window.location.pathname = Nav_Default;\n    } else {\n      setSelectedKey([window.location.pathname]);\n    }\n    historyLientener();\n  }, []);\n\n  const onSelect = (options: any) => {\n    const {selectedKeys} = options;\n    setSelectedKey(selectedKeys);\n  };\n  const onClick = (props: any) => {\n    RouteUtils.to(props.keyPath.join(\"\"));\n  };\n  return (\n    <Sider className={styles[\"layout-sider\"]}>\n      <div className=\"logo\" />\n      <Menu selectedKeys={selectedKey} mode=\"vertical\" onClick={onClick}>\n        {configList.map((item) =>\n          item.children ? (\n            <SubMenu key={item.key} icon={item.icon} title={item.label}>\n              {item.children.map((subItem) => (\n                <Menu.Item key={subItem.key} icon={subItem.icon}>\n                  {/* <NavLink to={subItem.path}>{subItem.label}</NavLink> */}\n                  <span>{subItem.label}</span>\n                </Menu.Item>\n              ))}\n            </SubMenu>\n          ) : (\n            <Menu.Item key={item.key} icon={item.icon}>\n              {/* <NavLink to={item.path}>{item.label}</NavLink> */}\n              <span>{item.label}</span>\n            </Menu.Item>\n          ),\n        )}\n      </Menu>\n    </Sider>\n  );\n}\n","import * as React from 'react';\nimport {Route} from 'react-router-dom';\nconst Template = React.lazy(() => import('@src/pages/devtool/bizForm/form/index'));\nconst TemplateList = React.lazy(() => import('@src/pages/devtool/bizForm/list'));\nconst QuerySchema = React.lazy(() => import('@src/pages/devtool/querySchema/form/index'));\nconst QuerySchemaList = React.lazy(() => import('@src/pages/devtool/querySchema/list'));\nconst DemoComponent = React.lazy(() => import('@src/pages/demo'));\nconst Settings = React.lazy(() => import('@src/pages/settings'));\n\nconst BaseRoutes = [\n  <Route exact key=\"/demo\" path=\"/demo\" component={DemoComponent}></Route>,\n  <Route\n    exact\n    key=\"/devtool/querySchema/:entityName/:mode\"\n    path=\"/devtool/querySchema/:entityName/:mode\"\n    component={QuerySchema}\n  ></Route>,\n  <Route exact key=\"/devtool/querySchema\" path=\"/devtool/querySchema\" component={QuerySchemaList}></Route>,\n  <Route\n    exact\n    key=\"/devtool/form/:entityName/:mode\"\n    path=\"/devtool/form/:entityName/:mode\"\n    component={Template}\n  ></Route>,\n  <Route exact key=\"/devtool/form\" path=\"/devtool/form\" component={TemplateList}></Route>,\n  // settings\n  <Route path=\"/settings\" component={Settings}></Route>\n];\nexport default BaseRoutes;\n","import { types } from \"mobx-state-tree\";\n\nexport type ReferSnapshotType = {\n    id: string;\n    [key: string]: any;\n}\n\nexport type ReferType = ReferSnapshotType;\n\nexport const ReferPrimitive = types.custom<ReferSnapshotType, ReferType>({\n  // Friendly name\n  name: \"refer\",\n  // given a serialized value and environment, how to turn it into the target type\n  fromSnapshot(snapshot: ReferSnapshotType, env: any): ReferType {\n    return snapshot;\n  },\n  // return the serialization of the current value\n  toSnapshot(value: ReferType) {\n    return value;\n  },\n  // if true, this is a converted value, if false, it's a snapshot\n  isTargetType(value: ReferType | ReferSnapshotType) {\n    return true;\n  },\n  // a non empty string is assumed to be a validation error\n  getValidationMessage(snapshot: ReferSnapshotType): string {\n    if (typeof snapshot === \"object\" && snapshot.hasOwnProperty(\"id\")) {\n      return \"\";\n    }\n    return `${JSON.stringify(snapshot)} is not a valid refer object`;\n  },\n});\n","import { types as mstTypes } from 'mobx-state-tree';\nimport { ReferPrimitive } from './refer';\n\n\nexport const types: typeof mstTypes & {refer: typeof ReferPrimitive} = {\n    ...mstTypes,\n    refer: ReferPrimitive,\n}","import {IAnyStateTreeNode, joinJsonPath, resolvePath, tryResolve} from 'mobx-state-tree';\n\nconst toString = Object.prototype.toString;\n\nexport const getNode = (target: IAnyStateTreeNode) => {\n  return target.$treenode as any;\n};\n\nexport const getNodeByPath = (target: IAnyStateTreeNode, path: string) => {\n  if (!path) {\n    return getNode(target);\n  }\n  const pathArr = path.split('.');\n  let node = getNode(target);\n  for (let i = 0; i < pathArr.length; i++) {\n    if (toString.call(node) !== '[object Object]') {\n      return undefined;\n    }\n    if (typeof node.getChildNode === 'function') {\n      node = node.getChildNode(pathArr[ i ]);\n    } else {\n      return undefined;\n    }\n  }\n\n  return node;\n};\n\n// initState 对应key\nexport const $FORM_STATE_KEY = '$FORM_STATE_KEY';\n// MST path分隔符\nexport const MST_PATH_DIVIDER = '/';\n\nexport const $FORM_VALIDATE_KEY = '$FORM_VALIDATE_KEY';\n","import {IDisposer, MSTFieldWriteableProps, Optional} from './interface';\nimport {MSTForm} from './MSTForm';\nimport {v4 as uuidv4} from 'uuid';\nimport {IStateTreeNode} from 'mobx-state-tree';\nimport {$FORM_STATE_KEY} from './MSTForm-utils';\nimport {makeAutoObservable, observable, reaction, untracked} from 'mobx';\nimport lodashGet from 'lodash/get';\n// 参数可选项\nexport interface MSTFormFieldOptions {\n  initState: Optional<MSTFieldWriteableProps>;\n}\n\nexport interface MSTFormFieldParams {\n  path: string;\n  form: MSTForm;\n  node: IStateTreeNode;\n  options: MSTFormFieldOptions;\n  initSnapshot?: any;\n}\n\nexport class MSTFormField {\n  public readonly form: MSTForm;\n\n  public readonly id: string; // 使用uuid\n\n  public readonly path: string; // 对应的节点\n\n  public node: IStateTreeNode | any;\n\n  private readonly options: MSTFormFieldOptions;\n  private readonly initSnapshot: any;\n\n  private disposers: Array<IDisposer> = [];\n\n  constructor (params: MSTFormFieldParams) {\n    makeAutoObservable(this);\n    this.id = uuidv4();\n    this.path = params.path;\n    this.form = params.form;\n    this.options = params.options;\n    this.node = params.node;\n    this.initSnapshot = params.initSnapshot;\n    this.node[ $FORM_STATE_KEY ] = observable.map(new Map<string, boolean>());\n\n    this.initValidators();\n  }\n\n  // 析构函数\n  public destructor () {\n    this.disposers.forEach((disposer) => disposer()); // 销毁所有的监听器\n  }\n\n  initValidators = () => {\n    this.disposers.push(\n      // 添加校验触发器\n      reaction(\n        () => this.value,\n        (value) => {\n          this.validate();\n        },\n      ),\n    );\n  };\n\n  public getStateMap () {\n    if (!this.node[ $FORM_STATE_KEY ]) {\n      this.node[ $FORM_STATE_KEY ] = observable.map(new Map<string, boolean>());\n    }\n\n    return this.node[ $FORM_STATE_KEY ] || {};\n  }\n\n  public getState (propName: string, defaultValue?: boolean) {\n    const stateMap = untracked(() => this.getStateMap());\n    const key = `state-${ propName }`;\n    if (stateMap.has(key)) {\n      return stateMap.get(key);\n    } else {\n      if (this.options.initState) {\n        if (typeof lodashGet(this.options.initState, propName) === 'undefined') {\n          return defaultValue;\n        }\n        return lodashGet(this.options.initState, propName);\n      }\n    }\n  }\n\n  public setState (propName: string, value: boolean) {\n    const stateMap = this.getStateMap();\n    const key = `state-${ propName }`;\n    return stateMap.set(key, value);\n  }\n\n  public get label () {\n    return '';\n  }\n\n  public get required () {\n    return this.getState('required', false);\n  }\n\n  public set required (required: boolean) {\n    this.setState('required', required);\n  }\n\n  public get disabled () {\n    return this.getState('disabled', false);\n  }\n\n  public set disabled (disabled: boolean) {\n    this.setState('disabled', disabled);\n  }\n\n  public get value () {\n    return this.form.getValue(this.path);\n  }\n\n  public set value (val: any) {\n    this.form.setValue(this.path, val);\n  }\n\n  // value 改变的方法\n  public onChange (value: any) {\n    // this.value = value;\n  }\n\n  public get focused () {\n    return this.getState('focused', false);\n  }\n\n  public set focused (focused: boolean) {\n    this.setState('focused', focused);\n  }\n  // 判断值是否改变\n  public get changed () {\n    return this.initSnapshot !== this.value;\n  }\n\n  public validate () {\n    return this.form.valiator.validateField(this.path);\n  }\n\n  public get errors () {\n    return this.form.valiator.getMessageBypath(this.path);\n  }\n}\n","import {action, computed, makeAutoObservable, observable, ObservableMap, reaction} from 'mobx';\nimport {Interface} from 'readline';\nimport {MSTForm} from '../MSTForm';\nimport {IValidator} from './interface';\n\nexport interface IValidatorsOptions {\n  validateFirst?: boolean; // 遇到第一个失败的校验时是否停止校验\n  validators: {[path: string]: Array<IValidator>};\n}\n\nexport interface IValidators {\n  form: MSTForm;\n  options: IValidatorsOptions;\n}\n\nexport class Validators {\n  private form: MSTForm;\n  private options: IValidatorsOptions;\n\n  private validators: ObservableMap<string, Array<IValidator>> = observable.map(new Map(), {deep: false});\n\n  // key/value的形式创建性质结果的map\n  public errorMessages: ObservableMap<string, Array<string>> = observable.map(\n    new Map(),\n    // { deep: false }\n  );\n\n  public hasError: boolean;\n\n  constructor(params: IValidators) {\n    // makeAutoObservable(this);\n    this.form = params.form;\n    this.options = params.options;\n\n    const {validators = {}} = this.options;\n    (Reflect.ownKeys(validators) as Array<string>).forEach((path) => {\n      this.validators.set(path, validators[path] || []);\n    });\n  }\n\n  public addValidator(path: string, validator: IValidator) {\n    const validators = this.validators.get(path) || [];\n    validators.push(validator);\n    this.validators.set(path, validators);\n\n    return () => this.removeValidator(path, validator);\n  }\n\n  public removeValidator(path: string, validator: IValidator) {\n    let validators = this.validators.get(path) || [];\n    validators = validators.filter((item) => item !== validator);\n    this.validators.set(path, validators);\n  }\n\n  // 执行校验器，返回是否校验失败, 成功返回true\n  @action\n  public validate(): boolean {\n    this.errorMessages.clear();\n    this.hasError = false;\n\n    for (let path of this.validators.keys()) {\n      if (typeof path === 'string') {\n        const errors = this.validateByPath(path);\n        if (errors.length) {\n          this.errorMessages.set(path, errors);\n        } else {\n          this.errorMessages.delete(path);\n        }\n      }\n    }\n\n    this.hasError = !!this.errorMessages.size;\n    return !this.errorMessages.size;\n  }\n\n  // 执行校验器，返回是否校验失败\n  @action\n  public validateField(path: string): boolean {\n    const errors = this.validateByPath(path);\n    if (errors.length) {\n      this.errorMessages.set(path, errors);\n    } else {\n      this.errorMessages.delete(path);\n    }\n\n    return !this.errorMessages.size;\n  }\n\n  public validateByPath(path: string): Array<string> {\n    const validators = this.validators.get(path);\n    const field = this.form.select(path);\n    const messages = [];\n\n    for (let idx = 0; idx < validators.length; idx++) {\n      const msg = validators[idx](field);\n      if (typeof msg !== 'string') {\n        console.error(`validator return info must be string!`);\n        return [];\n      }\n      if (msg) {\n        messages.push(msg);\n        if (this.options.validateFirst) {\n          // 遇到第一个失败的校验\n          break;\n        }\n      }\n    }\n\n    return messages;\n  }\n\n  public getMessageBypath(path: string) {\n    return this.errorMessages.get(path);\n  }\n}\n","import {getSnapshot, applySnapshot, resolvePath, unprotect, IAnyStateTreeNode} from 'mobx-state-tree';\nimport {$FORM_VALIDATE_KEY, getNode, getNodeByPath} from './MSTForm-utils';\nimport {MSTFormField, MSTFormFieldParams} from './MSTFormField';\nimport {computed, makeAutoObservable, observable, reaction, toJS} from 'mobx';\nimport {MSTFieldWriteableProps, Optional} from './interface';\nimport lodashGet from 'lodash/get';\nimport {IValidators, Validators} from './validators/validator';\nimport {IValidator} from './validators/interface';\n\nexport interface FieldOptions {\n  initState: Optional<MSTFieldWriteableProps>;\n}\n\nexport interface MSTFormOptions {\n  fieldOptions?: {[fieldName: string]: FieldOptions};\n}\n\nexport class MSTForm<T = {}> {\n  static create<T> (mstInstance: T, options: MSTFormOptions) {\n    return new MSTForm(mstInstance, options);\n  }\n\n  private initSnapshot: T; // 快照\n\n  private fieldsMap: Map<string, MSTFormField> = new Map();\n\n  public valiator: Validators;\n\n  constructor (public mstInstance: IAnyStateTreeNode, private options: MSTFormOptions) {\n    this.initSnapshot = getSnapshot(this.mstInstance);\n    unprotect(this.mstInstance);\n    this.initState();\n    this.initValidators();\n  }\n\n  destructor () {}\n\n  initState () {\n    const rootNode = getNode(this.mstInstance);\n    rootNode[ '$FORM_STATE_KEY' ] = observable.map(new Map<string, any>());\n  }\n\n  //初始化校验器\n  initValidators () {\n    const {fieldOptions = {}} = this.options;\n\n    const params: IValidators = {\n      form: this,\n      options: {\n        validators: {}\n      }\n    };\n\n    (Reflect.ownKeys(fieldOptions) as Array<string>).forEach((path) => {\n      params.options.validators[ path ] = lodashGet(fieldOptions[ path ], 'validators', []);\n    });\n\n    this.valiator = new Validators(params);\n  }\n\n  select (path: string): MSTFormField {\n    const node = getNodeByPath(this.mstInstance, path);\n    if (!node) {\n      return null;\n    }\n    // const nodeId = node.nodeId; // 使用nodeId作为map的可以，防止模型在嵌套情况下时，path相同造成的数据覆盖\n\n    // 1: 从缓存中获取\n    if (this.fieldsMap.has(path)) {\n      return this.fieldsMap.get(path);\n    }\n\n    const fieldOptions = lodashGet(this.options.fieldOptions, path, {}) as FieldOptions;\n    const initSnapshot = lodashGet(this.initSnapshot, path);\n    const options = {\n      ...fieldOptions\n    };\n\n    const params: MSTFormFieldParams = {\n      path: path, // 目前不考虑嵌套的path情况，第一版处理最简单的逻辑\n      form: this as any,\n      node: node,\n      options,\n      initSnapshot\n    };\n\n    const field = new MSTFormField(params);\n\n    this.fieldsMap.set(path, field);\n\n    return field;\n  }\n\n  public getValue (path?: string): any {\n    if (!path) {\n      return this.mstInstance;\n    }\n    return this.mstInstance.getValue(path);\n  }\n\n  public setValue (path: string, value: any) {\n    // resolvePath(this.mstInstance, path);\n    // (this.mstInstance as any)[path] = value;\n    this.mstInstance.setValue(path, value);\n  }\n  // 获取数据\n  public getFormData () {\n    return this.mstInstance.toJSON();\n  }\n  // 获取修改过的数据\n  public getChangeData () {\n    const result: any = {};\n    [ ...this.fieldsMap.keys() ].map((key: string) => {\n      if (this.fieldsMap.get(key).changed) {\n        result[ key ] = this.fieldsMap.get(key).value;\n      }\n    });\n    return result;\n  }\n  // 重置数据\n  public reset () {\n    applySnapshot(this.mstInstance, this.initSnapshot);\n  }\n\n  public validate () {\n    const result = this.valiator.validate();\n    return result;\n  }\n\n  public addValidator (path: string, validator: IValidator) {\n    return this.valiator.addValidator(path, validator);\n  }\n\n  public removeValidator (path: string, validator: IValidator) {\n    this.valiator.removeValidator(path, validator);\n  }\n}\n","import {MSTFormField} from '../MSTFormField';\n\nexport class ValidatorUtils {\n  /**\n   *\n   * @param field\n   * @param title : 元素label\n   * @returns\n   */\n  static required(title: string) {\n    return (field: MSTFormField) => {\n      if (field.value === undefined || field.value === null || field.value === '') {\n        return `${title} 必填`;\n      }\n      return '';\n    };\n  }\n\n  // 校验最小值，字段类型必须是数字才回生效\n  static min(title: string, num: number) {\n    return (field: MSTFormField) => {\n      if (Number.isNaN(Number(field.value)) && Number(field.value) < num) {\n        return `${title}不能小于${num}`;\n      }\n      return '';\n    };\n  }\n\n  // 校验最小值，字段类型必须是数字才回生效\n  static max(title: string, num: number) {\n    return (field: MSTFormField) => {\n      if (Number.isNaN(Number(field.value)) && Number(field.value) > num) {\n        return `${title}不能大于${num}`;\n      }\n      return '';\n    };\n  }\n  // 最小长度\n  static minLen(title: string, len: number) {\n    return (field: MSTFormField) => {\n      if (Number.isNaN(Number(field.value)) && Number(field.value) < len) {\n        return `${title}长度不能小于${len}`;\n      }\n      return '';\n    };\n  }\n  // 最大长度\n  static maxLen(title: string, len: number) {\n    return (field: MSTFormField) => {\n      if (Number.isNaN(Number(field.value)) && Number(field.value) > len) {\n        return `${title}长度不能大于${len}`;\n      }\n      return '';\n    };\n  }\n}\n","import {IType} from 'mobx-state-tree';\nimport {EntityField} from '@src/metadata/entity';\nimport {types} from './types';\nimport {metadata} from '@src/metadata/metadata';\nimport {FieldOptions, MSTForm} from './MSTForm';\nimport {BizForm} from '@src/bizForm/core/model/bizForm';\nimport {ValidatorUtils} from './validators/validatorUtils';\n\nexport interface MSTFormHelperOptions {\n  fields: Array<string>;\n  fieldOptions: {[fieldName: string]: FieldOptions};\n  initValue?: object;\n  // validators?: Array<IValidator>; // 检验期后面添加\n}\n\n// MSTForm 实例构建类\nexport class MSTFormHelper {\n  public static createForm (entityName: string, options: MSTFormHelperOptions) {\n    const {initValue} = options;\n    const entityModel = MSTFormHelper.createModel(entityName, options);\n    const mstModel = entityModel.create(initValue || {});\n\n    const MSTFormOptions = {\n      fieldOptions: options.fieldOptions\n      // validators: options.validators,\n    };\n\n    return MSTForm.create(mstModel, MSTFormOptions);\n  }\n\n  public static createModelTypes (entityName: string, fields: Array<string> = []) {\n    const modelTypes: {[key in string]: IType<any, any, any>} = {};\n    const entity = metadata.getEntity(entityName);\n\n    fields.forEach((fieldName) => {\n      const entityField = entity.getField(fieldName);\n      if (!entityField) {\n        console.error(`field '${ fieldName }' is not exist with the entity '${ entityName }'`);\n        return;\n      }\n      const typeConstructor = MSTFormHelper.createTypeConstructor(entityField);\n\n      modelTypes[ fieldName ] = typeConstructor;\n    });\n\n    return modelTypes;\n  }\n\n  public static createModel (entityName: string, options: MSTFormHelperOptions) {\n    const modelTypes = MSTFormHelper.createModelTypes(entityName, options.fields);\n    return types\n      .model(modelTypes)\n      .views((self) => ({\n        getValue (path: string) {\n          return self[ path ];\n        }\n      }))\n      .actions((self) => ({\n        setValue (path: string, value: any) {\n          self[ path ] = value;\n        }\n      }));\n  }\n\n  // 字段属性的类型\n  public static createTypeConstructor (field: EntityField) {\n    let typeConstructor: IType<any, any, any> = types.optional(types.string, '');\n\n    // 是否为外键\n    if (field.isMutil) {\n      typeConstructor = types.array(MSTFormHelper.getPrimitiveType(field.type));\n    } else if (field.isRefer) {\n      // refer\n      typeConstructor = MSTFormHelper.getPrimitiveType('refer');\n    } else {\n      // 其他类型\n      typeConstructor = MSTFormHelper.getPrimitiveType(field.type);\n    }\n\n    return typeConstructor;\n  }\n\n  public static getPrimitiveType (type: string) {\n    let typeConstructor: IType<any, any, any> = types.optional(types.string, '');\n\n    switch (type) {\n      case 'refer':\n        typeConstructor = types.refer;\n        break;\n      case 'string':\n        typeConstructor = types.optional(types.string, '');\n        break;\n      case 'bool':\n        typeConstructor = types.optional(types.boolean, false);\n        break;\n      case 'int64':\n      case 'uint64':\n      case 'int32':\n      case 'uint32':\n      case 'int8':\n      case 'uint8':\n      case 'int':\n      case 'uint':\n        typeConstructor = types.optional(types.integer, 0);\n        break;\n      case 'float':\n        typeConstructor = types.optional(types.number, 0);\n        break;\n      default:\n        typeConstructor = types.optional(types.string, ''); // 默认字符串\n    }\n    return typeConstructor;\n  }\n\n  public static addRequiredValidatror (form: MSTForm, fieldNames: string[], model: BizForm) {\n    fieldNames.forEach((fieldName) => {\n      const field = model.getField(fieldName);\n      if (field && field.required) {\n        form.addValidator(fieldName, ValidatorUtils.required(field.label));\n      }\n    });\n  }\n}\n","export default function componentsMap(bizType: string) {\n  switch (bizType) {\n    case 'string':\n      return 'Text';\n    case 'textarea':\n      return 'Textarea';\n    case 'count':\n      return 'Count';\n    case 'numeric':\n      return 'Numeric';\n    case 'date':\n      return 'Date';\n    case 'time':\n      return 'Time';\n    case 'refer':\n      return 'ReferSelect';\n    case 'enum':\n      return 'EnumSelect';\n    case 'amount':\n      return 'Amount'; // 金额\n    case 'image':\n      return 'Image';\n    case 'url':\n      return 'Url';\n    case 'datetime':\n      return 'Datetime';\n    case 'bool':\n      return 'Checkbox';\n    case 'markdown':\n      return 'Markdown';\n    case 'tags':\n      return \"TagsEditor\";\n    default:\n      return 'Text';\n  }\n}\n","/**\n * form表单字段渲染的数据模型，后端获取到的template，metadata，跟前端存在entity实体模型组合成实际的渲染模型\n */\n\nimport {IMetadataItem} from '@src/interfaces/metadata';\nimport {ITemplateColumn} from '@src/interfaces/template';\nimport {Entity, EntityField} from '@src/metadata/entity';\nimport {metadata} from '@src/metadata/metadata';\nimport {StringUtils} from '@src/utils/stringUtils';\nimport componentsMap from './componentMap';\n\nexport class BizFormField {\n  public entityField: EntityField;\n\n  // 判断字段是否是根据外键refer携带的字段， 携带的字段直接根据查询回来的数据显示，并且不能编辑和提交保存\n  // 携带项可以根据是基本数据类型来匹配对应的显示组件， 按找通用逻辑来说，说有的object对象都应该是外键，都应该匹配refer组件\n  // bizType的作用更多的是针对 string(text、textarea)、number(amount、count、percision)、bool。\n  public isCarryField: boolean;\n\n  constructor (public entityName: string, private templateColumn: ITemplateColumn, private metadataItem: IMetadataItem) {\n    const entity = metadata.getEntity(entityName);\n\n    try {\n      this.entityField = entity.getField(templateColumn.path);\n      if (!this.entityField) {\n        this.isCarryField = true;\n        this.entityField = {} as any;\n      }\n    } catch (err) {\n      console.error(`model entity: ${ this.entityName } field: ${ this.templateColumn.path } error`);\n      console.error(err);\n    }\n  }\n\n  public get label () {\n    return this.templateColumn.displayName || this.metadataItem.displayName;\n  }\n\n  public get path () {\n    return this.templateColumn.path;\n  }\n\n  public get required () {\n    return this.templateColumn.required;\n  }\n\n  public get readonly () {\n    if (this.isCarry) {\n      return true;\n    }\n    return this.templateColumn.readonly;\n  }\n  public get disabled () {\n    return this.readonly;\n  }\n  public get alwaysHidden () {\n    return this.templateColumn.alwaysHidden;\n  }\n  public get isMulti () {\n    return this.templateColumn.isMulti;\n  }\n\n  public get colSpan () {\n    return this.templateColumn.colSpan;\n  }\n\n  //\n  public get bizType () {\n    return this.entityField.bizType;\n  }\n  public get enumType () {\n    return this.entityField.enumType;\n  }\n\n  public get referType () {\n    if (!this.entityField) {\n      return;\n    }\n    return this.entityField.referType;\n  }\n\n  public get isRefer () {\n    return this.entityField.isRefer;\n  }\n\n  public get isEnum () {\n    return this.entityField.isEnum;\n  }\n\n  // 携带字段不允许编辑，只是展示作用\n  public get isCarry () {\n    return this.isCarryField;\n  }\n\n  // 系统字段，不允许编辑，只能展示\n  public get isSystemField () {\n    return this.entityField.isSystemField;\n  }\n  // 获取当前携带字段的父级字段，就是对应的entity\n  public get carryType () {\n    const pathArr = this.templateColumn.path.split('.');\n    return StringUtils.upperCapital(pathArr[ pathArr.length - 2 ]);\n  }\n\n  public get component () {\n    // 如果是携带关系的，则直接从对应的父级实体上去对应的字段的bizType信息\n    if (this.isCarry) {\n      const pathArr = this.templateColumn.path.split('.');\n      const carryField = metadata.getEntity(this.carryType).getField(pathArr.pop());\n      return componentsMap(carryField.bizType);\n    }\n    return componentsMap(this.bizType);\n  }\n}\n","import {IMetadata} from '@src/interfaces/metadata';\nimport {Entity} from '@src/metadata/entity';\nimport {metadata} from '@src/metadata/metadata';\nimport {Metadata} from '@src/pages/devtool/bizForm/form/metadata';\nimport {Template} from '@src/pages/devtool/bizForm/form/template';\nimport {BizFormField} from './bizFormField';\n\n/**\n * 前端数据模型, 用于展示使用\n */\nexport class BizForm {\n  public entity: Entity; // 基础数据模型\n  public fields: BizFormField[];\n  public fieldsMap: {[key: string]: BizFormField} = {};\n\n  public getField (key: string) {\n    return this.fieldsMap[ key ];\n  }\n\n  constructor (private entityName: string, private formMetadata: IMetadata, private formTemplate: Template) {\n    this.entity = metadata.getEntity(entityName);\n    this.init();\n  }\n\n  init () {\n    const {master = [], childTables = []} = this.formTemplate;\n    const columns = [ ...master, ...childTables ].map((table) => table.columns).flat(1);\n    this.fields = columns.map((templateCol) => {\n      const metadataItem = this.formMetadata.items.find((item) => item.path === templateCol.path);\n      const formField = new BizFormField(this.entityName, templateCol, metadataItem);\n\n      this.fieldsMap[ templateCol.path ] = formField;\n      // 如果携带关系的跟业务对象没有在map中，那么需要补充进去，因为mstForm的取值过程是从根业务对象开始的\n      if (formField.isCarry && !this.fieldsMap[ templateCol.path.split('.')[ 0 ] ]) {\n        const rootPath = templateCol.path.split('.')[ 0 ];\n        const rootMetadataItem = this.formMetadata.items.find((item) => item.path === rootPath);\n        const rootFormField = new BizFormField(this.entityName, templateCol, rootMetadataItem);\n        this.fieldsMap[ rootPath ] = rootFormField;\n      }\n\n      return formField;\n    });\n  }\n}\n","import {autobind} from 'core-decorators';\nimport {BaseModule} from './baseModule';\nimport {ILisenter, ModuleNames} from './interface';\nimport {ModuleWrapper} from './moduleManager';\n\n@autobind\n@ModuleWrapper(ModuleNames.EventModule)\nexport class EventModule extends BaseModule {\n  private eventStock: Map<string, Array<ILisenter>> = new Map();\n\n  /**\n   *  添加 支持异步函数\n   * @param eventName\n   * @param listener\n   * @returns\n   */\n  public on (eventName: string, listener: ILisenter) {\n    const listeners = this.eventStock.get(eventName) || [];\n    listeners.push(listener);\n    this.eventStock.set(eventName, listeners);\n\n    return () => {\n      this.off(eventName, listener);\n    };\n  }\n\n  // 卸载\n  public off (eventName: string, listener: ILisenter) {\n    const listeners = this.eventStock.get(eventName) || [];\n    this.eventStock.set(\n      eventName,\n      listeners.filter((item) => item !== listener),\n    );\n  }\n\n  /**\n   * @param eventName\n   * @param params\n   */\n  public async dispatch (eventName: string, ...params: any) {\n    const listeners = this.eventStock.get(eventName) || [];\n    for (let i = 0; i < listeners.length; i++) {\n      await listeners[ i ](params);\n    }\n  }\n\n  /**\n   *\n   * @param eventName : 提供事件名称时清空指定对应名称的事件，否则清空所有事件\n   */\n  public clear (eventName?: string) {\n    if (eventName) {\n      this.eventStock.delete(eventName);\n    } else {\n      this.eventStock.clear();\n    }\n  }\n}\n","import {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {IMetadata} from '@src/interfaces/metadata';\nimport {ITemplate, TemplateSection} from '@src/interfaces/template';\nimport {observable} from 'mobx';\nimport {DataLoader, IDataloaderOptions} from '../dataLoader/dataLoader';\nimport {graphql} from '../graphql';\n\nexport interface FormDataLoaderOptions extends IDataloaderOptions {\n  id: string;\n  presenter: BizFormPresenter;\n}\n\n// type QueryParams struct {\n// \tQuery     string                 `json:\"query\"`\n// \tOperation string                 `json:\"operation\"`\n// \tVariables map[string]interface{} `json:\"variables\"`\n// }\n\nexport class FormDataLoader extends DataLoader {\n  @observable\n  public data = {};\n\n  private id: string;\n\n  private presenter: BizFormPresenter;\n\n  constructor (options: FormDataLoaderOptions) {\n    super(options);\n    this.id = options.id;\n    this.presenter = options.presenter;\n\n    this.proccessQueryOptions();\n\n    this.initQueryBuilder();\n  }\n\n  private proccessQueryOptions () {\n    this.queryOptions = {\n      queryFields: this.getTemplatepath(),\n      queryStr: this.options.queryStr,\n      queryCondition: [ `id: \"${ this.id }\"` ]\n    };\n  }\n\n  // 根据元数据整理查询字段\n  private getMetadataPath () {\n    return this.presenter.metadata.items.map((item) => item.path);\n  }\n\n  // 根据tempalte整理查询字段\n  private getTemplatepath () {\n    const paths: string[] = [];\n    const {master = [], childTables = []} = this.presenter.template;\n    // 主表\n    master.forEach((section: TemplateSection) => {\n      section.columns.forEach((col) => {\n        paths.push(col.path);\n      });\n    });\n\n    // 子表\n    childTables.forEach((section: TemplateSection) => {\n      section.columns.forEach((col) => {\n        paths.push(`${ section.path }.${ col.path }`);\n      });\n    });\n\n    return paths;\n  }\n\n  public async query () {\n    const _params = {\n      query: this.queryBuilder.toString()\n    };\n    const result = await graphql(_params);\n\n    this.data = result.data ? result.data[ this.presenter.entityName ] : {};\n  }\n}\n","import { autobind } from 'core-decorators';\nimport { fetchMetadata, fetchTemplate } from \"@src/http\";\nimport { FormDataLoader } from \"@src/http/formDataLoader\";\nimport { Metadata } from \"@src/metadata/metadata\";\nimport { Template } from \"@src/pages/devtool/bizForm/form/template\";\nimport { BizFormPresenter } from \"../bizFormPresenter\";\nimport { LifecycleEvent } from \"../lifecycleEvent\";\nimport { BaseModule } from \"./baseModule\";\nimport { EventModule } from \"./eventModule\";\nimport { ModuleNames } from \"./interface\";\nimport { ModulePropertyWrapper, ModuleWrapper } from \"./moduleManager\";\nimport { FormMode } from '../formMode';\n\n\n// 整个页面的初始化模块\n@autobind\n@ModuleWrapper(ModuleNames.InitModule)\nexport class InitModule extends BaseModule {\n\n  @ModulePropertyWrapper(ModuleNames.Presenter) private presenter: BizFormPresenter\n  @ModulePropertyWrapper(ModuleNames.EventModule) private eventModule: EventModule\n\n  public apply() {\n    this.eventModule.on(LifecycleEvent.onModuleReady, this.loadData)\n  }\n\n  // 加载tempalte、metadata、formData数据\n  private async loadData() {\n    const { presenter } = this;\n    // @TODO: 考虑抽离出去\n    const [metadata, template] = await Promise.all([\n      fetchMetadata(presenter.entityName),\n      fetchTemplate(presenter.entityName),\n    ]);\n    // 获取form表单数据\n\n    presenter.metadata = metadata as any;\n    presenter.template = template as any;\n    if (presenter.mode === FormMode.Create) {\n      presenter.initFormData = {};\n    } else {\n      const formDataLoader: FormDataLoader = new FormDataLoader({\n        entityName: presenter.entityName,\n        presenter,\n        // @TODO: 暂时写死\n        id: presenter.id,\n      });\n\n      await formDataLoader.query();\n\n      presenter.initFormData = formDataLoader.data || {};\n    }\n\n    this.eventModule.dispatch(LifecycleEvent.onLoadedInitData);\n  }\n}\n","import {autobind} from 'core-decorators';\nimport {fetchMetadata, fetchTemplate} from '@src/http';\nimport {FormDataLoader} from '@src/http/formDataLoader';\nimport {metadata, Metadata} from '@src/metadata/metadata';\nimport {Template} from '@src/pages/devtool/bizForm/form/template';\nimport {BizFormPresenter} from '../bizFormPresenter';\nimport {LifecycleEvent} from '../lifecycleEvent';\nimport {BaseModule} from './baseModule';\nimport {EventModule} from './eventModule';\nimport {FormAction, FormSaveParams, ModuleNames} from './interface';\nimport {ModulePropertyWrapper, ModuleWrapper} from './moduleManager';\nimport {postFormData} from '@src/http/formData';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {FormMode} from '../formMode';\nimport _get from 'lodash/get';\nimport {toJS} from 'mobx';\n// 整个页面的初始化模块\n@autobind\n@ModuleWrapper(ModuleNames.FormModule)\nexport class FormModule extends BaseModule {\n  @ModulePropertyWrapper(ModuleNames.Presenter) private presenter: BizFormPresenter;\n  @ModulePropertyWrapper(ModuleNames.EventModule) private eventModule: EventModule;\n\n  public apply () {\n    this.eventModule.on(LifecycleEvent.onSave, this.save);\n  }\n\n  // 加载tempalte、metadata、formData数据\n  private async save () {\n    if (this.presenter.form.validate()) {\n      const data = this.getPostData(this.presenter.form.getChangeData());\n      data.id = this.presenter.id;\n\n      const params: FormSaveParams = {\n        entityName: this.presenter.entityName,\n        action: FormAction.Save,\n        mode: this.presenter.mode === FormMode.Create ? 'create' : 'update',\n        data\n      };\n\n      this.presenter.loadingStatus = LoadingStatus.Loading;\n      try {\n        const result = (await postFormData(params)) as any;\n        this.presenter.loadingStatus = LoadingStatus.Complete;\n        // 触发数据完成后的操作，一般进行页面跳转，跳转到查看页面\n        this.eventModule.dispatch(LifecycleEvent.afterSave, result[ 'id' ]);\n      } catch (err) {\n        this.presenter.loadingStatus = LoadingStatus.Failed;\n      }\n    } else {\n      const errorMessages = toJS(this.presenter.form.valiator.errorMessages);\n      // 滚动到报错的元素位置，errorMessages是一个Map，所以可能滚动到的不是第一个报错的元素，后面修改validator的错误手机方式一起改掉\n      const name = [ ...errorMessages.keys() ][ 0 ];\n      // scrollIntoView 滚动到元素所在位置\n      // MDN https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollIntoView\n      document.getElementById(name)?.scrollIntoView({behavior: 'smooth'});\n    }\n  }\n\n  // 处理要保存到服务器上的数据，进行数据的增量保存，没修改过的不保存\n  private getPostData (data: any) {\n    const result: any = {};\n    const entity = metadata.getEntity(this.presenter.entityName);\n    [ ...Reflect.ownKeys(data) ].forEach((path) => {\n      const entityField = entity.getField(path as string);\n      if (entityField) {\n        if (entityField.isRefer) {\n          // 外建只保存id\n          result[ entityField.name ] = _get(data[ path ], 'id', undefined);\n        } else {\n          result[ entityField.name ] = data[ path ];\n        }\n      }\n    });\n\n    return result;\n  }\n}\n","import {IBizAction, IBizActionManager, useCallback} from './interface';\n\nexport class BaseBizActionManager<T> implements IBizActionManager<T> {\n  defaultActions: Array<IBizAction> = [];\n\n  useCallbackList: Array<useCallback<T>> = [];\n\n  constructor (defaultActions?: Array<IBizAction>) {\n    this.defaultActions = defaultActions || [];\n  }\n\n  public use (func: useCallback<T>) {\n    if (typeof func === 'function') {\n      this.useCallbackList.push(func);\n    } else {\n      throw new Error('func is not a function');\n    }\n  }\n\n  public execute (data?: T) {\n    return this.useCallbackList.reduce((prev, func) => {\n      return func(prev, data);\n    }, this.defaultActions);\n  }\n}\n","import {EditAction} from './EditAction';\nimport {GotoListAction} from './GotoListAction';\nimport {RefreshAction} from \"./RefreshAction\";\nexport default {EditAction, GotoListAction, RefreshAction};\n","import { BizFormPresenter } from '@src/bizForm/bizFormPresenter';\nimport {FormMode} from '@src/bizForm/formMode';\nimport {RouteUtils} from '@src/router/routeUtils';\n\nexport const EditAction = {\n  key: 'edit',\n  label: '编辑',\n  options: {\n    onClick: (presenter: BizFormPresenter, data: any) => {\n      RouteUtils.toForm({\n        entityName: presenter.entityName,\n        mode: FormMode.Edit,\n        id: presenter.initFormData.id,\n      });\n    }\n  }\n};\n","import {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport _get from 'lodash/get';\nimport {RouteUtils} from '@src/router/routeUtils';\n/**\n * 列表行使用\n */\nexport const GotoListAction = {\n  key: 'gotoList',\n  label: '返回列表',\n  options: {\n    onClick: (presenter: BizListPresenter, data?: any) => {\n      RouteUtils.toList({\n        entityName: presenter.entityName\n      });\n    }\n  }\n};\n","import { BizFormPresenter } from '@src/bizForm/bizFormPresenter';\nimport {FormMode} from '@src/bizForm/formMode';\nimport { LifecycleEvent } from '@src/bizForm/lifecycleEvent';\nimport { ModuleNames } from '@src/bizForm/modules/interface';\nimport {RouteUtils} from '@src/router/routeUtils';\n\nexport const RefreshAction = {\n  key: 'refresh',\n  label: '刷新',\n  options: {\n    onClick: (presenter: BizFormPresenter, data: any) => {\n      presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.reloadBizForm);\n    }\n  }\n};\n","import {BaseBizActionManager} from './baseBizActionManager';\nimport FormActions from './formActions';\n\nexport class BizFormActionManager<T> extends BaseBizActionManager<T> {\n  defaultActions = [ FormActions.GotoListAction, FormActions.EditAction, FormActions.RefreshAction ];\n}\n","import {autobind} from 'core-decorators';\nimport {FieldOptions, MSTForm} from '@src/MST-Form/MSTForm';\nimport {MSTFormHelper, MSTFormHelperOptions} from '@src/MST-Form/MSTFormHepler';\nimport {Metadata} from '@src/pages/devtool/bizForm/form/metadata';\nimport {Template} from '@src/pages/devtool/bizForm/form/template';\nimport {BizForm} from './core/model/bizForm';\nimport {FormMode} from './formMode';\nimport {LifecycleEvent} from './lifecycleEvent';\nimport {EventModule} from './modules';\nimport {InitModule} from './modules/initiModule';\nimport {ModuleNames} from './modules/interface';\nimport {ModuleManager} from './modules/moduleManager';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {FormModule} from './modules/formModule';\nimport {RouteUtils} from '@src/router/routeUtils';\nimport {observable} from 'mobx';\nimport {IDisposer} from '@src/MST-Form/interface';\nimport {v4 as uuidv4} from 'uuid';\nimport {BizFormConfig} from './interface';\nimport {BizFormActionManager} from '@src/bizAction/bizFormActionManager';\nimport {BizFormItemPresenter} from './bizFormItemPresenter';\n\nexport interface IBizFormPresenterOptions {\n  entityName: string;\n  mode: FormMode;\n}\n\n@autobind\nexport class BizFormPresenter<T = any> {\n  // 用于表示form表单的id，用于后面获取form元素使用\n  public _formId = uuidv4();\n\n  public id?: string;\n\n  // 表单模式\n  public mode: FormMode;\n\n  // 表示的前端模型\n  public model: BizForm;\n\n  // 元数据\n  public metadata: Metadata;\n\n  // 模板数据\n  public template: Template;\n\n  public entityName: string;\n\n  // 最原始的表单数据\n  public initFormData: any = {};\n\n  public disposers: Array<IDisposer> = [];\n\n  @observable\n  public form: MSTForm;\n\n  @observable\n  public loadingStatus: LoadingStatus = LoadingStatus.None;\n\n  // 模块管理属性\n  public modules: ModuleManager;\n\n  public config: BizFormConfig<T>;\n  // 明细表presenter\n  public bizFormItemPresenters: Array<BizFormItemPresenter> = [];\n\n  public getModule (moduleName: string) {\n    return this.modules.get(moduleName);\n  }\n\n  // 获取所有master的字段属性的数组, logicPath 字段的所属路径前缀\n  public getFields (logicPath: string) {\n    return this.model.fields.filter((field) => field.path.startsWith(logicPath));\n  }\n\n  // 表单数据\n  // public formData: BizFormData = new BizFormData();\n\n  constructor (public readonly options: IBizFormPresenterOptions) {\n    this.entityName = options.entityName;\n    this.mode = options.mode;\n  }\n\n  // 析构函数\n  public destructor () {\n    // 销毁当前模块添加的监听器\n    this.disposers.forEach((disposer) => disposer && disposer());\n  }\n\n  public initData () {\n    this.initModules();\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.onLoadedInitData, this.initForm);\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.afterSave, this.afterSave);\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.onFormCreated, this.$onFormCreated);\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onModuleReady);\n\n    this.config = this._bizFormConfig();\n  }\n\n  private initModules () {\n    this.modules = new ModuleManager({\n      seeds: {\n        [ ModuleNames.Presenter ]: this\n      },\n      modules: [ EventModule, InitModule, FormModule ],\n      presenter: this\n    });\n  }\n\n  // // 初始化MSTForm\n  public initForm () {\n    this.model = new BizForm(this.entityName, this.metadata, this.template);\n    const options: MSTFormHelperOptions = {\n      fields: [],\n      // TODO: 暂时将id省略掉\n      //   fields: [\"id\"],\n      fieldOptions: {},\n      initValue: this.initFormData\n    };\n    this.model.fields\n      .map((field) => field.path)\n      .forEach((fieldName) => {\n        // @TODO 长度超过一要么是携带、要么是子表。目前不处理子表\n        if (fieldName.split('.').length === 1) {\n          options.fields.push(fieldName);\n        } else {\n          // 将所属业务对象加进去，取值时才不会从对应的业务对象上拿到具体的值，否则会因为找不到对象报错\n          options.fields.push(fieldName.split('.')[ 0 ]);\n        }\n      });\n    options.fields = [ ...new Set(options.fields) ];\n\n    // 主表的所有属性的initState\n    options.fields\n      .filter((fieldName) => this.model.entity.getField(fieldName))\n      .forEach((fieldName) => {\n        if (!options.fieldOptions[ fieldName ]) {\n          options.fieldOptions[ fieldName ] = {} as FieldOptions;\n        }\n        if (!options.fieldOptions[ fieldName ].initState) {\n          options.fieldOptions[ fieldName ].initState = {};\n        }\n\n        options.fieldOptions[ fieldName ].initState = {\n          disabled: this.model.fieldsMap[ fieldName ].readonly,\n          required: this.model.fieldsMap[ fieldName ].required,\n          errors: []\n        };\n\n        // 必填校验\n        // options.fieldOptions\n      });\n    // 携带字段的\n\n    this.form = MSTFormHelper.createForm(this.entityName, options);\n\n    MSTFormHelper.addRequiredValidatror(this.form, options.fields, this.model);\n    window[ 'form' ] = this.form;\n\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onFormInitialized);\n    this.loadingStatus = LoadingStatus.Complete;\n  }\n\n  private afterSave (id: string) {\n    RouteUtils.toForm({\n      entityName: this.entityName,\n      mode: FormMode.View,\n      id\n    });\n  }\n\n  //<! ---- start 生命周期>\n  public onBeforeSave (data: any) {\n    return data;\n  }\n\n  // 表单渲染完成\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {}\n  //<! ---- end 生命周期>\n\n  public save () {\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onSave);\n  }\n\n  public getForm () {\n    return this.form;\n  }\n\n  public $onFormCreated () {\n    this.onFormCreated(this.form, this.disposers);\n  }\n\n  public bizFormConfig (config: BizFormConfig<T>): BizFormConfig<T> {\n    // const listConfig = new ListConfig();\n    return config;\n  }\n\n  private _bizFormConfig (): BizFormConfig<T> {\n    const defaultConfig: BizFormConfig<T> = {\n      formActionManager: new BizFormActionManager()\n    };\n    return this.bizFormConfig(defaultConfig);\n  }\n}\n","import {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport { MSTFormField } from '@src/MST-Form/MSTFormField';\nimport {autobind} from 'core-decorators';\nimport {reaction} from 'mobx';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class ProductFormPresenter extends BizFormPresenter {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    // disposers.push(\n    //     reaction(\n    //         () => form.select(\"category\").value,\n    //         (value) => {\n    //             form.select(\"name\").disabled = !form.select(\"name\").disabled;\n    //         }\n    //     )\n    // )\n    // this.form.addValidator(\"name\", (field: MSTFormField) => {\n    //   if (field.value === \"123\") {\n    //     return \"123 ---\";\n    //   }\n    //   return \"\";\n    // })\n  }\n\n  private addValidators = (form: MSTForm) => {\n    \n  }\n}\n","import {autobind} from 'core-decorators';\nimport {LifecycleEvent} from '../lifecycleEvent';\nimport {BaseModule} from './baseModule';\nimport {EventModule} from './eventModule';\nimport {ModuleNames} from './interface';\nimport {ModulePropertyWrapper, ModuleWrapper} from './moduleManager';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport localforage from 'localforage';\nimport {toJS} from 'mobx';\n\nexport const QUERY_SOLUTION_PREFIX = '__QUERY_SOLUTION__';\n// 整个页面的初始化模块\n@autobind\n@ModuleWrapper(ModuleNames.ListModule)\nexport class ListModule extends BaseModule {\n  @ModulePropertyWrapper(ModuleNames.Presenter)\n  private presenter: BizListPresenter;\n  @ModulePropertyWrapper(ModuleNames.EventModule)\n  private eventModule: EventModule;\n\n  // 选中行的key\n  private selectedRowKeys: string[] = [];\n\n  public apply () {\n    this.eventModule.on(LifecycleEvent.queryListData, this.queryListData);\n    this.eventModule.on(LifecycleEvent.resetQueryListSolutionValues, this.resetQueryListQueryValues);\n  }\n\n  // 查询数据\n  private async queryListData () {\n    const {presenter} = this;\n    this.saveQueryOptions();\n    presenter.dataLoader.queryBuilder.setCriteriaStr(this.presenter.querySolution.getQueryStr());\n    await presenter.dataLoader.query();\n  }\n\n  // 重置查询列表的查询条件\n  private resetQueryListQueryValues () {\n    this.presenter.querySolution.resetValues();\n    this.queryListData();\n  }\n\n  private saveQueryOptions () {\n    const items = this.presenter.querySolution.items;\n    const values = items.reduce((prev, current) => {\n      prev[ current.path ] = toJS(current.values);\n      return prev;\n    }, {} as any);\n\n    const valueTypes = items.reduce((prev, current) => {\n      prev[ current.path ] = current.valueType;\n      return prev;\n    }, {} as any);\n\n    localforage.setItem(\n      `${ this.presenter.querySchema.id }${ QUERY_SOLUTION_PREFIX }options`,\n      {\n        values,\n        valueTypes\n      },\n      (err) => {\n        if (err) {\n          console.error(err);\n          console.log('存储查询条件失败');\n        }\n      },\n    );\n  }\n\n  public setSelectedRowKeys (keys: string[]) {\n    this.selectedRowKeys = keys;\n  }\n\n  public getSelectedRowKeys () {\n    return this.selectedRowKeys;\n  }\n}\n","import { BizFormPresenter } from \"@src/bizForm/bizFormPresenter\"\nimport { FormMode } from \"@src/bizForm/formMode\"\nimport { BizListPresenter } from \"@src/bizList/bizListPresenter\"\nimport { RouteUtils } from \"@src/router/routeUtils\"\n\n/**\n * 列表行使用\n */\nexport const CreateAction = {\n    key: \"create\",\n    label: \"新增\",\n    options: {\n        onClick: (presenter: BizListPresenter, data?: any) => {\n            RouteUtils.toForm({\n                entityName: presenter.entityName,\n                mode: FormMode.Create,\n            })\n        }\n    }\n}\n","import {Select} from 'antd';\nimport React, {memo} from 'react';\nimport {BoolSelectProps} from './types';\nimport './style.scss';\n\nexport default memo(function BoolSelect (props: BoolSelectProps): JSX.Element {\n  const {isMutil, ...reset} = props;\n  const options: Array<{label: string; value: any}> = [\n    {\n      label: '是',\n      value: true\n    },\n    {\n      label: '否',\n      value: false\n    }\n  ];\n  return <Select className=\"bool-select\" options={options} {...reset} allowClear/>;\n});\n","import * as React from 'react';\nimport './style.scss';\n\nexport interface BetweenWrapperProps {\n  value: Array<any>;\n  onChange: (index: number, val: number) => void;\n  component: any;\n}\n\nexport const BetweenWrapper = ({value, onChange, component: Comp, ...reset}: BetweenWrapperProps) => {\n  return (\n    <div className=\"between-wrapper\">\n      <div className=\"between-item\">\n        <Comp {...reset} value={value[0]} onChange={(val: any) => onChange(0, val)} />\n      </div>\n      <span className=\"between-item-divider\">-</span>\n      <div className=\"between-item\">\n        <Comp {...reset} value={value[1]} onChange={(val: any) => onChange(1, val)} />\n      </div>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { IBizFormComponentOProps } from '../interface';\nimport { Count } from '../Count';\nimport { BetweenWrapper } from '../BetweenWrapper';\n\ninterface ICountBetween extends IBizFormComponentOProps {\n    value: Array<number>\n}\n\n/**\n *整数-区间\n * @param props \n * @returns \n */\nexport function CountBetween(props: ICountBetween) {\n    const value = Array.isArray(props.value) ? props.value : [];\n\n    const onChange = (index: number, val: number) => {\n        value[index] = val;\n        props.onChange && props.onChange(value);\n    }\n\n    return <BetweenWrapper {...props} value={value} onChange={onChange} component={Count}/>\n    // return <div style={{display: 'flex'}}>\n    //     <Count {...props} value={value[0]} onChange={(val) => onChange(0, val)} />\n    //     <span>-</span>\n    //     <Count {...props} value={value[1]} onChange={(val) => onChange(1, val)} />\n    // </div>\n}\n","import moment from 'moment';\nimport {BetweenWrapper} from '../BetweenWrapper';\nimport {DatePicker} from '../DatePicker';\nimport {IBizFormComponentOProps} from '../interface';\n\nexport interface IDatePickerBetween extends IBizFormComponentOProps {\n  value: Array<number>;\n}\n/**\n *\n * @param props 日期组件\n * @returns\n */\nexport const DatePickerBetween = (props: IDatePickerBetween) => {\n  const value = Array.isArray(props.value) ? props.value : [];\n\n  const onChange = (index: number, val: number) => {\n    value[ index ] = val;\n    if (val && index === 0) {\n      // 开始时间\n      value[ index ] = moment(value[ index ]).startOf('d').valueOf();\n    }\n    if (val && index === 1) {\n      // 天开始时间\n      value[ index ] = moment(value[ index ]).endOf('d').valueOf();\n    }\n    props?.onChange(value);\n  };\n\n  return <BetweenWrapper {...props} value={value} onChange={onChange} component={DatePicker} />;\n};\n","import {BetweenWrapper} from '../BetweenWrapper';\nimport {DatetimePicker} from '../DatetimePicker';\nimport {IBizFormComponentOProps} from '../interface';\n\nexport interface IDatetimePickerBetween extends IBizFormComponentOProps {\n  value: Array<number>;\n}\n/**\n *\n * @param props 日期组件\n * @returns\n */\nexport const DatetimePickerBetween = (props: IDatetimePickerBetween) => {\n  const value = Array.isArray(props.value) ? props.value : [];\n\n  const onChange = (index: number, val: number) => {\n    value[ index ] = val;\n    props?.onChange(value);\n  };\n\n  return <BetweenWrapper {...props} value={value} onChange={onChange} component={DatetimePicker} />;\n};\n","import * as React from 'react';\nimport { BetweenWrapper } from '../BetweenWrapper';\nimport { IBizFormComponentOProps } from '../interface';\nimport { Numeric } from '../Numeric';\n\ninterface INumericBetween extends IBizFormComponentOProps {\n    value: Array<number>\n}\n\n/**\n *整数-区间\n * @param props \n * @returns \n */\nexport function NumericBetween(props: INumericBetween) {\n    const value = Array.isArray(props.value) ? props.value : [];\n\n    const onChange = (index: number, val: number) => {\n        value[index] = val;\n        props.onChange && props.onChange(value);\n    }\n\n    return <BetweenWrapper {...props} value={value} onChange={onChange} component={Numeric}/>\n}\n","import {IQuerySchemaItem} from '@src/interfaces/queryScheme';\nimport {metadata} from '@src/metadata/metadata';\nimport {Observer} from 'mobx-react';\nimport * as React from 'react';\nimport BoolSelect from '../BoolSelect';\nimport {Count} from '../Count';\nimport {CountBetween} from '../CountBetween';\nimport {DatePicker} from '../DatePicker';\nimport {DatePickerBetween} from '../DatePickerBetween';\nimport {DatetimePicker} from '../DatetimePicker';\nimport {DatetimePickerBetween} from '../DatetimePickerBetween';\nimport EnumSelect from '../EnumSelect';\nimport {Input} from '../Input';\nimport {Numeric} from '../Numeric';\nimport {NumericBetween} from '../NumericBetween';\nimport Refer from '../Refer';\nimport {ValueType} from './valueTypeMaps';\n\nfunction getTextInut (valueType: ValueType) {\n  return Input;\n}\n\nfunction getBoolSelect (valueType: ValueType) {\n  return BoolSelect;\n}\n\nfunction getCountInut (valueType: ValueType) {\n  switch (valueType) {\n    case ValueType.between:\n      return CountBetween;\n    default:\n      return Count;\n  }\n}\n\nfunction getNumericInut (valueType: ValueType) {\n  switch (valueType) {\n    case ValueType.between:\n      return NumericBetween;\n    default:\n      return Numeric;\n  }\n}\n\nfunction getDatePicker (valueType: ValueType) {\n  switch (valueType) {\n    case ValueType.between:\n      return DatePickerBetween;\n    default:\n      return DatePicker;\n  }\n}\n\nfunction getDatetimePicker (valueType: ValueType) {\n  switch (valueType) {\n    case ValueType.between:\n      return DatetimePickerBetween;\n    default:\n      return DatetimePicker;\n  }\n}\n\nfunction getReferSelect (valueType: ValueType) {\n  return ReferSelectWrapper;\n}\n\nfunction ReferSelectWrapper (props: {\n  fieldName: string;\n  entityName: string;\n  querySchemaItems: Array<IQuerySchemaItem>;\n  onChange: (...data: any) => void;\n  value: any;\n  className: string;\n  isMutil?: boolean;\n}) {\n  const {fieldName, entityName, querySchemaItems, className, isMutil} = props;\n  const entityField = metadata.getEntity(entityName).getFieldLastNode(fieldName);\n  if (!entityField) {\n    return null;\n  }\n\n  const logicPath = entityField.referType;\n\n  const getName = React.useCallback((path: string) => {\n    const prefixEntityLen = logicPath.split('.').length;\n    return path.split('.').slice(prefixEntityLen).join('');\n  }, []);\n\n  const queryFields = querySchemaItems.map((field) => getName(field.path)).filter((fieldName) => !!fieldName);\n  const onChange = (value: any) => {\n    if (!isMutil) {\n      value = [ value ];\n    }\n    props.onChange && props.onChange(value);\n  };\n\n  return (\n    <Observer>\n      {() => (\n        <Refer\n          className={className}\n          entityName={entityField.referType}\n          queryFields={queryFields}\n          // @TODO: 目前只考虑单值，多值后面兼容\n          isMutil={isMutil}\n          value={isMutil ? props.value : props.value ? props.value[ 0 ] : undefined}\n          onChange={onChange}\n        />\n      )}\n    </Observer>\n  );\n}\n\nfunction getEnumSelect (valueType: ValueType) {\n  return EnumSelect;\n}\n\n/**\n * 根据不同的数据类型展示不同的查询条件选项\n */\n\nexport const getQuerySchemaInput = (bizType: string, valueType: ValueType) => {\n  switch (bizType) {\n    case 'refer':\n      return getReferSelect(valueType);\n    case 'text':\n    case 'textarea':\n    case 'url':\n      return getTextInut(valueType);\n    case 'bool':\n      return getBoolSelect(valueType);\n    case 'count':\n      return getCountInut(valueType);\n    case 'numeric':\n      return getNumericInut(valueType);\n    case 'date':\n      return getDatePicker(valueType);\n    case 'datetime':\n      return getDatetimePicker(valueType);\n    case 'enum':\n      return getEnumSelect(valueType);\n    default:\n      return getTextInut(valueType);\n  }\n};\n","import {metadata} from '@src/metadata/metadata';\n\n// 后端模型type判断\nexport class FieldPathUtils {\n  // 获取path中末尾节点在对应实体中的模型数据\n  public static getPathInfo (entityName: string, path: string) {\n    const pathArr = path.split('.');\n    let entity = metadata.getEntity(entityName);\n    let pathInfo = null;\n    while (pathArr.length) {\n      const pathItem = pathArr.shift();\n      const field = entity.getField(pathItem);\n      if (field) {\n        // 普通字段直接结束\n        if (!field.isRefer && !field.isDetail) {\n          pathInfo = field;\n          break;\n        }\n        // 如果当前节点是末尾节点，直接返回，即使是refer也返回。\n        if (!pathArr.length) {\n          return field;\n        }\n        // 如果当前节点是refer，则继续往下找\n        if (field.isRefer) {\n          entity = metadata.getEntity(field.referType);\n        } else {\n          break;\n        }\n      } else {\n        break;\n      }\n    }\n\n    return pathInfo;\n  }\n}\n","\n// ValueType \n\n// 等于 \nexport const ENUM_ValueType_eq = \"ValueType.eq\"; \n\n// 不等于 \nexport const ENUM_ValueType_ne = \"ValueType.ne\"; \n\n// 大于 \nexport const ENUM_ValueType_gt = \"ValueType.gt\"; \n\n// 小于 \nexport const ENUM_ValueType_lt = \"ValueType.lt\"; \n\n// 大于等于 \nexport const ENUM_ValueType_ge = \"ValueType.ge\"; \n\n// 小于等于 \nexport const ENUM_ValueType_le = \"ValueType.le\"; \n\n// 区间 \nexport const ENUM_ValueType_between = \"ValueType.between\"; \n\n// 模糊匹配 \nexport const ENUM_ValueType_like = \"ValueType.like\"; \n\n// 包含 \nexport const ENUM_ValueType_in = \"ValueType.in\"; \n\n// 不包含 \nexport const ENUM_ValueType_nin = \"ValueType.nin\"; \n\n// 全部包含 \nexport const ENUM_ValueType_all_in = \"ValueType.all_in\"; \n\n// 全部不包含 \nexport const ENUM_ValueType_all_nin = \"ValueType.all_in\"; \n\n","import {\n  ENUM_ValueType_all_in,\n  ENUM_ValueType_all_nin,\n  ENUM_ValueType_between,\n  ENUM_ValueType_in,\n  ENUM_ValueType_nin\n} from '@packages/gen/constants/enums/ValueType';\n\nexport class ValueTypeUtils {\n  public static isMutil (valueType: string): boolean {\n    return [\n      ENUM_ValueType_between,\n      ENUM_ValueType_in,\n      ENUM_ValueType_nin,\n      ENUM_ValueType_all_in,\n      ENUM_ValueType_all_nin\n    ].includes(valueType);\n  }\n}\n","import {getQuerySchemaInput} from '@src/bizForm/components/QueryValueType';\nimport {ValueType} from '@src/bizForm/components/QueryValueType/valueTypeMaps';\nimport {ValueTypeSelect} from '@src/bizForm/components/QueryValueType/ValueTypeSelect';\nimport {QuerySolution} from '@src/bizList/core/querySolution';\nimport {IQuerySchemaItem} from '@src/interfaces/queryScheme';\nimport {FieldPathUtils} from '@src/utils/fieldPath';\nimport {ValueTypeUtils} from '@src/utils/valueTypeUtils';\nimport {observer} from 'mobx-react';\nimport * as React from 'react';\nimport style from './style.module.scss';\n\nexport interface IQuerySchemaList {\n  entityName: string;\n  querySchemaItems: Array<IQuerySchemaItem>;\n  querySolution: QuerySolution;\n}\n\n@observer\nexport class QuerySchemaList extends React.Component<IQuerySchemaList> {\n  onChange = (key: string, values: Array<any>) => {};\n\n  onValueTypeChange = (path: string, value: string) => {};\n\n  getBizType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.entityName, item.path);\n    return pathInfo.bizType;\n  };\n\n  getEnumType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.entityName, item.path);\n    if (pathInfo.bizType === 'enum') {\n      return pathInfo.enumType;\n    }\n    return undefined;\n  };\n\n  render () {\n    const {querySchemaItems, querySolution, entityName} = this.props;\n    return (\n      <div className={style[ 'queryAction' ]}>\n        {querySchemaItems.map((item) => {\n          const querySolutionItem = querySolution.getByPath(item.path);\n          const bizType = this.getBizType(item);\n          const Comp = getQuerySchemaInput(bizType, querySolutionItem.valueType) as any;\n          const value = ValueTypeUtils.isMutil(querySolutionItem.valueType) ?\n            querySolutionItem.values :\n            querySolutionItem.values[ 0 ];\n\n          const props = {\n            value: value,\n            fieldName: item.path,\n            entityName: entityName,\n            querySchemaItems: querySchemaItems,\n            onChange: querySolutionItem.updateValues,\n            isMutil: [ ValueType.in, ValueType.nin ].includes(querySolutionItem.valueType),\n            enumName: this.getEnumType(item)\n          };\n          return (\n            <div className={style[ 'queryAction-item' ]}>\n              <div className={style[ 'queryAction-item-label' ]}>{item.displayName}:</div>\n              <div className={style[ 'queryAction-item-body' ]}>\n                <ValueTypeSelect\n                  className={style[ 'queryAction-item-valueType' ]}\n                  value={querySolutionItem.valueType}\n                  onChange={querySolutionItem.updateValueType}\n                  bizType={bizType}\n                  path={item.path}\n                  entityName={entityName}\n                />\n                <div className={style[ 'queryAction-item-values' ]}>\n                  <Comp {...props} />\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n","import { observer } from 'mobx-react';\nimport * as React from 'react';\nimport ListSolution from './ListSolution';\nimport { ListSolutionPresenter } from './listSolutionPresenter';\nimport { QuerySchemaList } from './QuerySchemaList';\n\nexport interface IQueryListSolution {\n  presenter: ListSolutionPresenter;\n}\n\nexport interface SQueryListSolution {\n  showSetting: boolean;\n}\n\nexport class QueryListSolution extends React.Component<IQueryListSolution, SQueryListSolution> {\n\n\n  constructor(props: IQueryListSolution) {\n    super(props);\n\n    this.state = {\n      showSetting: false,\n    }\n  }\n\n  private submit = () => {\n\n  }\n\n  render() {\n    return (\n      <div>\n        <QuerySchemaList\n          entityName={this.props.presenter.entityName}\n          querySchemaItems={this.props.presenter.querySchemaItems}\n          querySolution={this.props.presenter.querySolution}\n        />\n        {/* <ListSolution presenter={this.props.presenter}/> */}\n      </div>\n    );\n  }\n}\n","import {getQuerySchemaInput} from '@src/bizForm/components/QueryValueType';\nimport {ValueTypeSelect} from '@src/bizForm/components/QueryValueType/ValueTypeSelect';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {QuerySolution} from '@src/bizList/core/querySolution';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {QueryListSolution} from '@src/components/QueryListSolution';\nimport {ListSolutionPresenter} from '@src/components/QueryListSolution/listSolutionPresenter';\nimport {IQueryColumnItem} from '@src/interfaces/queryColumn';\nimport {IQuerySchema, IQuerySchemaItem} from '@src/interfaces/queryScheme';\nimport {FieldPathUtils} from '@src/utils/fieldPath';\nimport {Modal} from 'antd';\nimport {runInAction} from 'mobx';\nimport {observer} from 'mobx-react';\nimport * as React from 'react';\nimport style from './style.module.scss';\n\nexport interface IQuerySchemaList {\n  entityName: string;\n  querySchemaItems: Array<IQuerySchemaItem>;\n  querySolution: QuerySolution;\n}\n\nexport interface IQueryActionModal {\n  presenter: BizListPresenter;\n  onOk: () => void;\n}\n\n@observer\nexport class QuerySchemaList extends React.Component<IQuerySchemaList> {\n  onChange = (key: string, values: Array<any>) => {};\n\n  onValueTypeChange = (path: string, value: string) => {};\n\n  getBizType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.entityName, item.path);\n    return pathInfo.bizType;\n  };\n\n  getEnumType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.entityName, item.path);\n    if (pathInfo.bizType === 'enum') {\n      return pathInfo.enumType;\n    }\n    return undefined;\n  };\n\n  render () {\n    const {querySchemaItems, querySolution, entityName} = this.props;\n    return (\n      <div className={style[ 'queryAction' ]}>\n        {querySchemaItems.map((item) => {\n          const querySolutionItem = querySolution.getByPath(item.path);\n          const bizType = this.getBizType(item);\n          const Comp = getQuerySchemaInput(bizType, querySolutionItem.valueType) as any;\n          const props = {\n            value: querySolutionItem.values,\n            className: style[ 'queryAction-item-values' ],\n            onChange: querySolutionItem.updateValues,\n            enumName: this.getEnumType(item)\n          };\n          return (\n            <div className={style[ 'queryAction-item' ]}>\n              <div className={style[ 'queryAction-item-label' ]}>{item.displayName}:</div>\n              <div className={style[ 'queryAction-item-body' ]}>\n                <ValueTypeSelect\n                  className={style[ 'queryAction-item-valueType' ]}\n                  value={querySolutionItem.valueType}\n                  onChange={querySolutionItem.updateValueType}\n                  bizType={bizType}\n                  path={item.path}\n                  entityName={entityName}\n                />\n                <Comp {...props} />\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\n@observer\nexport class QueryActionModal extends React.Component<IQueryActionModal> {\n  private presenter: ListSolutionPresenter;\n\n  constructor (props: IQueryActionModal) {\n    super(props);\n    this.presenter = new ListSolutionPresenter({\n      entityName: this.props.presenter.entityName,\n      queryColumn: this.props.presenter.queryColumn,\n      querySchema: this.props.presenter.querySchema\n    });\n  }\n\n  private onSave = () => {\n    const {values, valueTypes} = this.presenter.querySolution.toJSON();\n    this.props.presenter.querySolution.setValues(values);\n    this.props.presenter.querySolution.setValueTypes(valueTypes);\n  };\n\n  private onOk = () => {\n    this.onSave();\n    this.props.onOk && this.props.onOk();\n  };\n\n  render () {\n    const {...reset} = this.props;\n    return (\n      <Modal title=\"查询方案\" {...reset} width={800} okText=\"确认\" cancelText=\"取消\" onOk={this.onOk}>\n        {this.presenter.loadingStatus === LoadingStatus.Complete ? (\n          <QueryListSolution presenter={this.presenter} />\n        ) : null}\n      </Modal>\n    );\n  }\n}\n","import { BizListPresenter } from \"@src/bizList/bizListPresenter\"\nimport React from \"react\"\nimport _get from 'lodash/get';\nimport { ModuleNames } from \"@src/bizForm/modules/interface\"\nimport { QueryActionModal } from \"./QueryActionModal\"\nimport { LifecycleEvent } from \"@src/bizForm/lifecycleEvent\"\nimport { Modals } from \"@src/components/Modals\";\n/**\n * 列表行使用\n */\nexport const QueryAction = {\n    key: \"query\",\n    label: \"查询\",\n    options: {\n        onClick: (presenter: BizListPresenter, data?: any) => {\n            Modals.show(QueryActionModal, {\n                presenter: presenter,\n                onOk: () => {\n                    presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.queryListData);\n                }\n            })\n        }\n    }\n}\n","import {CreateAction} from './CreateAction';\nimport {QueryAction} from './QueryAction';\n\nexport default {\n  CreateAction,\n  QueryAction\n};\n\nexport const DefaultListActions = [ CreateAction, QueryAction ];\n","import {BaseBizActionManager} from './baseBizActionManager';\nimport {DefaultListActions} from './listActions';\n\nexport class BizListActionManager<T> extends BaseBizActionManager<T> {\n  defaultActions = [ ...DefaultListActions ];\n}\n","import {FormMode} from '@src/bizForm/formMode';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {RouteUtils} from '@src/router/routeUtils';\n\nexport const EditAction = {\n  key: 'edit',\n  label: '编辑',\n  options: {\n    onClick: (presenter: BizListPresenter, data: any) => {\n      RouteUtils.toForm({\n        entityName: presenter.entityName,\n        mode: FormMode.Edit,\n        id: data.id\n      });\n    }\n  }\n};\n","import * as React from 'react';\n\nconst presenterContext = React.createContext<any>(null);\n\n// Presenter 上下文\nexport const PresenterProvider = presenterContext.Provider;\nexport const PresenterConsumer = presenterContext.Consumer;\n\n// loading上下文\nconst loadingContext = React.createContext(false);\nexport const LoadingProvider = loadingContext.Provider;\nexport const LoadingConsumer = loadingContext.Consumer;","import * as React from 'react';\nimport {Image} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\n\nexport interface IImageViewer {\n  value: string;\n}\n\nexport const ImageViewer = (props: IImageViewer) => {\n  return (\n    <Image\n      width={100}\n      height={100}\n      src={props.value}\n      fallback=\"data:image/png;base64,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\"\n    />\n  );\n};\n","import * as React from 'react';\nimport { IBizFormComponentOProps } from '../interface';\n\nexport interface IUrlViewer{\n    value: string;\n}\n\nexport const UrlViewer = (props: IUrlViewer) => {\n    let value = props.value;\n\n    if (!value) {\n        return null;\n    }\n    // 格式化url，\n    // 1: 检查url是否含有schema + //, 没有就加上//\n    if (!(value.startsWith(\"https://\") || value.startsWith(\"http://\"))) {\n        value = \"//\" + value;\n    }\n    return <a href={value} target=\"_blank\">{props.value}</a>\n}","import moment from 'moment';\nimport * as React from 'react';\nexport interface IImageViewer {\n  value: number;\n}\n\nexport const DatetimeViewer = (props: IImageViewer) => {\n  return <span>{props.value ? moment(props.value).format('YYYY-MM-DD HH:mm:ss') : null}</span>;\n};\n","import * as React from 'react';\nimport _get from 'lodash/get';\n\nconst toString = Object.prototype.toString;\n\nexport interface ITextViewer {\n    value: string;\n}\n/**\n * 文本的查看模式内容组件\n */\nexport const TextViewer = (props: ITextViewer): any => {\n    return <span>{props.value}</span>\n}","import * as React from 'react';\nimport {Checkbox as AntCheckbox} from 'antd';\nimport {IBizFormComponentOProps} from '../interface';\nimport {FormMode} from '@src/bizForm/formMode';\n\nexport interface ICheckboxViewer {\n  value: boolean;\n  checked?: boolean;\n}\n\nexport const CheckboxViewer = (props: ICheckboxViewer) => {\n  return <AntCheckbox {...props} disabled checked={props.value} />;\n};\n","import * as React from \"react\";\nimport _get from \"lodash/get\";\nimport {RouteUtils} from \"@src/router/routeUtils\";\nimport {FormMode} from \"@src/bizForm/formMode\";\n\nexport interface IReferViewer {\n  value: {id: string; name: string; [key: string]: any};\n  referType: string;\n}\n/**\n * 文本的查看模式内容组件\n */\nexport const ReferViewer = (props: IReferViewer): JSX.Element => {\n  const handleLink = () => {\n    RouteUtils.toForm({\n      entityName: props.referType,\n      id: props.value.id,\n      mode: FormMode.View,\n    });\n  };\n\n  return <a onClick={handleLink}>{_get(props.value, \"name\")}</a>;\n};\n","import * as React from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport remarkMath from 'remark-math';\nimport rehypeKatex from 'rehype-katex';\nimport rehypeRaw from 'rehype-raw';\nimport {Prism as SyntaxHighlighter} from 'react-syntax-highlighter';\nimport {a11yDark} from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport EazyWin from 'vwin-eazy-win';\nimport ImageLoader from 'vwin-image-loader';\nimport './style.scss';\n\ninterface IMarkdownViewer {\n  value: string;\n}\n\nexport const MarkdownViewer = (props: IMarkdownViewer) => {\n  return (\n    <ReactMarkdown\n      className=\"markdown-viewer\"\n      children={props.value}\n      remarkPlugins={[remarkGfm, remarkMath]}\n      // remarkPlugins={[remarkMath]}\n      rehypePlugins={[rehypeRaw]}\n      components={{\n        code: ({node, inline, className, children, ...reset}) => {\n          const match = /language-(\\w+)/.exec(className || '');\n          return !inline && match ? (\n            //@ts-ignore\n            <SyntaxHighlighter\n              children={String(children).replace(/\\n$/, '')}\n              style={a11yDark}\n              language={match[1]}\n              PreTag=\"div\"\n              {...reset}\n            />\n          ) : (\n            <code className={className} {...reset}>\n              {children}\n            </code>\n          );\n        },\n        img: ({node, ...reset}) => (\n          <EazyWin theme=\"dark\">\n            <ImageLoader {...reset as any} />\n          </EazyWin>\n        )\n      }}\n    />\n  );\n};\n","import React from 'react';\n\nimport {Tag, Tooltip} from 'antd';\nimport {TagsViewerProps} from './types';\nimport \"./style.scss\";\n\nexport default class TagsViewer extends React.Component<TagsViewerProps> {\n\n  getTags = (): Array<string> => {\n    return this.props.value || [];\n  };\n\n  render () {\n    const tags = this.getTags();\n    return (\n      <>\n        {tags.map((tag) => {\n          const isLongTag = tag.length > 20;\n\n          const tagElem = (\n            <Tag className=\"tagsEditor-tag\" key={tag}>\n              <span\n              >\n                {isLongTag ? `${ tag.slice(0, 20) }...` : tag}\n              </span>\n            </Tag>\n          );\n          return isLongTag ? (\n            <Tooltip title={tag} key={tag}>\n              {tagElem}\n            </Tooltip>\n          ) : (\n            tagElem\n          );\n        })}\n      </>\n    );\n  }\n}\n","import {metadata} from \"@src/metadata/metadata\";\nimport React, {memo} from \"react\";\nimport {EnumSelectProps} from \"./types\";\nimport {IEntityFieldViewer} from \"../EntityFieldViewer\";\nimport \"./style.scss\";\n\nexport default memo(function EnumSelectViewer(props: EnumSelectProps & IEntityFieldViewer): JSX.Element {\n  const {value, enumType} = props;\n  const name = metadata.getEnum(enumType)?.getTitle(value);\n  return <span>{name}</span>;\n});\n","import {BizFormField} from '@src/bizForm/core/model/bizFormField';\nimport {MSTFormField} from '@src/MST-Form/MSTFormField';\nimport * as React from 'react';\nimport _get from 'lodash/get';\nimport {ImageViewer} from '../ImageViewer';\nimport {IBizFormComponentOProps} from '../interface';\nimport {UrlViewer} from '../UrlViewer';\nimport {DatetimeViewer} from '../DatetimeViewer';\nimport {TextViewer} from '../TextViewer';\nimport {Checkbox} from '../Checkbox';\nimport {CheckboxViewer} from '../CheckboxViewer';\nimport {ReferViewer} from '../ReferViewer';\nimport {CarryViewer} from '../CarryViewer';\nimport {metadata} from '@src/metadata/metadata';\nimport {MarkdownViewer} from '../MarkdownViewer';\nimport TagsViewer from '../TagsViewer';\nimport EnumSelectViewer from '../EnumSelectViewer';\nimport { BizColumn } from '@src/bizList/core/bizList';\n\nconst toString = Object.prototype.toString;\n\nexport interface IEntityFieldViewer extends BizColumn {\n  // model: BizFormField;\n  // field: MSTFormField;\n  value: any;\n  // bizType: string;\n  // isRefer?: boolean;\n  // path: string;\n  entityName: string;\n}\n/**\n * 文本的查看模式内容组件\n */\nexport const EntityFieldViewer = (props: IEntityFieldViewer) => {\n  const {isRefer, entityName} = props;\n  let bizType = props.bizType;\n  let value = props.value;\n\n  const getEntityField = (path: string) => {\n    const entityField = metadata.getEntity(entityName).getFieldLastNode(path);\n    if (!entityField) {\n      console.error('path is not exist in entity:' + entityName);\n      return null;\n    }\n    return entityField;\n  };\n\n  if (props.path.split('.').length > 1) {\n    const entityField = getEntityField(props.path);\n    bizType = entityField.bizType;\n\n    if (props.value && typeof props.value === 'object') {\n      value = _get(props.value, 'name');\n    }\n  }\n\n  if (isRefer) {\n    const entityField = getEntityField(props.path);\n    bizType = entityField.bizType;\n  }\n\n  switch (bizType) {\n    case 'url':\n      return <UrlViewer {...props} value={value} />;\n    case 'image':\n      return <ImageViewer {...props} value={value} />;\n    case 'datetime':\n      return <DatetimeViewer {...props} value={value} />;\n    case 'text':\n    case 'textarea':\n      return <TextViewer {...props} value={value} />;\n    case 'bool':\n      return <CheckboxViewer {...props} value={value} />;\n    case 'refer':\n      return <ReferViewer {...props} value={value} />;\n    case 'markdown':\n      return <MarkdownViewer {...props} value={value} />;\n    case 'enum':\n      return <EnumSelectViewer {...props} value={value} />;\n    case 'tags':\n      return <TagsViewer {...props} value={value}/>\n    default:\n      // 携带关系\n      if (toString.call(props.value) === '[object Object]') {\n        return <span>{_get(props.value, 'name')}</span>;\n      }\n      // 默认返回\n      return <TextViewer {...props} />;\n  }\n};\n","import {BizFormField} from \"@src/bizForm/core/model/bizFormField\";\nimport {FormMode} from \"@src/bizForm/formMode\";\nimport {MSTFormField} from \"@src/MST-Form/MSTFormField\";\nimport {Col, Form} from \"antd\";\nimport {observer} from \"mobx-react\";\nimport * as React from \"react\";\nimport styles from \"./style.module.scss\";\n\nexport interface FormFieldElementProps {\n  path: string;\n  field: MSTFormField;\n  model: BizFormField;\n  mode: FormMode;\n  enumType?: string;\n  referType?: string;\n}\n\nconst COL_SPAN_STEP = 6;\n\nfunction getColSpan(colSpan: number = 1) {\n  return colSpan * COL_SPAN_STEP;\n}\n\n@observer\nexport class FormFieldElement extends React.Component<FormFieldElementProps> {\n  private getValuePropName = (bizType: string) => {\n    // return bizType === 'bool' ? 'checked' : 'value'\n    return \"value\";\n  };\n\n  private getProps = () => {\n    const {\n      model: {colSpan, path, bizType},\n      model,\n      field,\n      mode,\n    } = this.props;\n\n    return {\n      label: model.label || (field && field.label),\n      path,\n      valuePropName: this.getValuePropName(bizType),\n      required: field && typeof field.required !== \"undefined\" ? field.required : model.required,\n      mode,\n      colSpan,\n    };\n  };\n\n  render() {\n    const {children} = this.props;\n    const {colSpan, label, path, valuePropName, required} = this.getProps();\n    return (\n      <Col span={getColSpan(colSpan)}>\n        <Form.Item\n          label={label}\n          name={path}\n          className={styles[\"item-wrapper\"]}\n          valuePropName={valuePropName}\n          required={required}\n        >\n          {typeof children === \"function\" ? children(this.props) : children}\n        </Form.Item>\n      </Col>\n    );\n  }\n}\n","/**\n * Section主要用于分区，用户可以选择将不同的字段放在不同的区块中\n */\nimport {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {matchComponent} from '@src/bizForm/components';\nimport {EntityFieldViewer} from '@src/bizForm/components/EntityFieldViewer';\nimport {FormMode} from '@src/bizForm/formMode';\nimport BizSection from '@src/components/BizSection';\nimport {ITemplateColumn} from '@src/interfaces/template';\nimport {TemplateSection} from '@src/pages/devtool/bizForm/form/template';\nimport {Input, Row} from 'antd';\nimport {computed} from 'mobx';\nimport {observer} from 'mobx-react';\nimport * as React from 'react';\nimport {FieldWrapper} from '../../FieldWrapper';\nimport {FormFieldElement, FormFieldElementProps} from '../FormFieldElement';\nimport style from './style.module.scss';\n\ninterface ISection {\n  template: TemplateSection;\n  presenter: BizFormPresenter;\n  mode: FormMode;\n}\n\n@observer\nexport default class Section extends React.Component<ISection> {\n  getFieldProps = (col: ITemplateColumn) => {\n    const {\n      presenter,\n      presenter: {model, form},\n      mode,\n    } = this.props;\n    const field = model.getField(col.path)\n    const options: FormFieldElementProps = {\n      key: col.path,\n      path: col.path,\n      model: field,\n      field: form.select(col.path),\n      mode: mode,\n      presenter,\n    };\n    if (field) {\n      if (field.isEnum) {\n        options.enumType = field.enumType\n      }\n      if (field.isRefer) {\n        options.referType = field.referType\n      }\n    }\n\n    return options;\n  };\n\n  fieldRender = () => {\n    const {template, mode, presenter} = this.props;\n    if (mode === FormMode.View) {\n      return template.columns.map((col) => (\n        <FormFieldElement {...this.getFieldProps(col)} key={col.path}>\n          {(props: any) => (\n            <EntityFieldViewer\n              {...props}\n              entityName={presenter.entityName}\n              bizType={props.model.bizType}\n              isRefer={props.model.isRefer}\n            />\n          )}\n        </FormFieldElement>\n      ));\n    }\n    return template.columns.map((col) => (\n      <FormFieldElement {...this.getFieldProps(col)}>{(props: any) => matchComponent(props)}</FormFieldElement>\n    ));\n  };\n\n  render() {\n    const {template} = this.props;\n    return (\n      <BizSection\n        className={style['biz-form_section']}\n        leftElement={<span className={style['section_title']}>{template.title}</span>}\n        content={<Row>{this.fieldRender()}</Row>}\n      />\n    );\n  }\n}\n","import {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {FormMode} from '@src/bizForm/formMode';\nimport {Button} from 'antd';\nimport * as React from 'react';\nimport {IBizAction} from '../interface';\nimport styles from \"./style.module.scss\";\n\nexport interface FormActionBarProps {\n  presenter: BizFormPresenter;\n}\n\nexport class FormActionBar extends React.Component<FormActionBarProps> {\n  getActions = () => {\n    const {presenter} = this.props;\n    let actions = presenter.config.formActionManager.execute(presenter.form.getFormData());\n    if (presenter.mode !== FormMode.View) {\n      actions = actions.filter((action) => action.key !== 'edit');\n    }\n    return actions;\n  };\n\n  render () {\n    const {presenter} = this.props;\n    const actions = this.getActions();\n    return (\n      <div>\n        {actions.map((action) => (\n          <FormAction key={action.key} presenter={presenter} {...action} />\n        ))}\n      </div>\n    );\n  }\n}\n\nfunction FormAction (props: IBizAction & {presenter: BizFormPresenter}) {\n  const {label, options, presenter} = props;\n  return (\n    <Button size=\"small\" className={styles[\"formAction-item\"]} {...options} onClick={() => options.onClick && options.onClick(presenter)}>\n      {label}\n    </Button>\n  );\n}\n","\n\nexport enum ModuleNames {\n    EventModule = 'EventModule',\n    \n}","import {FormActionBar} from '@src/bizAction/ActionBar/FormActionBar';\nimport {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {FormMode} from '@src/bizForm/formMode';\nimport {metadata} from '@src/metadata/metadata';\nimport * as React from 'react';\nimport style from './style.module.scss';\n/**\n * FormHeader用于管理表单头部的功能，包括：\n * 水印、功能按钮\n */\n\ninterface IFormHeader {\n  presenter: BizFormPresenter;\n}\n\nexport class FormHeader extends React.Component<IFormHeader> {\n  render () {\n    const {presenter} = this.props;\n\n    if (presenter.mode !== FormMode.View) {\n      return null;\n    }\n\n    return (\n      <div className={style[ 'form-header' ]}>\n        <div>\n          <h3 className={style[ 'form-header-title' ]}>{metadata.getEntity(presenter.entityName).title}</h3>\n        </div>\n        <div className={style[ 'form-header-actions' ]}>\n          {/* <FormActions presenter={presenter} actions={actions}/> */}\n          <FormActionBar presenter={presenter} />\n        </div>\n      </div>\n    );\n  }\n\n  private renderActions = () => {};\n}\n","import {BizFormPresenter} from \"@src/bizForm/bizFormPresenter\";\nimport {Button, Form, FormInstance, Row} from \"antd\";\nimport {action, autorun, computed, reaction, runInAction} from \"mobx\";\nimport {Observer, observer} from \"mobx-react\";\nimport * as React from \"react\";\nimport Section from \"./Section\";\nimport _get from \"lodash/get\";\nimport styles from \"./style.module.scss\";\nimport {FormMode} from \"@src/bizForm/formMode\";\nimport {FormHeader} from \"./FormHeader\";\nimport {RouteUtils} from \"@src/router/routeUtils\";\nimport {ModuleNames} from \"@src/bizForm/modules/interface\";\nimport {LifecycleEvent} from \"@src/bizForm/lifecycleEvent\";\n\ninterface IMasterFrom {\n  // template: Template;\n  presenter: BizFormPresenter;\n}\n\n/**\n * 渲染主表字段\n */\n@observer\nexport class MasterFrom extends React.Component<IMasterFrom> {\n  _ref = React.createRef<FormInstance>();\n\n  private get formLayout() {\n    const {\n      presenter: {mode},\n    } = this.props;\n    if (mode === FormMode.View) {\n      return \"horizontal\";\n    }\n    return \"vertical\";\n  }\n\n  private isShowFooter = () => {\n    const {\n      presenter: {mode},\n    } = this.props;\n    return [FormMode.Create, FormMode.Edit].includes(mode);\n  };\n\n  // @computed\n  get getFormFields() {\n    const {\n      presenter: {model, form},\n    } = this.props;\n    const result: any = [];\n    model.fields.forEach((col) => {\n      const mstFormField = this.props.presenter.form.select(col.path);\n      result.push({\n        name: col.path,\n        errors: mstFormField && mstFormField.errors,\n        value: col.isCarry || col.isSystemField ? _get(form.getValue(), col.path, undefined) : mstFormField.value,\n      });\n    });\n\n    return result;\n  }\n\n  onValuesChange = (changedValues: {[key: string]: any} = {}) => {\n    const {\n      presenter: {form},\n    } = this.props;\n    const fieldNames = Reflect.ownKeys(changedValues) as Array<string>;\n    runInAction(() => {\n      fieldNames.forEach((fieldName) => {\n        form.select(fieldName).value = changedValues[fieldName];\n      });\n    });\n  };\n\n  private onSave = () => {\n    this.props.presenter.save();\n  };\n\n  private onCancel = () => {\n    const {\n      presenter: {mode, entityName, id},\n    } = this.props;\n    switch (mode) {\n      case FormMode.Edit:\n        RouteUtils.toForm({\n          entityName,\n          mode: FormMode.View,\n          id,\n        });\n        break;\n      case FormMode.Create:\n        RouteUtils.toList({\n          entityName,\n        });\n        break;\n      default:\n        break;\n    }\n  };\n\n  private onReset = () => {\n    this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.reloadBizForm);\n  };\n\n  render() {\n    const {\n      presenter: {template, mode, form},\n      presenter,\n    } = this.props;\n    return (\n      <Observer>\n        {() => (\n          <Form\n            // layout={template.layout as FormLayout}\n            ref={this._ref}\n            layout={this.formLayout}\n            scrollToFirstError={true} // 提交失败自动滚动到第一个校验失败的位置\n            size={\"middle\"}\n            className={styles[\"masterForm\"]}\n            fields={this.getFormFields}\n            onValuesChange={this.onValuesChange}\n          >\n            <FormHeader presenter={presenter} />\n            <div className={styles[\"masterForm-body\"]}>\n              {template.master.map((section, index) => (\n                <Section key={index} presenter={presenter} mode={mode} template={section} />\n              ))}\n            </div>\n            {this.isShowFooter() ? (\n              <div className={styles[\"masterForm-footer\"]}>\n                <div></div>\n                <div className={styles[\"actions\"]}>\n                  <Button size=\"small\" onClick={this.onReset}>\n                    重置\n                  </Button>\n                  <Button size=\"small\" onClick={this.onCancel}>\n                    取消\n                  </Button>\n                  <Button type=\"primary\" size=\"small\" onClick={this.onSave}>\n                    保存\n                  </Button>\n                </div>\n              </div>\n            ) : null}\n          </Form>\n        )}\n      </Observer>\n    );\n  }\n}\n","import { Template } from \"@src/pages/devtool/bizForm/form/template\";\nimport { Col, Form, Row } from \"antd\";\nimport { FormLayout } from \"antd/lib/form/Form\";\nimport { observable, reaction } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport { Observer } from \"mobx-react-lite\";\nimport * as React from \"react\";\nimport { BizFormPresenter } from \"../bizFormPresenter\";\nimport { LifecycleEvent } from \"../lifecycleEvent\";\nimport { ModuleNames } from \"../modules/interface\";\nimport { MasterFrom } from \"./form-zone/masterForm\";\n\nimport styles from \"./style/index.module.scss\";\n\ninterface IBizFormBody {\n  // template: Template;\n  presenter: BizFormPresenter;\n}\n\nexport class BizFormBody extends React.Component<IBizFormBody> {\n\n  componentDidMount() {\n    this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onFormCreated);\n  }\n\n  render() {\n    return this.renderContent();\n  }\n\n  renderContent = () => {\n    const {\n      presenter: { template, mode },\n      presenter,\n    } = this.props;\n    if (!template) {\n      return null;\n    }\n    return <MasterFrom presenter={presenter} />;\n  };\n}\n","import LoadingContainer, {LoadingStatus} from '@src/components/LoadingContainer';\nimport * as React from 'react';\nimport {BizFormPresenter} from './bizFormPresenter';\nimport {PresenterProvider} from './context/bizFormContext';\nimport {FormMode} from './formMode';\nimport {LifecycleEvent} from './lifecycleEvent';\nimport {ModuleNames} from './modules/interface';\nimport {BizFormBody} from './page/bizFormBody';\n\ninterface IBizForm {\n  presenter?: BizFormPresenter;\n  mode: FormMode;\n  id?: string;\n}\n\nexport class BizForm extends React.Component<IBizForm, any> {\n  constructor (props: IBizForm) {\n    super(props);\n    this.state = {\n      loadingStatus: LoadingStatus.Loading\n    };\n    // this.presenter.mode = this.props.mode;\n    this.presenter.id = this.props.id;\n  }\n\n  componentDidMount () {\n    // 获取metadata、tempalte数据， 以后修改\n    // this.getInitData();\n    this.init();\n  }\n\n  componentWillUnmount () {\n    this.presenter.destructor();\n  }\n\n  // 初始化数据\n  private init = () => {\n    this.presenter.initData();\n    this.presenter.getModule(ModuleNames.EventModule).on(LifecycleEvent.onFormInitialized, this.onFormInitialized);\n    this.presenter.getModule(ModuleNames.EventModule).on(LifecycleEvent.reloadBizForm, this.reload);\n  };\n\n  // 重新加载数据\n  public reload = () => {\n    this.setState({\n      loadingStatus: LoadingStatus.Loading\n    });\n    this.init();\n  };\n\n  onFormInitialized = async () => {\n    try {\n      this.setState({\n        loadingStatus: LoadingStatus.Complete\n      });\n    } catch (err) {\n      console.error(err);\n      this.setState({\n        loadingStatus: LoadingStatus.Failed\n      });\n    }\n  };\n\n  render () {\n    return (\n      <PresenterProvider value={this.presenter}>\n        <LoadingContainer status={this.state.loadingStatus}>{this.renderContent}</LoadingContainer>\n      </PresenterProvider>\n    );\n  }\n\n  renderContent = () => {\n    if (this.state.loadingStatus === LoadingStatus.Complete) {\n      return <BizFormBody presenter={this.presenter} />;\n    }\n    return null;\n  };\n\n  get presenter () {\n    return this.props.presenter;\n  }\n}\n","import {BizForm} from '@src/bizForm/bizForm';\nimport {BizFormPresenter} from '@src/bizForm/bizFormPresenter';\nimport {FormMode} from '@src/bizForm/formMode';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {Modals} from '@src/components/Modals';\nimport {Modal} from 'antd';\nimport React from 'react';\n\nexport interface IViewModal {\n  entityName: string;\n  id: string;\n  onOk: () => void;\n  onCancel: () => void;\n}\nexport class ViewModal extends React.Component<IViewModal> {\n  private presenter: BizFormPresenter;\n  private prevHistoryUrl: string;\n\n  constructor (props: IViewModal) {\n    super(props);\n    this.prevHistoryUrl = window.location.pathname;\n    window.history.replaceState(null, '', `/${ this.props.entityName }/${ FormMode.View }/${ this.props.id }`);\n    this.presenter = new BizFormPresenter({\n      entityName: this.props.entityName,\n      mode: FormMode.View\n    });\n  }\n\n  componentWillUnmount () {}\n\n  private resetPathname = () => {\n    window.history.replaceState(null, '', this.prevHistoryUrl);\n  };\n\n  private onCancel = () => {\n    this.resetPathname();\n    // eslint-disable-next-line no-unused-expressions\n    this.props.onCancel && this.props.onCancel();\n  };\n\n  render () {\n    return (\n      <Modal\n        title={this.presenter.initFormData.name}\n        {...this.props}\n        width={'90%'}\n        footer={null}\n        onCancel={this.onCancel}\n      >\n        <div style={{padding: '24px'}}>\n          <BizForm presenter={this.presenter} mode={FormMode.View} id={this.props.id} />\n        </div>\n      </Modal>\n    );\n  }\n}\n\n/**\n * 列表行使用\n */\nexport const ViewAction = {\n  key: 'view',\n  label: '查看',\n  options: {\n    onClick: (presenter: BizListPresenter, data: any) => {\n      Modals.show(ViewModal, {\n        entityName: presenter.entityName,\n        id: data.id\n      });\n    }\n  }\n};\n","import {fetchFormAction} from '@src/http/formData';\n\nexport default class FormUtils {\n  // 将字符串首字母转为小写\n  static FormAction (entityName: string, action: string, data: any) {\n    return fetchFormAction({\n      entityName,\n      action,\n      data\n    });\n  }\n\n  static async FormActionDelete (entityName: string, id: string) {\n    const result = await FormUtils.FormAction(entityName, 'delete', id);\n    return result;\n  }\n}\n","import {LifecycleEvent} from '@src/bizForm/lifecycleEvent';\nimport {ModuleNames} from '@src/bizForm/modules/interface';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {TDeleteResponse} from '@src/interfaces/response';\nimport FormUtils from '@src/utils/formUtils';\nimport {message} from 'antd';\n\nexport const DeleteAction = {\n  key: 'delete',\n  label: '删除',\n  options: {\n    confirm: true,\n    onClick: async (presenter: BizListPresenter, data: any) => {\n      try {\n        const result = (await FormUtils.FormActionDelete(presenter.entityName, data.id)) as TDeleteResponse;\n        if (result.data) {\n          presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.queryListData);\n        } else {\n          message.error(result.errMsg);\n        }\n      } catch (err) {\n        message.error(err);\n      }\n    }\n  }\n};\n","import {EditAction} from './EditAction';\nimport {ViewAction} from './ViewAction';\nimport {DeleteAction} from './DeleteAction';\n\nexport default {\n  ViewAction,\n  EditAction,\n  DeleteAction\n};\n\nexport const DefaultListRowActions = [ ViewAction, EditAction, DeleteAction ];\n","import {BaseBizActionManager} from './baseBizActionManager';\nimport {DefaultListRowActions} from './listRowActions';\n\nexport class BizListRowActionManager<T> extends BaseBizActionManager<T> {\n  defaultActions = [ ...DefaultListRowActions ];\n}\n","import {autobind} from 'core-decorators';\nimport {LoadingStatus} from '@src/components/LoadingContainer';\nimport {observable} from 'mobx';\nimport {ModuleManager} from '@src/bizForm/modules/moduleManager';\nimport {ModuleNames} from '@src/bizForm/modules/interface';\nimport {LifecycleEvent} from '@src/bizForm/lifecycleEvent';\nimport {EventModule} from '@src/bizForm/modules';\nimport {ListInitiModule} from '@src/bizForm/modules/listInitiModule';\nimport {BizListModel} from './core/bizList';\nimport {IQuerySchema} from '@src/interfaces/queryScheme';\nimport {IQueryColumn} from '@src/interfaces/queryColumn';\nimport {QuerySolution} from './core/querySolution';\nimport {ListDataLoader} from '@src/http/listDataLoader';\nimport {ListModule} from '@src/bizForm/modules/listModule';\nimport {BizListConfig, ListData} from './interface';\nimport {BizListActionManager} from '@src/bizAction/bizListActionManager';\nimport {BizListRowActionManager} from '@src/bizAction/bizListRowActionManager';\n\nexport interface IBizFormPresenterOptions {\n  entityName: string;\n}\n\n@autobind\nexport class BizListPresenter<T = any> {\n  [x: string]: any;\n  // 元数据\n  public queryColumn: IQueryColumn;\n\n  // 模板数据\n  public querySchema: IQuerySchema;\n\n  public querySolution: QuerySolution;\n\n  public entityName: string;\n\n  public model: BizListModel;\n\n  public dataLoader: ListDataLoader;\n  //\n  public listData: ListData = {\n    data: [],\n    count: 0,\n    pageNo: 1,\n    pageSize: 20, // 默认分页10条\n    hasNextPage: false\n  };\n\n  public config: BizListConfig<T>;\n\n  @observable\n  public loadingStatus: LoadingStatus = LoadingStatus.None;\n\n  // 模块管理属性\n  public modules: ModuleManager;\n  presenter: any;\n\n  public getModule (moduleName: string) {\n    return this.modules.get(moduleName);\n  }\n\n  // 获取所有master的字段属性的数组, logicPath 字段的所属路径前缀\n  public getFields (logicPath: string) {\n    // return this.model.fields.filter(field => field.path.startsWith(logicPath));\n  }\n\n  constructor (public readonly options: IBizFormPresenterOptions) {\n    this.entityName = options.entityName;\n    // this.initData();\n    // this.config = this._listBizConfig();\n    this.config = this._listBizConfig();\n  }\n\n  public initData = () => {\n    this.initModules();\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.onLoadedListInitData, this.initList);\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.afterSave, this.afterSave);\n    this.getModule(ModuleNames.EventModule).on(LifecycleEvent.onLoadedListData, this.loadListData);\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onModuleReady);\n  };\n\n  private initModules = () => {\n    this.modules = new ModuleManager({\n      seeds: {\n        [ ModuleNames.Presenter ]: this\n      },\n      modules: [ EventModule, ListInitiModule, ListModule ],\n      presenter: this\n    });\n  };\n\n  // // 初始化BizListMode数据\n  public initList () {\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onListInitialized);\n    this.loadingStatus = LoadingStatus.Complete;\n    // this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onLoadedListData);\n  }\n\n  private async loadListData () {\n    try {\n      this.loadingStatus = LoadingStatus.Complete;\n    } catch (err) {\n      this.loadingStatus = LoadingStatus.Failed;\n    }\n  }\n\n  private afterSave (id: string) {\n    // RouteUtils.toForm({\n    //   entityName: this.entityName,\n    //   mode: FormMode.View,\n    //   id,\n    // })\n  }\n\n  // start 生命周期\n  public onBeforeSave (data: any) {\n    return data;\n  }\n\n  // end 生命周期\n\n  public save () {\n    this.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onSave);\n  }\n\n  // 列表配置项\n  /**\n   * {\n   *  path: {\n   *     cellRender: (val, record) => ReactNode\n   *\n   *  }\n   * }\n   */\n  public listBizConfig (config: BizListConfig<T>): BizListConfig<T> {\n    // const listConfig = new ListConfig();\n    return config;\n  }\n\n  private _listBizConfig (): BizListConfig<T> {\n    const defaultConfig: BizListConfig<T> = {\n      listActionManager: new BizListActionManager(),\n      listRowActionManager: new BizListRowActionManager()\n    };\n    return this.listBizConfig(defaultConfig);\n  }\n}\n","import { BizListPresenter } from \"@src/bizList/bizListPresenter\";\n// import { ListConfig } from \"@src/bizList/interface\";\n\n\nexport class ProductListPresenter extends BizListPresenter {\n\n    // public listConfig(): ListConfig {\n    //     return {\n    //         \"name\": {\n    //             cellRender: (val) => {\n    //                 return <span style={{color: 'red'}}>{val}</span>\n    //             }\n    //         }\n    //     }\n    // }\n    \n}","import * as React from 'react';\nimport {RouterProps} from 'react-router';\nimport {BizForm} from '../bizForm/bizForm';\nimport {BizFormPresenter, IBizFormPresenterOptions} from '../bizForm/bizFormPresenter';\nimport {FormMode} from '../bizForm/formMode';\nimport _get from 'lodash/get';\nimport {Observer} from 'mobx-react';\n\n// 通过业务对象生成对应的表单路由\ninterface IBizFormRoute {\n  entityName: string;\n  createPresenter: (options?: any) => BizFormPresenter;\n}\nexport const bizFormRoute = (options: IBizFormRoute) => {\n  const {entityName, createPresenter} = options;\n  const routes = [\n    {\n      exact: true,\n      sensitive: true,\n      path: `/${ entityName }/${ FormMode.View }/:formId`,\n      mode: FormMode.View\n    },\n    {\n      exact: true,\n      sensitive: true,\n      path: `/${ entityName }/${ FormMode.Copy }/:formId`,\n      mode: FormMode.Copy\n    },\n    {\n      exact: true,\n      sensitive: true,\n      path: `/${ entityName }/${ FormMode.Edit }/:formId`,\n      mode: FormMode.Edit\n    },\n    {\n      exact: true,\n      sensitive: true,\n      path: `/${ entityName }/${ FormMode.Create }`,\n      mode: FormMode.Create\n    }\n  ];\n\n  return routes.map((route) => ({\n    ...route,\n    render: (props?: any) => {\n      return (\n        <Observer>\n          {() => (\n            <BizForm\n              key={route.path}\n              id={_get(props, 'match.params.formId')}\n              mode={route.mode}\n              presenter={\n                createPresenter({\n                  ...options,\n                  mode: route.mode\n                }) as any\n              }\n            ></BizForm>\n          )}\n        </Observer>\n      );\n    }\n  }));\n};\n","import { BizListPresenter } from '@src/bizList/bizListPresenter';\nimport {Button, Popconfirm} from 'antd';\nimport * as React from 'react';\nimport { IBizAction } from '../interface';\nimport styles from './style.module.scss';\n\nfunction BizAction (props: IBizAction & {presenter: BizListPresenter, data: any}) {\n  const {label, options, presenter, data} = props;\n\n  if (options.confirm) {\n    return (\n      <Popconfirm\n        title={`是否确认 “${ label }”`}\n        onConfirm={() => options.onClick && options.onClick(presenter, data)}\n        okText=\"确定\"\n        cancelText=\"取消\"\n      >\n        <Button type=\"link\" style={{marginRight: '8px'}} size=\"small\" {...options} onClick={() => {}}>\n          {label}\n        </Button>\n      </Popconfirm>\n    );\n  }\n\n  return (\n    <Button\n      type=\"link\"\n      style={{marginRight: '8px'}}\n      size=\"small\"\n      {...options}\n      onClick={() => options.onClick && options.onClick(presenter, data)}\n    >\n      {label}\n    </Button>\n  );\n}\n\ninterface ListRowActionBarProps {\n  presenter: BizListPresenter;\n  data: any;\n}\n\nexport class ListRowActionBar extends React.Component<ListRowActionBarProps> {\n  render () {\n    const {presenter, data} = this.props;\n    const actions = presenter.config.listRowActionManager.execute(data)\n    return (\n      <div className={styles[ 'actionbar' ]}>\n        {actions.map((action) => (\n          <BizAction key={action.key} presenter={presenter} data={data} {...action} />\n        ))}\n      </div>\n    );\n  }\n}\n","import {EntityFieldViewer} from '@src/bizForm/components/EntityFieldViewer';\n// import {RowActionBar} from '@src/components/RowActionBar';\nimport {Table} from 'antd';\nimport {toJS} from 'mobx';\nimport {Observer} from 'mobx-react-lite';\nimport * as React from 'react';\nimport {BizListPresenter} from './bizListPresenter';\nimport _get from 'lodash/get';\n\nimport {BizColumn} from './core/bizList';\nimport {ModuleNames} from '@src/bizForm/modules/interface';\nimport './style/index.scss';\nimport {ColumnsType} from 'antd/lib/table';\nimport {RenderedCell} from 'rc-table/lib/interface';\nimport {LifecycleEvent} from '@src/bizForm/lifecycleEvent';\nimport {ListRowActionBar} from '@src/bizAction/ActionBar/ListRowActionBar';\n\ninterface IBizListBody {\n  presenter: BizListPresenter;\n}\n/**\n * 用于渲染table\n */\nexport class BizListBody extends React.Component<IBizListBody> {\n  componentDidMount () {\n    // this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.onFormCreated);\n  }\n\n  getCellRender = (col: BizColumn) => {\n    const cellRender = _get(this.props.presenter.config, `${ col.path }.cellRender`) as unknown as (\n      value: any,\n      record: any,\n      index: number,\n    ) => React.ReactNode | RenderedCell<any>;\n    return cellRender ?\n      cellRender :\n      (value: any) => <EntityFieldViewer entityName={this.props.presenter.entityName} value={value} {...col} />;\n  };\n\n  getColumns (): ColumnsType<any> {\n    return [\n      ...this.props.presenter.model.columns.map((col) => ({\n        ...col,\n        dataIndex: col.path.split('.'), // antd table  支持string | string[]\n        ellipsis: {\n          showTitle: true\n        },\n        scroll: {\n          x: true\n        },\n        width: 200,\n        render: this.getCellRender(col)\n      })),\n      {\n        title: '操作',\n        fixed: 'right',\n        width: 100,\n        render: (_: any, item: any, index: number) => {\n          return <ListRowActionBar presenter={this.props.presenter} data={item} />;\n        }\n      }\n    ];\n  }\n\n  render () {\n    return this.renderContent();\n  }\n\n  renderContent = () => {\n    const {presenter} = this.props;\n    if (!presenter.querySchema) {\n      return null;\n    }\n    return (\n      <Observer>\n        {() => (\n          <Table\n            className={'bizList-table'}\n            size=\"small\"\n            rowKey=\"id\"\n            rowSelection={this.getRowSelection()}\n            columns={this.getColumns()}\n            dataSource={toJS(presenter.listData.data)}\n            scroll={{x: true}}\n            bordered\n            pagination={{\n              current: presenter.listData.pageNo,\n              total: presenter.listData.count,\n              pageSize: presenter.listData.pageSize,\n              showQuickJumper: true,\n              showSizeChanger: true,\n              onChange: this.handlePageChange\n            }}\n          />\n        )}\n      </Observer>\n    );\n  };\n\n  private onSelectChange = (selectedRowKeys: string[], selectedRows: []) => {\n    this.props.presenter.getModule(ModuleNames.ListModule).setSelectedRowKeys(selectedRowKeys);\n    this.forceUpdate();\n  };\n\n  private getRowSelection = (): any => {\n    const keys = this.props.presenter.getModule(ModuleNames.ListModule).getSelectedRowKeys();\n    return {\n      selectedRowKeys: keys,\n      onChange: this.onSelectChange,\n      fixed: true\n    };\n  };\n\n  private query = () => {\n    this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.queryListData);\n  };\n\n  private handlePageChange = (page: number, pageSize?: number) => {\n    this.props.presenter.listData.pageSize = pageSize;\n    this.props.presenter.listData.pageNo = page;\n\n    this.query();\n  };\n}\n","import {IBizAction} from '@src/bizAction/interface';\nimport {Button} from 'antd';\nimport {observer} from 'mobx-react';\nimport * as React from 'react';\nimport { BizListPresenter } from '../../bizList/bizListPresenter';\n\nexport interface ListActionBarProps {\n  presenter: BizListPresenter;\n}\n\n@observer\nexport class ListActionBar extends React.Component<ListActionBarProps> {\n  render () {\n    const {presenter} = this.props;\n    const actions = presenter.config.listActionManager.execute()\n    return (\n      <div>\n        {actions.map((action) => (\n          <BizAction key={action.key} presenter={presenter} {...action} />\n        ))}\n      </div>\n    );\n  }\n}\n\nfunction BizAction (props: IBizAction & {presenter: any}) {\n  const {label, options, presenter} = props;\n  return (\n    <Button\n      style={{marginLeft: '8px'}}\n      size=\"small\"\n      {...options}\n      onClick={() => options.onClick && options.onClick(presenter)}\n    >\n      {label}\n    </Button>\n  );\n}\n","\n// 邮件类型\nenum ENUM_EmailType {\n    \n      // 普通邮件\n      Normal = \"EmailType.normal\",\n    \n      // 模版邮件\n      Template = \"EmailType.template\",\n    \n}\nexport default ENUM_EmailType;\n","import {ListActionBar} from '@src/bizAction/ActionBar/ListActionBar';\nimport { metadata } from '@src/metadata/metadata';\nimport * as React from 'react';\nimport {BizListPresenter} from '../bizListPresenter';\n\nimport style from './style.module.scss';\n\ninterface IBizListHeader {\n  presenter: BizListPresenter;\n}\n/**\n * 用于渲染table\n */\nexport class BizListHeader extends React.Component<IBizListHeader> {\n  componentDidMount () {}\n\n  render () {\n    const {presenter} = this.props;\n    return (\n      <div className={style[ 'biz-list-header' ]}>\n        <div >\n          <h3 className={style[ 'biz-list-header-title' ]}>{metadata.getEntity(presenter.entityName).title}列表 </h3>\n        </div>\n        {this.renderActions()}\n      </div>\n    );\n  }\n\n  renderActions = () => {\n    return <ListActionBar presenter={this.props.presenter} />;\n  };\n}\n","import {getQuerySchemaInput} from '@src/bizForm/components/QueryValueType';\nimport {ValueType} from '@src/bizForm/components/QueryValueType/valueTypeMaps';\nimport {LifecycleEvent} from '@src/bizForm/lifecycleEvent';\nimport {ModuleNames} from '@src/bizForm/modules/moduleNames';\nimport {IQuerySchemaItem} from '@src/interfaces/queryScheme';\nimport {FieldPathUtils} from '@src/utils/fieldPath';\nimport {ValueTypeUtils} from '@src/utils/valueTypeUtils';\nimport {Col, Form, Row, Input, Button} from 'antd';\nimport {observer} from 'mobx-react';\nimport * as React from 'react';\nimport {BizListPresenter} from '../bizListPresenter';\nimport style from './style.module.scss';\n\nexport interface IQuickQuery {\n  presenter: BizListPresenter;\n}\n\n// 快捷查询\n@observer\nexport class QuickQuery extends React.Component<IQuickQuery> {\n  private getQueryItems = () => {\n    const {presenter} = this.props;\n    return presenter.querySchema?.items.filter((item) => item.isQuickQuery) || [];\n  };\n\n  private query = () => {\n    this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.queryListData);\n  };\n\n  private reset = () => {\n    this.props.presenter.getModule(ModuleNames.EventModule).dispatch(LifecycleEvent.resetQueryListSolutionValues);\n  };\n\n  private getBizType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.presenter.entityName, item.path);\n    return pathInfo.bizType;\n  };\n\n  getEnumType = (item: IQuerySchemaItem) => {\n    const pathInfo = FieldPathUtils.getPathInfo(this.props.presenter.entityName, item.path);\n    if (pathInfo.bizType === 'enum') {\n      return pathInfo.enumType;\n    }\n    return undefined;\n  };\n\n  render () {\n    if (!this.getQueryItems().length) {\n      return null;\n    }\n    return (\n      <div className={style[ 'quick-query' ]}>\n        <Row gutter={[ 16, 16 ]}>\n          {this.renderItems()}\n          <Col span={6}>\n            <div className={style[ 'quick-query-item' ]}>\n              <div className={style[ 'quick-query-actions' ]}>\n                <Button type=\"primary\" onClick={this.query}>\n                  查询\n                </Button>\n                <Button type=\"primary\" onClick={this.reset}>\n                  重置\n                </Button>\n              </div>\n            </div>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n\n  renderItems = () => {\n    const {presenter} = this.props;\n    const items = this.getQueryItems();\n    return items.map((item) => {\n      const querySolutionItem = presenter.querySolution.getByPath(item.path);\n      const bizType = this.getBizType(item);\n      const Comp = getQuerySchemaInput(bizType, querySolutionItem.valueType) as any;\n      const value = ValueTypeUtils.isMutil(querySolutionItem.valueType) ?\n        querySolutionItem.values :\n        querySolutionItem.values[ 0 ];\n      const props = {\n        value: value,\n        fieldName: item.path,\n        entityName: presenter.entityName,\n        querySchemaItems: items,\n        onChange: querySolutionItem.updateValues,\n        isMutil: [ ValueType.in, ValueType.nin ].includes(querySolutionItem.valueType),\n        enumName: this.getEnumType(item)\n      };\n      return (\n        <Col span={6} key={item.path}>\n          <div className={style[ 'quick-query-item' ]}>\n            <div className={style[ 'quick-query-item-label' ]}>{item.displayName}</div>\n            <div className={style[ 'quick-query-item-body' ]}>\n              <Comp {...props} />\n            </div>\n          </div>\n        </Col>\n      );\n    });\n  };\n}\n","import {PresenterProvider} from '@src/bizForm/context/bizFormContext';\nimport {LifecycleEvent} from '@src/bizForm/lifecycleEvent';\nimport {ModuleNames} from '@src/bizForm/modules/moduleNames';\nimport LoadingContainer, {LoadingStatus} from '@src/components/LoadingContainer';\nimport * as React from 'react';\nimport {BizListBody} from './bizlistBody';\nimport {BizListHeader} from './bizlistHeader';\nimport {BizListPresenter} from './bizListPresenter';\nimport {QuickQuery} from './QuickQuery';\n\ninterface IBizForm {\n  presenter?: BizListPresenter;\n}\n\nexport class BizList extends React.Component<IBizForm, any> {\n  constructor (props: IBizForm) {\n    super(props);\n    this.state = {\n      loadingStatus: LoadingStatus.Loading\n    };\n  }\n\n  componentDidMount () {\n    // TODO: 获取metadata、tempalte数据， 以后修改\n    // this.getInitData();\n    this.presenter.initData();\n    this.presenter.getModule(ModuleNames.EventModule).on(LifecycleEvent.onListInitialized, this.onListInitialized);\n  }\n\n  onListInitialized = async () => {\n    try {\n      this.setState({\n        loadingStatus: LoadingStatus.Complete\n      });\n    } catch (err) {\n      console.error(err);\n      this.setState({\n        loadingStatus: LoadingStatus.Failed\n      });\n    }\n  };\n\n  render () {\n    return (\n      <PresenterProvider value={this.presenter}>\n        <LoadingContainer status={this.state.loadingStatus}>{this.renderContent}</LoadingContainer>\n      </PresenterProvider>\n    );\n  }\n\n  renderContent = () => {\n    if (this.state.loadingStatus === LoadingStatus.Complete) {\n      return (\n        <div>\n          <BizListHeader presenter={this.presenter} />\n          <QuickQuery presenter={this.presenter} />\n          <BizListBody presenter={this.presenter} />\n        </div>\n      );\n    }\n    return null;\n  };\n\n  get presenter () {\n    return this.props.presenter;\n  }\n}\n","import * as React from 'react';\nimport {FormMode} from '../bizForm/formMode';\nimport _get from 'lodash/get';\nimport {BizList} from '@src/bizList/bizList';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\n\n// 通过业务对象生成对应的表单路由\ninterface IBizListRoute {\n  entityName: string;\n  path?: string;\n  createPresenter: (options?: any) => BizListPresenter;\n}\nexport const bizListRouter = (options: IBizListRoute) => {\n  const {entityName, createPresenter, path} = options;\n  const routes = [\n    {\n      exact: true,\n      sensitive: true,\n      path: path ? path : `/${ entityName }-list`,\n      mode: FormMode.View\n    }\n  ];\n\n  return routes.map((route) => ({\n    ...route,\n    render: (props?: any) => {\n      return <BizList key={route.path} presenter={createPresenter(options) as any}></BizList>;\n    }\n  }));\n};\n","import { ProductFormPresenter, ProductListPresenter } from \"@src/pages/product\";\nimport { bizFormRoute } from \"../bizFormRouter\";\nimport { bizListRouter } from \"../bizListRouter\";\n\nexport default [\n  ...bizFormRoute({\n    entityName: \"Product\",\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new ProductFormPresenter(options);\n    },\n  }),\n  ...bizListRouter({\n    entityName: \"Product\",\n    createPresenter: (options: any) => {\n      return new ProductListPresenter(options);\n    },\n  })\n];\n","import { BizFormPresenter } from \"../../bizForm/bizFormPresenter\";\n\n\nexport class OrderFormPresenter extends BizFormPresenter {\n\n    \n    \n}","/*\n * File: product copy.ts\n * Project: biz-form\n * File Created: Tuesday, 6th July 2021 11:05:53 pm\n * Author: zxtang (1061225829@qq.com)\n * -----\n * Last Modified: Tuesday, 6th July 2021 11:05:53 pm\n * Modified By: zxtang (1061225829@qq.com>)\n * -----\n * Copyright 2017 - 2021 Your Company, Your Company\n */\nimport { OrderFormPresenter } from \"@src/pages/order/orderFormPresenter\";\nimport { bizFormRoute } from \"../bizFormRouter\";\n\nexport default [\n  ...bizFormRoute({\n    entityName: \"Order\",\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new OrderFormPresenter(options);\n    },\n  }),\n];\n","import EN_Article from '@packages/gen/types/entities/Article';\nimport {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport {autobind} from 'core-decorators';\nimport {reaction} from 'mobx';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class ArticleFormPresenter extends BizFormPresenter<EN_Article> {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    // disposers.push(\n    //     reaction(\n    //         () => form.select(\"category\").value,\n    //         (value) => {\n    //             form.select(\"name\").disabled = true;\n    //         }\n    //     )\n    // )\n  }\n}\n","import EN_Article from '@packages/gen/types/entities/Article';\nimport {IBizAction} from '@src/bizAction/interface';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {BizListConfig} from '@src/bizList/interface';\n\nexport class ArticleListPresenter<T = EN_Article> extends BizListPresenter<T> {\n  public listBizConfig (config: BizListConfig<T>): BizListConfig<T> {\n    config.column = {\n      name: {\n        cellRender: (val) => {\n          return <span style={{color: 'red'}}>{val}</span>;\n        }\n      }\n    };\n\n    config.listRowActionManager.use((actions: Array<IBizAction>, data: any): Array<IBizAction> => {\n      // if (data.id === 'db56a548-b6f8-4bd4-8886-051dcde9858b') {\n      //   return [];\n      // }\n      return actions;\n    });\n    return config;\n  }\n}\n","import { ArticleFormPresenter, ArticleListPresenter } from \"@src/pages/article\";\nimport { bizFormRoute } from \"../bizFormRouter\";\nimport { bizListRouter } from \"../bizListRouter\";\n\nexport default [\n  ...bizFormRoute({\n    entityName: \"Article\",\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new ArticleFormPresenter(options);\n    },\n  }),\n  ...bizListRouter({\n    entityName: \"Article\",\n    createPresenter: (options: any) => {\n      return new ArticleListPresenter(options);\n    },\n  })\n];\n","\nimport EN_Category from '@packages/gen/types/entities/Category';\nimport {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport {autobind} from 'core-decorators';\nimport {reaction} from 'mobx';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class CategoryFormPresenter extends BizFormPresenter<EN_Category> {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    // disposers.push(\n    //     reaction(\n    //         () => form.select(\"category\").value,\n    //         (value) => {\n    //             form.select(\"name\").disabled = true;\n    //         }\n    //     )\n    // )\n    \n  }\n}\n","import EN_Category from '@packages/gen/types/entities/Category';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\n\nexport class CategoryListPresenter<T = EN_Category> extends BizListPresenter<T> {\n  // public listBizConfig (config: BizListConfig<T>): BizListConfig<T> {\n  //   config.column = {\n  //     name: {\n  //       cellRender: (val) => {\n  //         return <span style={{color: 'red'}}>{val}</span>;\n  //       }\n  //     }\n  //   };\n\n  //   config.listRowActionManager.use((actions: Array<IBizAction>, data: any): Array<IBizAction> => {\n  //     // if (data.id === 'db56a548-b6f8-4bd4-8886-051dcde9858b') {\n  //     //   return [];\n  //     // }\n  //     return actions;\n  //   });\n  //   return config;\n  // }\n}\n","import { CategoryFormPresenter, CategoryListPresenter } from \"@src/pages/category\";\nimport { bizFormRoute } from \"../bizFormRouter\";\nimport { bizListRouter } from \"../bizListRouter\";\n\nexport default [\n  ...bizFormRoute({\n    entityName: \"Category\",\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new CategoryFormPresenter(options);\n    },\n  }),\n  ...bizListRouter({\n    entityName: \"Category\",\n    createPresenter: (options: any) => {\n      return new CategoryListPresenter(options);\n    },\n  })\n];\n","import EN_Template from '@packages/gen/types/entities/Template';\nimport {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport {autobind} from 'core-decorators';\nimport {reaction} from 'mobx';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class TemplateFormPresenter extends BizFormPresenter<EN_Template> {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    // disposers.push(\n    //     reaction(\n    //         () => form.select(\"category\").value,\n    //         (value) => {\n    //             form.select(\"name\").disabled = true;\n    //         }\n    //     )\n    // )\n  }\n}\n","import EN_Template from '@packages/gen/types/entities/Template';\nimport {IBizAction} from '@src/bizAction/interface';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {BizListConfig} from '@src/bizList/interface';\n\nexport class TemplateListPresenter<T = EN_Template> extends BizListPresenter<T> {\n  public listBizConfig (config: BizListConfig<T>): BizListConfig<T> {\n    config.column = {\n      name: {\n        cellRender: (val) => {\n          return <span style={{color: 'red'}}>{val}</span>;\n        }\n      }\n    };\n\n    config.listRowActionManager.use((actions: Array<IBizAction>, data: any): Array<IBizAction> => {\n      // if (data.id === 'db56a548-b6f8-4bd4-8886-051dcde9858b') {\n      //   return [];\n      // }\n      return actions;\n    });\n    return config;\n  }\n}\n","import {TemplateFormPresenter, TemplateListPresenter} from '@src/pages/template';\nimport {bizFormRoute} from '../bizFormRouter';\nimport {bizListRouter} from '../bizListRouter';\n\nexport default [\n  ...bizFormRoute({\n    entityName: 'Template',\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new TemplateFormPresenter(options);\n    }\n  }),\n  ...bizListRouter({\n    entityName: 'Template',\n    createPresenter: (options: any) => {\n      return new TemplateListPresenter(options);\n    }\n  })\n];\n","\n\n  // 文章\n  export const ENUM_Entity_Article = \"Article\";\n\n  // 分类\n  export const ENUM_Entity_Category = \"Category\";\n\n  // 评论\n  export const ENUM_Entity_Comment = \"Comment\";\n\n  // 邮件\n  export const ENUM_Entity_Email = \"Email\";\n\n  // 文件\n  export const ENUM_Entity_File = \"File\";\n\n  // 商户\n  export const ENUM_Entity_Merchant = \"Merchant\";\n\n  // 对象类型\n  export const ENUM_Entity_ObjectType = \"ObjectType\";\n\n  // 用户\n  export const ENUM_Entity_Operator = \"Operator\";\n\n  // 订单\n  export const ENUM_Entity_Order = \"Order\";\n\n  // 产品\n  export const ENUM_Entity_Product = \"Product\";\n\n  // sku\n  export const ENUM_Entity_Sku = \"Sku\";\n\n  // 模版\n  export const ENUM_Entity_Template = \"Template\";\n\n  // 站点\n  export const ENUM_Entity_Website = \"Website\";\n\n  // 工作流程\n  export const ENUM_Entity_Workflow = \"Workflow\";\n\n  // 工作流程明细\n  export const ENUM_Entity_WorkflowItem = \"WorkflowItem\";\n\n","import EN_Email from '@packages/gen/types/entities/Email';\nimport ENUM_EmailType from '@packages/gen/types/enums/EmailType';\nimport {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport {autobind} from 'core-decorators';\nimport {reaction, runInAction} from 'mobx';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class EmailFormPresenter extends BizFormPresenter<EN_Email> {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    disposers.push(\n      reaction(\n        () => form.select('type').value,\n        (value) => {\n          // 普通类型时不能选择模版\n          if (value === ENUM_EmailType.Normal) {\n            runInAction(() => {\n              form.select('template').disabled = true;\n              form.select('template').value = undefined;\n              // \n              form.select('content').disabled = false;\n            });\n          } else {\n            runInAction(() => {\n              form.select('template').disabled = false;\n              form.select('content').disabled = true;\n              form.select('content').value = undefined;\n            });\n          }\n        },\n      ),\n    );\n  }\n}\n","import EN_Email from '@packages/gen/types/entities/Email';\nimport {IBizAction} from '@src/bizAction/interface';\nimport {BizListPresenter} from '@src/bizList/bizListPresenter';\nimport {BizListConfig} from '@src/bizList/interface';\n\nexport class EmailListPresenter<T = EN_Email> extends BizListPresenter<T> {\n  public listBizConfig (config: BizListConfig<T>): BizListConfig<T> {\n    config.column = {\n      name: {\n        cellRender: (val) => {\n          return <span style={{color: 'red'}}>{val}</span>;\n        }\n      }\n    };\n\n    config.listRowActionManager.use((actions: Array<IBizAction>, data: any): Array<IBizAction> => {\n      // if (data.id === 'db56a548-b6f8-4bd4-8886-051dcde9858b') {\n      //   return [];\n      // }\n      return actions;\n    });\n    return config;\n  }\n}\n","import { ENUM_Entity_Email } from '@packages/gen/constants/enums/entityName';\nimport {EmailFormPresenter, EmailListPresenter} from '@src/pages/email';\nimport {bizFormRoute} from '../bizFormRouter';\nimport {bizListRouter} from '../bizListRouter';\n\nexport default [\n  ...bizFormRoute({\n    entityName: ENUM_Entity_Email,\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new EmailFormPresenter(options);\n    }\n  }),\n  ...bizListRouter({\n    entityName: ENUM_Entity_Email,\n    createPresenter: (options: any) => {\n      return new EmailListPresenter(options);\n    }\n  })\n];\n","import {IDisposer} from '@src/MST-Form/interface';\nimport {MSTForm} from '@src/MST-Form/MSTForm';\nimport {autobind} from 'core-decorators';\nimport {BizFormPresenter} from '../../bizForm/bizFormPresenter';\n\n@autobind\nexport class FileFormPresenter extends BizFormPresenter {\n  public onFormCreated (form: MSTForm, disposers: IDisposer[]) {\n    // disposers.push(\n    //     reaction(\n    //         () => form.select(\"category\").value,\n    //         (value) => {\n    //             form.select(\"name\").disabled = !form.select(\"name\").disabled;\n    //         }\n    //     )\n    // )\n    // this.form.addValidator(\"name\", (field: MSTFormField) => {\n    //   if (field.value === \"123\") {\n    //     return \"123 ---\";\n    //   }\n    //   return \"\";\n    // })\n  }\n\n  private addValidators = (form: MSTForm) => {\n    \n  }\n}\n","import { BizListPresenter } from \"@src/bizList/bizListPresenter\";\n// import { ListConfig } from \"@src/bizList/interface\";\n\n\nexport class FileListPresenter extends BizListPresenter {\n\n    // public listConfig(): ListConfig {\n    //     return {\n    //         \"name\": {\n    //             cellRender: (val) => {\n    //                 return <span style={{color: 'red'}}>{val}</span>\n    //             }\n    //         }\n    //     }\n    // }\n    \n}","import { ENUM_Entity_File } from \"@packages/gen/constants/enums/entityName\";\nimport { FileFormPresenter, FileListPresenter } from \"@src/pages/file\";\nimport { bizFormRoute } from \"../bizFormRouter\";\nimport { bizListRouter } from \"../bizListRouter\";\n\nexport default [\n  ...bizFormRoute({\n    entityName: ENUM_Entity_File,\n    createPresenter: (options: any) => {\n      // const { ProductFormPresenter } = await import(\n      //   \"@src/pages/product/productFormPresenter\"\n      // );\n      // return new ProductFormPresenter(options);\n\n      return new FileFormPresenter(options);\n    },\n  }),\n  ...bizListRouter({\n    entityName: ENUM_Entity_File,\n    createPresenter: (options: any) => {\n      return new FileListPresenter(options);\n    },\n  })\n];\n","import React from 'react';\nimport {Route} from 'react-router';\nimport productRoutes from './product';\nimport orderRoutes from './order';\nimport articleRoutes from './article';\nimport categoryRoutes from './category';\nimport templateRoutes from './template';\nimport emailRoutes from './email';\nimport fileRoutes from './file';\n\nconst CustomeRoutes = [\n  ...productRoutes,\n  ...orderRoutes,\n  ...articleRoutes,\n  ...categoryRoutes,\n  ...templateRoutes,\n  ...emailRoutes,\n  ...fileRoutes,\n].map((item) => <Route {...item} key={item.path}></Route>);\n\nexport default CustomeRoutes;\n","import * as React from 'react';\nimport {Switch} from 'react-router-dom';\nimport BaseRoutes from './baseRoutes';\nimport CustomeRoutes from './customeRoutes';\n\nexport default function AppRouter () {\n  return (\n    <Switch>\n      {BaseRoutes}\n      {CustomeRoutes}\n    </Switch>\n  );\n}\n","/*\n * File: metadata copy.js\n * Project: biz-form\n * File Created: Tuesday, 8th June 2021 9:35:35 pm\n * Author: zxtang (1061225829@qq.com)\n * -----\n * Last Modified: Tuesday, 8th June 2021 9:35:35 pm\n * Modified By: zxtang (1061225829@qq.com>)\n * -----\n * Copyright 2017 - 2021 Your Company, Your Company\n */\nimport {fetchEntities} from './entity';\nimport {fetchMetadatas} from './metadata';\n\n/**\n * 根据版本号检查本地的数据与服务器上的元数据是否一致，如果本地的版本比服务低则返回数据，否则不返回;\n * 根据返回的数据更新本地的数据\n * 本地的metadata、entity数据存储在localStorage中\n *\n * 采用这种方式而不是json文件的方式，是因为后端改了模型之后前端不用发版，只需要在启动应用时检查一下即可\n *\n * @param {*} param0\n * @returns\n */\nexport async function fetchBaseMetadata () {\n  const [ descriptionsData ] = await Promise.all([\n    fetchEntities()\n    // fetchMetadatas(),\n  ]);\n\n  return {\n    descriptions: descriptionsData.data\n    // metadatas,\n  };\n}\n","import {BIZ_AUTH} from '@src/common/constants/token';\nimport {fetchBaseMetadata} from '@src/http/base';\nimport {graphql} from '@src/http/graphql';\nimport {metadata} from '@src/metadata/metadata';\nimport OperatorStore from '@src/operator';\nimport localforage from 'localforage';\nimport * as React from 'react';\nimport LoadingContainer, {LoadingStatus} from '../LoadingContainer';\n\nexport interface IInitDataLoader {\n  children?: React.ReactNode;\n}\n\ninterface InitDataLoaderState {\n  loadingStatus: LoadingStatus;\n}\n\nexport class InitDataLoader extends React.Component<IInitDataLoader, InitDataLoaderState> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      loadingStatus: LoadingStatus.Loading,\n    };\n  }\n\n  componentDidMount() {\n    this.init();\n  }\n\n  render() {\n    return <LoadingContainer status={this.state.loadingStatus}>{() => this.props.children as any}</LoadingContainer>;\n  }\n\n  async init() {\n    // 获取元数据\n    const {descriptions} = await fetchBaseMetadata();\n    metadata.init({\n      descriptions,\n      // metadatas,\n    });\n    // 获取用户id\n    const {id: operatorId} = await localforage.getItem(BIZ_AUTH);\n    // 获取Operator数据\n    const {\n      data: {Operator},\n    } = await graphql({\n      query: `\n      {\n        Operator(id:\"${operatorId}\") {\n          id\n          name\n          avatar\n          email\n        }\n      }\n      `,\n    });\n    OperatorStore.init(Operator);\n    this.setState({\n      loadingStatus: LoadingStatus.Complete,\n    });\n  }\n}\n","import * as React from 'react';\nimport {Route} from 'react-router-dom';\nconst Login = React.lazy(() => import('@src/pages/auth/login'));\n\nconst NoSiderRoutes = [ <Route exact key=\"/login\" path=\"/login\" component={Login}></Route> ];\nexport default NoSiderRoutes;\n","import {BIZ_AUTH} from '@src/common/constants/token';\nimport {Auth} from '@src/interfaces/auth';\nimport localforage from 'localforage';\nimport {useEffect, useState} from 'react';\n\ninterface AuthCheckProps {\n  children: JSX.Element;\n}\n\nexport default function AuthCheck ({children}: AuthCheckProps): JSX.Element {\n  const [ status, setStatus ] = useState(false);\n  // 校验token是否存在\n  const authCheck = async () => {\n    const authInfo: Auth = await localforage.getItem(BIZ_AUTH);\n    if (!authInfo?.token) {\n      window.open('/login', '_self');\n    } else {\n      setStatus(true);\n    }\n  };\n\n  useEffect(() => {\n    authCheck();\n  }, []);\n\n  if (status === true) {\n    return children;\n  }\n\n  return null;\n}","import OperatorStore from '@src/operator';\nimport {RouteUtils} from '@src/router/routeUtils';\nimport {Avatar, Dropdown, Menu} from 'antd';\nimport * as React from 'react';\nimport styles from './style.module.scss';\n\nexport default class Header extends React.PureComponent {\n  handleLogout = () => {\n    OperatorStore.logout();\n  };\n\n  handleSetting = () => {\n    RouteUtils.to('/settings/changePassword');\n  };\n\n  renderUserSetting = () => {\n    return (\n      <Dropdown\n        placement=\"bottomRight\"\n        overlay={\n          <Menu>\n            <Menu.Item>\n              <a onClick={this.handleSetting}>设置</a>\n            </Menu.Item>\n            <Menu.Item>\n              <a onClick={this.handleLogout}>退出</a>\n            </Menu.Item>\n          </Menu>\n        }\n      >\n        <Avatar size={32} src={OperatorStore.avatar()}></Avatar>\n      </Dropdown>\n    );\n  };\n  render () {\n    return (\n      <div className={styles[ 'layout-header' ]}>\n        <div className={styles[ 'layout-header-left' ]}></div>\n        <div className={styles[ 'layout-header-right' ]}>{this.renderUserSetting()}</div>\n      </div>\n    );\n  }\n}\n","import React, {Suspense} from 'react';\nimport {ConfigProvider, Layout, Spin} from 'antd';\nimport zhCN from 'antd/lib/locale/zh_CN';\nimport \"./common/style/vars.scss\";\nimport './App.css';\n\nimport {Nav} from './Layout/Nav';\nimport AppRouter from './router';\nimport {Router, Route, Switch} from 'react-router-dom';\n// import { Router, Route } from \"react-router\";\nimport {Modals} from './components/Modals';\nimport {InitDataLoader} from './components/InitDataLoader';\nimport {globalHistory} from './router/routeUtils';\nimport NoSiderRoutes from './router/noSiderRoutes';\nimport AuthCheck from './components/AuthCheck';\nimport Header from './Layout/header';\nconst {Content} = Layout;\n\nfunction App () {\n  return (\n    <ConfigProvider locale={zhCN}>\n      <Layout style={{height: '100vh', width: '100vw'}}>\n        <Router history={globalHistory}>\n          <Suspense fallback={<Spin />}>\n            <Switch>\n              {NoSiderRoutes}\n              <AuthCheck>\n                <InitDataLoader>\n                  <Route>\n                    <Layout>\n                      <Nav />\n                      <Layout className=\"site-layout\">\n                        <Header></Header>\n                        <Content className=\"layout-content\">\n                          <AppRouter></AppRouter>\n                        </Content>\n                      </Layout>\n                    </Layout>\n                  </Route>\n                </InitDataLoader>\n              </AuthCheck>\n            </Switch>\n          </Suspense>\n        </Router>\n        <Modals />\n      </Layout>\n    </ConfigProvider>\n  );\n}\n\nexport default App;\n","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  // 严格模式会 render两次 https://reactjs.org/docs/strict-mode.html\n  // <React.StrictMode>\n    <App />\n  // </React.StrictMode>\n  ,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { ModalProps } from \"antd\";\nimport * as React from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport interface ModalsComponentProps {\n  onOk?: (...data: any) => void;\n  onCancel?: (...data: any) => void;\n  visible?: boolean;\n}\n\nexport interface IModals extends ModalsComponentProps{\n  [key:string]: any;\n}\n\ninterface ModalsState {\n  modals: Array<{\n    id: string;\n    Comp: React.Component<any> | React.FC<any> | React.ReactNode; // 只要提供了对应的props都可以显示，不仅仅是Modal组件\n    props: {\n      onOk: (data?: any) => void;\n      onCancel: (data?: any) => void;\n      visible: boolean;\n      [key:string]: any;\n    } & IModals;\n  }>;\n}\n\nexport class Modals extends React.Component<any, ModalsState> {\n  static install: Modals;\n\n  constructor(props: any) {\n    super(props);\n    if (Modals.install) {\n      return Modals.install;\n    }\n    Modals.install = this;\n\n    this.state = {\n      modals: [],\n    };\n  }\n\n  public static show = (\n    component: React.Component<any> | React.FC<any> | React.ReactNode,\n    props: IModals = {}\n  ) => {\n    const { modals = [] } = Modals.install.state;\n    return new Promise((resolve, reject) => {\n      const id = uuidv4();\n      modals.push({\n        id,\n        Comp: component,\n        props: {\n          ...props,\n          visible: true,\n          onOk: (...data) => {\n            props.onOk && props.onOk(data);\n            Modals.install.onClose(id);\n          },\n          onCancel: (...data) => {\n            props.onCancel && props.onCancel(data);\n            Modals.install.onClose(id);\n          },\n        },\n      });\n      Modals.install.setState({});\n    });\n  };\n\n  public static clear() {\n    if (Modals.install) {\n      Modals.install.state.modals.forEach(modal => {\n        Modals.install.onClose(modal.id);\n      })\n    }\n  }\n\n  /**\n   * @param id 每次关闭弹窗直接将组件移除，避免组件的状态在下次进入时影响组件的逻辑\n   */\n  private onClose = (id: string) => {\n    const { modals = [] } = this.state;\n    this.setState({\n      modals: modals.filter((modal) => modal.id !== id),\n    });\n  };\n\n  render() {\n    const { modals = [] } = this.state;\n    return (\n      <div>\n        {modals.map((item) => {\n          const Comp: any = item.Comp;\n          return <Comp key={item.id} {...item.props} />;\n        })}\n      </div>\n    );\n  }\n}\n","export const BIZ_AUTH = \"BIZ_AUTH\";","import { ClassBaseInterface } from \"@src/common/classBase\";\nimport { BizFormPresenter } from \"../bizFormPresenter\";\nimport { ILisenter } from \"./interface\";\n\nexport interface BaseModuleOptions {\n    presenter: BizFormPresenter;\n}\n\nexport class BaseModule implements ClassBaseInterface {\n\n    protected listeners: Array<ILisenter> = [];\n\n    constructor(protected options: BaseModuleOptions) {\n\n    }\n\n    // 模块执行函数, \n    public apply() {\n\n    }\n\n    public destructor() {\n        // 销毁当前模块添加的监听器\n        this.listeners.forEach(listener => listener && listener());\n    }\n\n}"],"sourceRoot":""}