{"pageProps":{"data":{"category":{"id":"de603bf9-e2dd-4eb4-aee0-c48d86eea130","name":"css"},"content":"在web端实时聊天开发过程中，发送图片是很常见的，显示时图片会有一撑开的过程，页面就会发送抖动，比如如下的代码：\n\n```html\n<html>\n    <body>\n        <div>\n        <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\">\n        <div>测试图片</div>\n        </div>\n    </body>\n</html>\n```\n\n图片效果如下:\n\n<img src=\"https://file.vwood.xyz/2022/10/10/upload_bpvs4083ojk6niya7qf90zfecirlwyun.gif\" style=\"max-height: 200px;\">\n\n\n“测试图片”几个字会被图片挤下来，用户体验不太好，同时页面会发生重排，如果给`<img>`标签设置宽度和高度就不会发生这种情况。比如这样：\n```html\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"width: 400px;height:100px\">\n```\n<img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"width: 400px;height:100px\">\n\n但是在聊天时图片的大小都是不一样的，不能写死，不然会变形，只能根据图片实际的宽高比来设置。\n\n\n### 解决办法：\n上传图片时将图片的宽度、高度都保存起来，比如`width: 600px, height: 400px`; 显示时根据实际的宽高比来设置。\n\n第一种方式：\n\n```html\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;width:300px\">\n```\n `aspect-ratio: 600/400` 就是设置图片的宽高比。这样设置`width:300px`时，高度会自动变为`200px`，图片的显示就是正确的。\n\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;width: 300px\">\n\n第二种方式：\n只设置高度，自动计算宽度\n\n```html\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;height:200px\">\n```\n\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;height:200px\">\n \n 上面两种设置效果都是一样的。\n\n\n 在实际的使用过程中，为了防止图片过大，都会设置最大宽度和高度，比如`max-width: 100%;max-height:200px`；由于宽度要随着浏览器窗口的改变自适应，所以通常设置图片的高度，这样会自动计算出宽度；也就是上面的第二种方式\n \n ```html\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;max-width:100%;max-height:200px;height:400px\">\n```\n\n <img src=\"https://file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\" style=\"aspect-ratio: 600/400;max-width:100%;max-height:200px;height:400px\">\n 如图由于最大高度`200px`，所以计算出来的宽度就为`300px`;\n\n### 兼容性\n各浏览器对`aspect-ratio`的支持如下，除了IE其他差不多都支持。\n![](https://file.vwood.xyz/2022/10/09/upload_cptgthsvfyp8qdnuoednwo7dmcqammgj.png)","createTime":1665417200000,"creativeType":"original","description":"在web端实时聊天开发过程中，发送图片是很常见的，显示时图片会有一撑开的过程，页面就会发送抖动，比如如下的代码：\n\nhtml\n<html>\n    <body>\n        <div>\n        <img src=\"https:file.vwood.xyz/2022/07/11/upload_ffje1i8jz45jrdflr07i17fqm3vefjg0.jpg\">\n    ","headerImg":"","id":"d4d53b2b-e674-43d0-9b6c-e88bbfea75f4","isDeleted":false,"likeCount":0,"name":"css aspect-ratio使用","operator":{"avatar":"//file.vwood.xyz/2023/06/11/upload_ssaf3w2dlo0xox7alrcrca1704a6j2fn.jpg","description":"","email":"1061225829@qq.com","github":"https://github.com/abelce","id":"96f16846-31f2-489c-9af0-d4ca13e836e4","name":"文钦"},"operatorId":"96f16846-31f2-489c-9af0-d4ca13e836e4","tags":["aspect-ratio"],"updateTime":1665417200000,"viewCount":0},"id":"d4d53b2b-e674-43d0-9b6c-e88bbfea75f4","latestArticleList":[{"id":"460fb164-5722-4cc2-ad6b-c35d5be4a670","name":"js提取iconfont项目的图标","tags":[],"description":"","content":""},{"id":"0517a4cb-be8a-47a5-b7c2-da7904a4ba67","name":"docker使用postgres","tags":[],"description":"","content":""},{"id":"cd89eea1-6839-499b-8573-5a487afc48ef","name":"babel配置文件加载","tags":[],"description":"","content":""},{"id":"ef3bf6e0-6e9f-4704-8b9d-cdd4d1fa7a91","name":"typescript使用","tags":[],"description":"","content":""},{"id":"7b2f60f3-7b3e-4889-8062-30323d2af5cf","name":"git设置超时设置","tags":[],"description":"","content":""}]},"initialMobxState":{"userStore":{"currentUser":null,"users":[],"token":"","qiniuToken":"","userCount":0,"productCount":0,"commentCount":0,"settingType":"products"},"productStore":{"products":[],"total":0,"type":"","url":"","current":1,"product":null,"likesMap":{},"tabpane":"all","token":"","loading":false,"todayHunters":[],"today":[],"yesterday":[],"relatedProducts":[],"search":""},"commentStore":{"comments":[],"total":0,"current":0},"noteStore":{"token":"","notes":[],"total":0,"note":null},"askStore":{"token":"","asks":[],"total":0,"ask":null},"stypeStore":{"data":[]}},"__N_SSG":true}